<Window x:Class="TestRunner.Designer.LibraryMainForm"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:common="clr-namespace:TestRunner.Common"
        xmlns:tl="clr-namespace:TestRunner.Designer"
        Title="Test Library" Height="720" Width="1280" Closing="Window_Closing">
    <Window.Resources>
        <tl:StepsTotalConverter x:Key="STConverter" />
        <tl:QueryRowColorConverter x:Key="QRCConverter" />
        <tl:FinderParameterConverter x:Key="FPConverter" />
        <tl:IsExpandedTestInSuiteConverter x:Key="IsExpTestConverter" />
        <tl:IsExpandedParentSuiteConverter x:Key="IsExpSuiteConverter" />
    </Window.Resources>
    <Grid>
        <Grid.Background>
            <ImageBrush ImageSource="pack://siteoforigin:,,,/Resources/DeltekBackground.png" Stretch="UniformToFill"/>
        </Grid.Background>
        <Grid.RowDefinitions>
            <RowDefinition Height="23"/>
            <RowDefinition Height="25"/>
            <RowDefinition/>
            <RowDefinition Height="23"/>
        </Grid.RowDefinitions>
        <Menu Grid.Row="0">File</Menu>
        <StackPanel Grid.Row="1" Orientation="Horizontal" Margin="5,1,5,1">
            <RadioButton x:Name="rdoHome" Style="{StaticResource {x:Type ToggleButton}}" Background="Transparent" Content="Query" Width="100" BorderBrush="Transparent" Checked="rdoAll_Checked"/>
            <RadioButton x:Name="rdoSuites" Style="{StaticResource {x:Type ToggleButton}}" Background="Transparent" Content="Suites" Width="100" BorderBrush="Transparent" Checked="rdoAll_Checked"/>
            <RadioButton x:Name="rdoTests" Style="{StaticResource {x:Type ToggleButton}}" Background="Transparent" Content="Tests" Width="100" BorderBrush="Transparent" Checked="rdoAll_Checked"/>
            <RadioButton x:Name="rdoFinder" Style="{StaticResource {x:Type ToggleButton}}" Background="Transparent" Content="Finder" Width="100" BorderBrush="Transparent" Checked="rdoAll_Checked"/>
            <RadioButton x:Name="rdoAdmin" Style="{StaticResource {x:Type ToggleButton}}" Background="Transparent" Content="Admin" Width="100" BorderBrush="Transparent" Checked="rdoAll_Checked"/>
        </StackPanel>
        <Grid Grid.Row="2">
            <Grid.ColumnDefinitions>
                <ColumnDefinition  Width="5"/>
                <ColumnDefinition />
                <ColumnDefinition Width="5"/>
            </Grid.ColumnDefinitions>
            <TabControl x:Name="tabMain" Grid.Column="1" Margin="0,0,0,5" >
                <TabItem x:Name="tabHome" Header="Home">
                    <Grid>
                        <Grid.RowDefinitions>
                            <RowDefinition Height="30"/>
                            <RowDefinition Height="5"/>
                            <RowDefinition Height="35"/>
                            <RowDefinition Height="5"/>
                            <RowDefinition />
                        </Grid.RowDefinitions>
                        <Grid Grid.Row="0" Grid.ColumnSpan="2">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="70"/>
                                <ColumnDefinition Width="175"/>
                                <ColumnDefinition Width="10"/>
                                <ColumnDefinition Width="85"/>
                                <ColumnDefinition Width="175"/>
                                <ColumnDefinition Width="5"/>
                                <ColumnDefinition Width="420"/>
                                <ColumnDefinition MinWidth="175" Width="*"/>
                                <ColumnDefinition Width="110"/>
                            </Grid.ColumnDefinitions>
                            <TextBlock Grid.Column="0" VerticalAlignment="Center" Text="Query Type" Foreground="Navy" FontWeight="Bold"/>
                            <ComboBox x:Name="cboQueryTypes" Grid.Column="1" VerticalAlignment="Center" Height="20" SelectionChanged="cboQueryTypes_SelectionChanged" IsEnabled="True"></ComboBox>
                            <TextBlock Grid.Column="3" VerticalAlignment="Center" Text="Current Query" Foreground="Navy" FontWeight="Bold"/>
                            <ComboBox x:Name="cboCurrentQuery" Grid.Column="4" VerticalAlignment="Center" Height="20" SelectionChanged="cboCurrentQuery_SelectionChanged">
                                <ComboBox.Style>
                                    <Style TargetType="ComboBox">
                                        <Style.Triggers>
                                            <DataTrigger Binding="{Binding ElementName=cboCurrentQuery, Path=Items.Count}" Value="0">
                                                <Setter Property="IsEnabled" Value="False"/>
                                            </DataTrigger>
                                        </Style.Triggers>
                                    </Style>
                                </ComboBox.Style>
                            </ComboBox>
                            <StackPanel Grid.Column="6" VerticalAlignment="Center" Orientation="Horizontal">
                                <Button x:Name="btnNewQuery" Style="{StaticResource ToolbarButtonStyle}" Width="100" Height="20" Click="btnNewQuery_Click">
                                    <StackPanel Orientation="Horizontal">
                                        <Image Source="pack://siteoforigin:,,,/Resources/check.ico" Width="14" Height="14"/>
                                        <TextBlock Width="10"></TextBlock>
                                        <TextBlock>New...</TextBlock>
                                    </StackPanel>
                                </Button>

                                <!--<Button Style="{StaticResource ToolbarButtonStyle}" Width="100" Height="20">
                                    <StackPanel Orientation="Horizontal">
                                        <Image Source="pack://siteoforigin:,,,/Resources/add.png" Width="14" Height="14"/>
                                        <TextBlock Width="10"></TextBlock>
                                        <TextBlock>Add</TextBlock>
                                    </StackPanel>
                                </Button>-->
                                <Button x:Name="btnDeleteQuery" Width="100" Height="20" Click="btnDeleteQuery_Click">
                                    <StackPanel Orientation="Horizontal">
                                        <Image Source="pack://siteoforigin:,,,/Resources/button_cancel.ico" Width="14" Height="14"/>
                                        <TextBlock Width="10"></TextBlock>
                                        <TextBlock>Delete</TextBlock>
                                    </StackPanel>
                                    <Button.Style>
                                        <Style TargetType="Button">
                                            <Setter Property="IsEnabled" Value="True"/>
                                            <Setter Property="BorderBrush" Value="SteelBlue" />
                                            <Setter Property="Background" Value="White" />
                                            <Setter Property="FontSize" Value="10" />
                                            <Setter Property="Width" Value="25" />
                                            <Setter Property="Height" Value="25" />
                                            <Setter Property="Margin" Value="2,2,2,2" />
                                            <Setter Property="VerticalContentAlignment" Value="Center" />
                                            <Setter Property="HorizontalAlignment" Value="Center" />
                                            <Style.Triggers>
                                                <DataTrigger Binding="{Binding ElementName=cboCurrentQuery, Path=SelectedItem}" Value="{x:Null}">
                                                    <Setter Property="IsEnabled" Value="False"/>
                                                </DataTrigger>
                                            </Style.Triggers>
                                        </Style>
                                    </Button.Style>
                                </Button>
                                <Button x:Name="btnSaveAs" Width="100" Height="20" Click="btnSaveAs_Click">
                                    <StackPanel Orientation="Horizontal">
                                        <Image Source="pack://siteoforigin:,,,/Resources/save.png" Width="14" Height="14"/>
                                        <TextBlock Width="10"></TextBlock>
                                        <TextBlock>Save As...</TextBlock>
                                    </StackPanel>
                                    <Button.Style>
                                        <Style TargetType="Button">
                                            <Setter Property="IsEnabled" Value="True"/>
                                            <Setter Property="BorderBrush" Value="SteelBlue" />
                                            <Setter Property="Background" Value="White" />
                                            <Setter Property="FontSize" Value="10" />
                                            <Setter Property="Width" Value="25" />
                                            <Setter Property="Height" Value="25" />
                                            <Setter Property="Margin" Value="2,2,2,2" />
                                            <Setter Property="VerticalContentAlignment" Value="Center" />
                                            <Setter Property="HorizontalAlignment" Value="Center" />
                                            <Style.Triggers>
                                                <DataTrigger Binding="{Binding ElementName=cboCurrentQuery, Path=SelectedItem}" Value="{x:Null}">
                                                    <Setter Property="IsEnabled" Value="False"/>
                                                </DataTrigger>
                                            </Style.Triggers>
                                        </Style>
                                    </Button.Style>
                                </Button>
                            </StackPanel>
                            <Button x:Name="btnExport" Grid.Column="8" Width="100" Height="20" Click="btnExport_Click">
                                Export...
                                <Button.Style>
                                    <Style TargetType="Button">
                                        <Setter Property="IsEnabled" Value="True"/>
                                        <Setter Property="BorderBrush" Value="SteelBlue" />
                                        <Setter Property="Background" Value="White" />
                                        <Setter Property="FontSize" Value="10" />
                                        <Setter Property="Width" Value="25" />
                                        <Setter Property="Height" Value="25" />
                                        <Setter Property="Margin" Value="2,2,2,2" />
                                        <Setter Property="VerticalContentAlignment" Value="Center" />
                                        <Setter Property="HorizontalAlignment" Value="Center" />
                                        <Style.Triggers>
                                            <DataTrigger Binding="{Binding ElementName=cboCurrentQuery, Path=SelectedItem}" Value="{x:Null}">
                                                <Setter Property="IsEnabled" Value="False"/>
                                            </DataTrigger>
                                        </Style.Triggers>
                                    </Style>
                                </Button.Style>
                            </Button>
                        </Grid>
                        <ToolBar Grid.Row="2" Loaded="ToolBar_Loaded" ToolBarTray.IsLocked="True" BorderBrush="Silver" BorderThickness="1" Grid.ColumnSpan="2">
                            <!--<Button x:Name="btnAddTag" Style="{StaticResource ToolbarButtonStyle}" Click="btnAddTag_Click"></Button>-->
                            <StackPanel VerticalAlignment="Center" Orientation="Horizontal">
                                <Button x:Name="btnRunQuery" Width="100" Height="20" Click="btnRunQuery_Click" Margin="10,0,0,0">
                                    <StackPanel Orientation="Horizontal" >
                                        <Image Source="pack://siteoforigin:,,,/Resources/refresh.ico" Width="14" Height="14"/>
                                        <TextBlock Width="10" VerticalAlignment="Center"></TextBlock>
                                        <TextBlock VerticalAlignment="Center">Refresh</TextBlock>
                                    </StackPanel>
                                    <Button.Style>
                                        <Style TargetType="Button">
                                            <Setter Property="IsEnabled" Value="True"/>
                                            <Setter Property="BorderBrush" Value="SteelBlue" />
                                            <Setter Property="Background" Value="White" />
                                            <Setter Property="FontSize" Value="10" />
                                            <Setter Property="Width" Value="25" />
                                            <Setter Property="Height" Value="25" />
                                            <Setter Property="Margin" Value="2,2,2,2" />
                                            <Setter Property="VerticalContentAlignment" Value="Center" />
                                            <Setter Property="HorizontalAlignment" Value="Center" />
                                            <Style.Triggers>
                                                <DataTrigger Binding="{Binding ElementName=cboCurrentQuery, Path=SelectedItem}" Value="{x:Null}">
                                                    <Setter Property="IsEnabled" Value="False"/>
                                                </DataTrigger>
                                            </Style.Triggers>
                                        </Style>
                                    </Button.Style>
                                </Button>
                                <TextBlock Width="15"/>
                                <CheckBox x:Name="chkShowQueryResults" VerticalAlignment="Center" Click="chkShowQueryResults_Click">Show query results</CheckBox>
                            </StackPanel>
                        </ToolBar>
                        <Grid Grid.Row="4">
                            <Grid.RowDefinitions>
                                <RowDefinition x:Name="rdQueryTable"/>
                                <RowDefinition Height="3"/>
                                <RowDefinition x:Name="rdQueryResults" />
                            </Grid.RowDefinitions>
                            <DataGrid x:Name="dgQuery" Grid.Row="0" HeadersVisibility="Column" SelectionMode="Single"  SelectionUnit="Cell" CanUserSortColumns="False" 
                                  AutoGeneratingColumn="dgQuery_AutoGeneratingColumn" AutoGeneratedColumns="dgQuery_AutoGeneratedColumns" IsReadOnly="True" CanUserAddRows="False" CanUserReorderColumns="False" CanUserResizeColumns="False" HorizontalGridLinesBrush="Silver" VerticalGridLinesBrush="Silver" SelectedCellsChanged="ContextMenuStates" MouseRightButtonDown="dgQuery_MouseRightButtonDown" Grid.ColumnSpan="2">
                                <DataGrid.ContextMenu>
                                    <ContextMenu Style="{StaticResource contextMenuStyle1}">
                                        <MenuItem x:Name="mnuMoveLeft" Header="Move Left" Click="mnuMoveLeft_Click"/>
                                        <MenuItem x:Name="mnuMoveRight" Header="Move Right" Click="mnuMoveRight_Click"/>
                                        <Separator/>
                                        <MenuItem x:Name="mnuEditCol"  Header="Edit column..." Click="mnuEditCol_Click"/>
                                        <MenuItem x:Name="mnuDeleteCol" Header="Delete column" Click="mnuDeleteCol_Click"/>
                                    </ContextMenu>
                                </DataGrid.ContextMenu>
                                <DataGrid.CellStyle>
                                    <Style TargetType="DataGridCell">
                                        <EventSetter Event="DataGridCell.Selected" Handler="QueryGridCell_Selected"/>
                                        <Setter Property="FontSize" Value="11"/>
                                        <Setter Property="Foreground" Value="Navy"/>
                                        <Setter Property="HorizontalContentAlignment" Value="Stretch"/>
                                        <Setter Property="TextBlock.TextAlignment" Value="Right"/>
                                        <Style.Triggers>
                                            <Trigger Property="IsSelected" Value="True">
                                                <!--<Setter Property="FontWeight" Value="Bold"/>-->
                                                <Setter Property="Background" Value="Transparent" />
                                                <Setter Property="BorderBrush" Value="DarkGreen" />
                                                <Setter Property="Foreground" Value="Navy"/>
                                                <Setter Property="BorderThickness" Value="2" />
                                            </Trigger>
                                        </Style.Triggers>
                                    </Style>
                                </DataGrid.CellStyle>
                                <!--<DataGrid.RowStyle>
                                <Style TargetType="DataGridRow">
                                    <Setter Property="FontSize" Value="11"/>
                                </Style>
                            </DataGrid.RowStyle>-->
                                <DataGrid.ColumnHeaderStyle>
                                    <Style TargetType="DataGridColumnHeader" >
                                        <Setter Property="Background" Value="DarkGreen" />
                                        <Setter Property="Foreground" Value="White" />
                                        <Setter Property="FontSize" Value="11" />
                                        <!--<Setter Property="Focusable" Value="True"/>-->
                                        <Setter Property="Padding" Value="4, 0, 0, 0" />
                                        <Setter Property="HorizontalContentAlignment" Value="Center"/>
                                        <!--<EventSetter Event="Click" Handler="dgDataDriven_ColumnHeaderClick" />
                                    <Style.Triggers>
                                        <Trigger Property="IsFocused"  Value="True">
                                            <Setter Property="BorderBrush" Value="BlueViolet" />
                                            <Setter Property="BorderThickness" Value="2" />
                                        </Trigger>
                                    </Style.Triggers>
                                    -->
                                        <!--<Setter Property="MinWidth" Value="125" />-->
                                    </Style>
                                </DataGrid.ColumnHeaderStyle>
                                <DataGrid.Columns>
                                    <DataGridTemplateColumn MinWidth="200">
                                        <DataGridTemplateColumn.CellStyle>
                                            <Style TargetType="DataGridCell">
                                                <Setter Property="HorizontalAlignment" Value="Stretch"/>
                                                <Setter Property="Foreground" Value="Navy"/>
                                                <Style.Triggers>
                                                    <DataTrigger Binding="{Binding Path=Color, Converter={StaticResource QRCConverter}}" Value="Gray">
                                                        <Setter Property="Background" Value="WhiteSmoke"/>
                                                    </DataTrigger>
                                                    <Trigger Property="IsSelected" Value="True">
                                                        <!--<Setter Property="FontWeight" Value="Bold"/>-->
                                                        <Setter Property="Background" Value="Transparent" />
                                                        <Setter Property="BorderBrush" Value="DarkGreen" />
                                                        <Setter Property="BorderThickness" Value="2" />
                                                    </Trigger>
                                                </Style.Triggers>
                                            </Style>
                                        </DataGridTemplateColumn.CellStyle>
                                        <DataGridTemplateColumn.CellTemplate>
                                            <DataTemplate>
                                                <TextBlock x:Name="RowTitle" Text="{Binding Name}">
                                                    <TextBlock.ContextMenu>
                                                        <ContextMenu Style="{StaticResource contextMenuStyle1}">
                                                            <MenuItem x:Name="mnuMoveUp" Header="Move Up" Click="mnuMoveUp_Click"/>
                                                            <MenuItem x:Name="mnuMoveDown" Header="Move Down" Click="mnuMoveDown_Click"/>
                                                            <Separator/>
                                                            <MenuItem x:Name="mnuGrayColor" Header="Gray" Click="mnuGrayColor_Click"/>
                                                            <MenuItem x:Name="mnuYellowColor" Header="Yellow" Click="mnuYellowColor_Click"/>
                                                            <MenuItem x:Name="mnuOrangeColor" Header="Orange" Click="mnuOrangeColor_Click"/>
                                                            <Separator/>
                                                            <MenuItem x:Name="mnuEditRow"  Header="Edit row..." Click="mnuEditRow_Click"/>
                                                            <MenuItem x:Name="mnuDeleteRow" Header="Delete row" Click="mnuDeleteRow_Click"/>
                                                        </ContextMenu>
                                                    </TextBlock.ContextMenu>
                                                </TextBlock>
                                            </DataTemplate>
                                        </DataGridTemplateColumn.CellTemplate>
                                        <DataGridTemplateColumn.HeaderTemplate>
                                            <DataTemplate>
                                                <DockPanel>
                                                    <Button Name="btnAddRow" HorizontalAlignment="Right" VerticalContentAlignment="Center" Margin="5,2,5,2" 
                                                Width="75" Height="16" ContextMenuService.IsEnabled="false" Click="btnAddRow_Click" FontSize="9">
                                                        <StackPanel Orientation="Horizontal">
                                                            <Image Source="pack://siteoforigin:,,,/Resources/addblue.png" Width="10" Height="10"/>
                                                            <TextBlock Width="8"></TextBlock>
                                                            <TextBlock VerticalAlignment="Center">Add Row</TextBlock>
                                                        </StackPanel>
                                                        <Button.Style>
                                                            <Style TargetType="Button">
                                                                <Setter Property="IsEnabled" Value="True"/>
                                                                <Setter Property="BorderBrush" Value="SteelBlue" />
                                                                <Setter Property="Background" Value="White" />
                                                                <Setter Property="FontSize" Value="10" />
                                                                <Setter Property="Width" Value="25" />
                                                                <Setter Property="Height" Value="25" />
                                                                <Setter Property="Margin" Value="2,2,2,2" />
                                                                <Setter Property="VerticalContentAlignment" Value="Center" />
                                                                <Setter Property="HorizontalAlignment" Value="Center" />
                                                                <Style.Triggers>
                                                                    <DataTrigger Binding="{Binding ElementName=cboCurrentQuery, Path=SelectedItem}" Value="{x:Null}">
                                                                        <Setter Property="IsEnabled" Value="False"/>
                                                                    </DataTrigger>
                                                                </Style.Triggers>
                                                            </Style>
                                                        </Button.Style>
                                                    </Button>
                                                </DockPanel>
                                            </DataTemplate>
                                        </DataGridTemplateColumn.HeaderTemplate>
                                        <DataGridTemplateColumn.HeaderStyle>
                                            <Style TargetType="DataGridColumnHeader">
                                                <Setter Property="Background" Value="Navy"/>
                                                <Setter Property="BorderBrush" Value="Silver"/>
                                                <Setter Property="BorderThickness" Value="1"/>
                                                <Setter Property="Foreground" Value="White"/>
                                            </Style>
                                        </DataGridTemplateColumn.HeaderStyle>
                                    </DataGridTemplateColumn>
                                    <DataGridTemplateColumn Width="100" MinWidth="100">
                                        <DataGridTemplateColumn.CellTemplate>
                                            <DataTemplate>
                                                <TextBlock Text="{Binding TotalValue}">
                                                    <TextBlock.ContextMenu>
                                                        <ContextMenu Style="{StaticResource contextMenuStyle1}" Visibility="Hidden">
                                                        </ContextMenu>
                                                    </TextBlock.ContextMenu>
                                                </TextBlock>
                                            </DataTemplate>
                                        </DataGridTemplateColumn.CellTemplate>
                                        <DataGridTemplateColumn.HeaderTemplate>
                                            <DataTemplate>
                                                <DockPanel>
                                                    <TextBlock>TOTAL</TextBlock>
                                                    <TextBlock Width="8"></TextBlock>

                                                    <Button Name="btnAddCol" HorizontalAlignment="Right" VerticalContentAlignment="Center" Margin="5,0,5,0" 
                                                Width="16" Height="16" ContextMenuService.IsEnabled="false" FontSize="9" Click="btnAddCol_Click">
                                                        <Button.ContextMenu>
                                                            <ContextMenu Style="{StaticResource contextMenuStyle1}">
                                                                <MenuItem x:Name="mnuAddModifier"  Header="Add query modifier..." Click="mnuAddModifier_Click"/>
                                                                <MenuItem x:Name="mnuAddColOperation" Header="Add column operation..." Click="mnuAddColOperation_Click"/>
                                                            </ContextMenu>
                                                        </Button.ContextMenu>
                                                        <StackPanel Orientation="Horizontal">
                                                            <Image Source="pack://siteoforigin:,,,/Resources/add.png" Width="10" Height="10"/>
                                                        </StackPanel>
                                                        <Button.Style>
                                                            <Style TargetType="Button">
                                                                <Setter Property="IsEnabled" Value="True"/>
                                                                <Setter Property="BorderBrush" Value="SteelBlue" />
                                                                <Setter Property="Background" Value="White" />
                                                                <Setter Property="FontSize" Value="10" />
                                                                <Setter Property="Width" Value="25" />
                                                                <Setter Property="Height" Value="25" />
                                                                <Setter Property="Margin" Value="2,2,2,2" />
                                                                <Setter Property="VerticalContentAlignment" Value="Center" />
                                                                <Setter Property="HorizontalAlignment" Value="Center" />
                                                                <Style.Triggers>
                                                                    <DataTrigger Binding="{Binding ElementName=cboCurrentQuery, Path=SelectedItem}" Value="{x:Null}">
                                                                        <Setter Property="IsEnabled" Value="False"/>
                                                                    </DataTrigger>
                                                                </Style.Triggers>
                                                            </Style>
                                                        </Button.Style>
                                                    </Button>
                                                </DockPanel>
                                            </DataTemplate>
                                        </DataGridTemplateColumn.HeaderTemplate>
                                        <DataGridTemplateColumn.HeaderStyle>
                                            <Style TargetType="DataGridColumnHeader">
                                                <Setter Property="HorizontalContentAlignment" Value="Center"/>
                                                <Setter Property="BorderBrush" Value="Silver"/>
                                                <Setter Property="BorderThickness" Value="1"/>
                                                <Setter Property="Background" Value="Navy"/>
                                                <Setter Property="Foreground" Value="White"/>
                                            </Style>
                                        </DataGridTemplateColumn.HeaderStyle>
                                    </DataGridTemplateColumn>
                                </DataGrid.Columns>
                            </DataGrid>
                            <GridSplitter Grid.Row="1" Height="5" ShowsPreview="True" BorderBrush="Gray"  HorizontalAlignment="Stretch" 
                                          BorderThickness="0,0,0,1" />
                            <Grid x:Name="grdTestQueryResults" SizeChanged="grdTestQueryResults_SizeChanged" Grid.Row="2">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="550"/>
                                    <ColumnDefinition Width="5"/>
                                    <ColumnDefinition />
                                </Grid.ColumnDefinitions>
                                <Grid Grid.Column="0">
                                    <TabControl>
                                        <TabItem Visibility="Collapsed">
                                            <DockPanel>
                                                <TextBlock DockPanel.Dock="Top" Height="5"/>
                                                <TextBlock DockPanel.Dock="Top" Text="{Binding Path=QueryResultsTitle, RelativeSource={RelativeSource AncestorType=Window}, 
                                                    NotifyOnSourceUpdated=True, UpdateSourceTrigger=PropertyChanged}" FontWeight="Bold" Foreground="Navy"/>
                                                <TextBlock DockPanel.Dock="Top" Height="5"/>
                                                <DataGrid DockPanel.Dock="Top" x:Name="dgQueryResults" Style="{StaticResource DataGridStyle1}" HorizontalAlignment="Stretch" 
                                                    ItemsSource="{Binding}" RowHeaderWidth="0" HorizontalScrollBarVisibility="Auto" VerticalScrollBarVisibility="Visible"
                                                    SelectionMode="Single" IsReadOnly="True" CanUserDeleteRows="False" CanUserAddRows="False" CanUserSortColumns="True"
                                                    RowStyle="{StaticResource DataGridRowStyle0}" CellStyle="{StaticResource DataGridCellStyle8}" 
                                                    VirtualizingStackPanel.IsVirtualizing="True" VirtualizingPanel.VirtualizationMode="Recycling" VerticalAlignment="Stretch" 
                                                    CanUserResizeColumns="True" SelectionChanged="dgQueryResults_SelectionChanged">
                                                    <DataGrid.ContextMenu>
                                                        <ContextMenu>
                                                            <MenuItem x:Name="ctxQueryResultsEdit" Header="Edit" Click="ctxQueryResultsEdit_Click"/>
                                                        </ContextMenu>
                                                    </DataGrid.ContextMenu>
                                                    <DataGrid.Columns>
                                                        <DataGridTextColumn Binding="{Binding mFileName}" SortMemberPath="mFileName" CanUserSort="True" CanUserReorder="False" CanUserResize="True"  Header="File Name" HeaderStyle="{StaticResource DataGridColumnHeaderStyle0}"  Width="180"/>
                                                        <DataGridTemplateColumn SortMemberPath="mTestPath" CanUserSort="True" CanUserReorder="False" CanUserResize="True"  Header="Path" HeaderStyle="{StaticResource DataGridColumnHeaderStyle0}"  Width="*">
                                                            <DataGridTemplateColumn.CellTemplate>
                                                                <DataTemplate>
                                                                    <TextBlock x:Name="Path" Text="{Binding mTestPath}" PreviewMouseLeftButtonDown="Folder_Click" HorizontalAlignment="Left">
                                                                        <TextBlock.ContextMenu>
                                                                            <ContextMenu Style="{StaticResource contextMenuStyle1}">
                                                                                <MenuItem x:Name="mnuEditTest2" Header="Edit" Click="mnuEditTest_Click"/>
                                                                            </ContextMenu>
                                                                        </TextBlock.ContextMenu>
                                                                        <TextBlock.Style>
                                                                            <Style>
                                                                                <Setter Property="TextBlock.Foreground" Value="{DynamicResource {x:Static SystemColors.HotTrackBrushKey}}" />
                                                                                <Setter Property="TextBlock.Cursor" Value="Hand" />
                                                                                <Setter Property="TextBlock.TextDecorations" Value="Underline"></Setter>
                                                                                <Setter Property="TextBlock.TextTrimming" Value="CharacterEllipsis"/>
                                                                                <Style.Triggers>
                                                                                    <Trigger Property="TextBlock.IsMouseOver" Value="true">
                                                                                        <Setter Property="TextBlock.Foreground" Value="Red" />
                                                                                    </Trigger>
                                                                                </Style.Triggers>
                                                                            </Style>
                                                                        </TextBlock.Style>
                                                                    </TextBlock>
                                                                </DataTemplate>
                                                            </DataGridTemplateColumn.CellTemplate>
                                                        </DataGridTemplateColumn>
                                                        <DataGridTextColumn Binding="{Binding mTestDescription}" SortMemberPath="mTestDescription" CanUserSort="True" CanUserReorder="False" CanUserResize="True"  Header="Description" HeaderStyle="{StaticResource DataGridColumnHeaderStyle0}"  Width="*"/>
                                                        <DataGridTemplateColumn SortMemberPath="mLinks" CanUserSort="True" CanUserReorder="False" CanUserResize="True"  Header="Links" HeaderStyle="{StaticResource DataGridColumnHeaderStyle0}"  Width="*">
                                                            <DataGridTemplateColumn.CellTemplate>
                                                                <DataTemplate>
                                                                    <ListBox ItemsSource="{Binding mLinks}">
                                                                        <ListBox.ItemTemplate>
                                                                            <DataTemplate>
                                                                                <TextBlock x:Name="Path" ToolTip="{Binding LinkPath}" Text="{Binding DisplayName}" PreviewMouseLeftButtonDown="Link_Click" HorizontalAlignment="Left">
                                                                                    <TextBlock.Style>
                                                                                        <Style>
                                                                                            <Setter Property="TextBlock.Foreground" Value="{DynamicResource {x:Static SystemColors.HotTrackBrushKey}}" />
                                                                                            <Setter Property="TextBlock.Cursor" Value="Hand" />
                                                                                            <Setter Property="TextBlock.TextDecorations" Value="Underline"></Setter>
                                                                                            <Setter Property="TextBlock.TextTrimming" Value="CharacterEllipsis"/>
                                                                                            <Style.Triggers>
                                                                                                <Trigger Property="TextBlock.IsMouseOver" Value="true">
                                                                                                    <Setter Property="TextBlock.Foreground" Value="Red" />
                                                                                                </Trigger>
                                                                                            </Style.Triggers>
                                                                                        </Style>
                                                                                    </TextBlock.Style>
                                                                                </TextBlock>
                                                                            </DataTemplate>
                                                                        </ListBox.ItemTemplate>
                                                                        <ListBox.ItemContainerStyle>
                                                                            <Style TargetType="{x:Type ListBoxItem}">
                                                                                <Setter Property="Background" Value="Transparent"/>
                                                                                <Setter Property="HorizontalContentAlignment" Value="{Binding HorizontalContentAlignment, RelativeSource={RelativeSource AncestorType={x:Type ItemsControl}}}"/>
                                                                                <Setter Property="VerticalContentAlignment" Value="{Binding VerticalContentAlignment, RelativeSource={RelativeSource AncestorType={x:Type ItemsControl}}}"/>
                                                                                <Setter Property="Padding" Value="2,0,0,0"/>
                                                                                <Setter Property="MaxHeight" Value="20" />
                                                                                <Setter Property="Template">
                                                                                    <Setter.Value>
                                                                                        <ControlTemplate TargetType="{x:Type ListBoxItem}">
                                                                                            <Border x:Name="Bd" BorderBrush="{TemplateBinding BorderBrush}" BorderThickness="{TemplateBinding BorderThickness}" Background="{TemplateBinding Background}" Padding="{TemplateBinding Padding}" SnapsToDevicePixels="true">
                                                                                                <ContentPresenter HorizontalAlignment="{TemplateBinding HorizontalContentAlignment}" SnapsToDevicePixels="{TemplateBinding SnapsToDevicePixels}" VerticalAlignment="{TemplateBinding VerticalContentAlignment}"/>
                                                                                            </Border>
                                                                                            <ControlTemplate.Triggers>
                                                                                                <Trigger Property="IsSelected" Value="true">
                                                                                                    <Setter Property="Background" TargetName="Bd" Value="{DynamicResource {x:Static SystemColors.HighlightBrushKey}}"/>
                                                                                                    <Setter Property="Foreground" Value="{DynamicResource {x:Static SystemColors.HighlightTextBrushKey}}"/>
                                                                                                </Trigger>
                                                                                                <MultiTrigger>
                                                                                                    <MultiTrigger.Conditions>
                                                                                                        <Condition Property="IsSelected" Value="true"/>
                                                                                                        <Condition Property="Selector.IsSelectionActive" Value="false"/>
                                                                                                    </MultiTrigger.Conditions>
                                                                                                    <Setter Property="Background" TargetName="Bd" Value="{DynamicResource {x:Static SystemColors.InactiveSelectionHighlightBrushKey}}"/>
                                                                                                    <Setter Property="Foreground" Value="{DynamicResource {x:Static SystemColors.InactiveSelectionHighlightTextBrushKey}}"/>
                                                                                                </MultiTrigger>
                                                                                                <Trigger Property="IsEnabled" Value="false">
                                                                                                    <Setter Property="Foreground" Value="{DynamicResource {x:Static SystemColors.InactiveSelectionHighlightTextBrushKey}}"/>
                                                                                                </Trigger>
                                                                                            </ControlTemplate.Triggers>
                                                                                        </ControlTemplate>
                                                                                    </Setter.Value>
                                                                                </Setter>
                                                                                <Setter Property="IsTabStop" Value="False"/>
                                                                                <Style.Resources>
                                                                                    <SolidColorBrush x:Key="{x:Static SystemColors.HighlightBrushKey}" Color="Transparent"/>
                                                                                    <SolidColorBrush x:Key="{x:Static SystemColors.ControlBrushKey}" Color="Transparent"/>
                                                                                    <SolidColorBrush x:Key="{x:Static SystemColors.HighlightTextBrushKey}" Color="{x:Static SystemColors.ControlTextColor}"/>
                                                                                </Style.Resources>
                                                                            </Style>
                                                                        </ListBox.ItemContainerStyle>
                                                                    </ListBox>
                                                                </DataTemplate>
                                                            </DataGridTemplateColumn.CellTemplate>
                                                        </DataGridTemplateColumn>
                                                        <DataGridTemplateColumn SortMemberPath="Goto" CanUserSort="True" CanUserReorder="False" CanUserResize="True"  Header="Goto" HeaderStyle="{StaticResource DataGridColumnHeaderStyle0}"  Width="50">
                                                            <DataGridTemplateColumn.CellTemplate>
                                                                <DataTemplate>
                                                                    <Image x:Name="Goto" Source="pack://siteoforigin:,,,/Resources/goto.png" Width="20" Height="20" Cursor="Hand" HorizontalAlignment="Center" VerticalAlignment="Center" MouseDown="Goto_Click"/>
                                                                </DataTemplate>
                                                            </DataGridTemplateColumn.CellTemplate>
                                                        </DataGridTemplateColumn>
                                                    </DataGrid.Columns>
                                                </DataGrid>
                                            </DockPanel>
                                        </TabItem>
                                    </TabControl>
                                </Grid>
                                <GridSplitter Grid.Column="1" Width="5" ShowsPreview="True" BorderBrush="Gray"  HorizontalAlignment="Stretch" 
                                          BorderThickness="0,0,0,1"/>
                                <Grid Grid.Column="2">
                                    <TabControl>
                                        <TabItem Visibility="Collapsed">
                                            <DockPanel>
                                                <TextBlock DockPanel.Dock="Top" Height="5"/>
                                                <StackPanel DockPanel.Dock="Top" Orientation="Horizontal">
                                                    <TextBlock FontWeight="Bold" Foreground="Navy">Steps&#160;</TextBlock>
                                                    <TextBlock x:Name="txtQueryResultStepCount" Text="{Binding Path=SelectedQueryResultTestStepCount, RelativeSource={RelativeSource AncestorType=Window}, 
                                                        NotifyOnSourceUpdated=True, UpdateSourceTrigger=PropertyChanged}" FontWeight="Bold" Foreground="Navy"/>
                                                </StackPanel>
                                                <TextBlock DockPanel.Dock="Top" Height="5"/>
                                                <DataGrid DockPanel.Dock="Top" x:Name="dgSelectedQueryResultSteps" ItemsSource="{Binding}" Grid.Column="1" VerticalScrollBarVisibility="Visible"
                                                          Style="{StaticResource DataGridStyle1}" RowStyle="{StaticResource DataGridRowStyle1}" CellStyle="{StaticResource DataGridCellStyle5}"
                                                          HorizontalScrollBarVisibility="Hidden"
                                                          SelectionMode="Extended"  VerticalAlignment="Stretch"  Height="Auto" RowHeaderWidth="0"
                                                          IsReadOnly="True" Background="#FF90D2FF" VirtualizingStackPanel.IsVirtualizing="False">
                                                    <DataGrid.Columns>
                                                        <DataGridTextColumn Binding="{Binding mStepNumber}" CanUserSort="False" CanUserReorder="False" CanUserResize="True"  Header="#" HeaderStyle="{StaticResource DataGridColumnHeaderStyle0}"  Width="30" />
                                                        <DataGridTextColumn Binding="{Binding mExecute}" CanUserSort="False" CanUserReorder="False" CanUserResize="True"  Header="Execute" HeaderStyle="{StaticResource DataGridColumnHeaderStyle1}" Width="60" />
                                                        <DataGridTextColumn Binding="{Binding mScreen}" CanUserSort="False" CanUserReorder="False" CanUserResize="True"  Header="Screen" HeaderStyle="{StaticResource DataGridColumnHeaderStyle3}" Width="125" />
                                                        <DataGridTextColumn Binding="{Binding mControl}" CanUserSort="False" CanUserReorder="False" CanUserResize="True"  Header="Control" HeaderStyle="{StaticResource DataGridColumnHeaderStyle2}" Width="160" />
                                                        <DataGridTextColumn Binding="{Binding mKeyword}" CanUserSort="False" CanUserReorder="False" CanUserResize="True"  Header="Keyword" HeaderStyle="{StaticResource DataGridColumnHeaderStyle3}" Width="130" />
                                                        <DataGridTemplateColumn CanUserSort="False" CanUserReorder="False" CanUserResize="True"
                                                                Header="Parameters" HeaderStyle="{StaticResource DataGridColumnHeaderStyle4}" Width="*">
                                                            <DataGridTemplateColumn.CellTemplate>
                                                                <DataTemplate>
                                                                    <DockPanel>
                                                                        <TextBlock x:Name="txtParams" Text="{Binding mParameterString}" Foreground="MidnightBlue" HorizontalAlignment="Stretch" TextTrimming="CharacterEllipsis"></TextBlock>
                                                                    </DockPanel>
                                                                </DataTemplate>
                                                            </DataGridTemplateColumn.CellTemplate>
                                                        </DataGridTemplateColumn>
                                                    </DataGrid.Columns>
                                                </DataGrid>
                                            </DockPanel>
                                        </TabItem>
                                    </TabControl>
                                </Grid>
                            </Grid>
                            <Grid x:Name="grdSuiteQueryResults" Grid.Row="2" Visibility="Collapsed">
                                <!--STUB FOR SUITE RESULTS SECTION-->
                            </Grid>
                        </Grid>
                    </Grid>
                </TabItem>
                <TabItem x:Name="tabSuites" Header="Suites">
                    <Grid>
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="300"/>
                            <ColumnDefinition Width="5"/>
                            <ColumnDefinition/>
                        </Grid.ColumnDefinitions>
                        <Grid Grid.Column="0">
                            <Grid.RowDefinitions>
                                <RowDefinition Height="33"/>
                                <RowDefinition />
                            </Grid.RowDefinitions>
                            <DockPanel Grid.RowSpan="2" Margin="0,0,0,0">
                                <Grid DockPanel.Dock="Top" Background="#FF90D2FF" Margin="0,0,0,0">
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition />
                                        <ColumnDefinition Width="23"/>
                                    </Grid.ColumnDefinitions>
                                    <TextBox x:Name="txtSearchSuites" Grid.Column="0" HorizontalAlignment="Stretch" FontSize="10" KeyUp="txtSearchSuites_KeyUp"/>
                                    <Button Grid.Column="1" x:Name="btnSearchSuite" Style="{StaticResource ToolbarButtonStyle}" Width="20"  Height="20" Margin="0,2,2,2" IsEnabled="False" 
                                            DockPanel.Dock="Right" HorizontalAlignment="Right" ToolTip="Search" >
                                        <Image Source="pack://siteoforigin:,,,/Resources/find.png" Height="11" Width="11"/>
                                    </Button>
                                </Grid>
                                <TreeView x:Name="tvwAllSuites" ItemsSource="{Binding}" SelectedItemChanged="tvwAllSuites_SelectedItemChanged"
                                      ContextMenu="{StaticResource ctxSaveDialogTreeView}" VirtualizingStackPanel.IsVirtualizing="False" VirtualizingStackPanel.VirtualizationMode="Recycling">
                                    <TreeView.ItemContainerStyle>
                                        <Style TargetType="{x:Type TreeViewItem}">
                                            <EventSetter Event="Selected" Handler="ScrollSelectedTreeViewItem" />
                                            <Setter Property="IsSelected" Value="{Binding Path=IsSelected, Mode=TwoWay, NotifyOnSourceUpdated=True, UpdateSourceTrigger=PropertyChanged}" />
                                            <Style.Triggers>
                                                <DataTrigger Binding="{Binding Path, Converter={StaticResource IsExpSuiteConverter}, Mode=TwoWay}" Value="True">
                                                    <Setter Property="IsExpanded" Value="True"/>
                                                </DataTrigger>
                                            </Style.Triggers>
                                        </Style>
                                    </TreeView.ItemContainerStyle>
                                    <TreeView.Resources>
                                        <HierarchicalDataTemplate DataType="{x:Type common:BFFolder}" ItemsSource="{Binding DirItems}">
                                            <StackPanel Orientation="Horizontal">
                                                <Image Source="{Binding Icon}" VerticalAlignment="Stretch" Width="16" Height="16"/>
                                                <TextBlock Text="{Binding Name}" ToolTip="{Binding Path}" Margin="3,0,0,0"/>
                                                <StackPanel.ContextMenu>
                                                    <ContextMenu DataContext="{Binding PlacementTarget.DataContext, RelativeSource={RelativeSource Self}}" >
                                                        <MenuItem Header="Add/Edit Tags" Click="ctxAddEditTags_Click"/>
                                                    </ContextMenu>
                                                </StackPanel.ContextMenu>
                                            </StackPanel>
                                        </HierarchicalDataTemplate>
                                        <HierarchicalDataTemplate DataType="{x:Type common:BFFile}" ItemsSource="{Binding DirItems}">
                                            <StackPanel Orientation="Horizontal">
                                                <Image Source="{Binding Icon}" VerticalAlignment="Stretch" Width="15" Height="13"/>
                                                <TextBlock Text="{Binding Name}" ToolTip="{Binding Path}" Margin="3,0,0,0"/>
                                                <StackPanel.ContextMenu>
                                                    <ContextMenu DataContext="{Binding PlacementTarget.DataContext, RelativeSource={RelativeSource Self}}" >
                                                        <MenuItem Header="Add/Edit Tags" Click="ctxAddEditTags_Click"/>
                                                        <MenuItem Header="Edit" Click="ctxEditSuite_Click"/>
                                                        <MenuItem Header="Batch Replace..." Click="ctxBatchReplaceSuite_Click"/>
                                                    </ContextMenu>
                                                </StackPanel.ContextMenu>
                                            </StackPanel>
                                        </HierarchicalDataTemplate>
                                    </TreeView.Resources>
                                </TreeView>
                            </DockPanel>
                        </Grid>
                        <GridSplitter x:Name="gridSplitter" Grid.Column="1" ShowsPreview="False" Width="Auto" BorderBrush="Gray"  VerticalAlignment="Stretch" 
                                          BorderThickness="0,0,0,1" HorizontalAlignment="Stretch" Opacity="1" />
                        <Grid Grid.Column="2">
                            <Grid.RowDefinitions>
                                <RowDefinition Height="101"/>
                                <RowDefinition />
                                <RowDefinition Height="5"/>
                                <RowDefinition />
                            </Grid.RowDefinitions>
                            <StackPanel Grid.Row="0" Orientation="Vertical">
                                <TextBlock Foreground="Navy" FontWeight="Bold">Suite Name</TextBlock>
                                <TextBox x:Name="txtSuiteName" Height="22" IsReadOnly="True" ScrollViewer.VerticalScrollBarVisibility="Disabled">
                                    <TextBox.Style>
                                        <Style>
                                            <Setter Property="Panel.Background" Value="{DynamicResource ResourceKey={x:Static SystemColors.ControlBrushKey}}" />
                                            <Setter Property="TextElement.Foreground" Value="{DynamicResource ResourceKey={x:Static SystemColors.GrayTextBrushKey}}" />
                                        </Style>
                                    </TextBox.Style>
                                </TextBox>
                                <TextBlock Foreground="Navy" FontWeight="Bold">Suite Description</TextBlock>
                                <TextBox x:Name="txtSuiteDescription" Height="50" IsReadOnly="True" ScrollViewer.VerticalScrollBarVisibility="Auto">
                                    <TextBox.Style>
                                        <Style>
                                            <Setter Property="Panel.Background" Value="{DynamicResource ResourceKey={x:Static SystemColors.ControlBrushKey}}" />
                                            <Setter Property="TextElement.Foreground" Value="{DynamicResource ResourceKey={x:Static SystemColors.GrayTextBrushKey}}" />
                                        </Style>
                                    </TextBox.Style>
                                </TextBox>
                            </StackPanel>
                            <Grid Grid.Row="1">
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="20"/>
                                    <RowDefinition />
                                </Grid.RowDefinitions>
                                <TextBlock x:Name="tsHeader" Grid.Row="0" Foreground="Navy" FontWeight="Bold">Tests in Suite</TextBlock>
                                <DataGrid Grid.Row="1" HorizontalAlignment="Left" x:Name="dgTestsInSuite" ItemsSource="{Binding}" RowHeaderWidth="0"
            	                    Style="{StaticResource DataGridStyle1}" HorizontalScrollBarVisibility="Auto" VerticalScrollBarVisibility="Visible"
            	                    SelectionMode="Single" IsReadOnly="False" SelectionChanged="dgTestsInSuite_SelectionChanged"
            	                    CanUserAddRows="False" CanUserDeleteRows="False"
            	                    RowStyle="{StaticResource DataGridRowStyle0}" CellStyle="{StaticResource DataGridCellStyle8}"
                                    DockPanel.Dock="Top" VirtualizingStackPanel.IsVirtualizing="True" VerticalAlignment="Stretch" CanUserResizeColumns="True">
                                    <DataGrid.Columns>
                                        <DataGridTextColumn Binding="{Binding testrow}" CanUserSort="False" CanUserReorder="False" CanUserResize="True"  Header="#" HeaderStyle="{StaticResource DataGridColumnHeaderStyle0}" IsReadOnly="True" Width="25"/>
                                        <DataGridTextColumn Binding="{Binding execute}" CanUserSort="False" CanUserReorder="False" CanUserResize="True"  Header="Execute" HeaderStyle="{StaticResource DataGridColumnHeaderStyle0}" IsReadOnly="True" Width="75"/>
                                        <DataGridTextColumn x:Name="TestDisplayName" Binding="{Binding file}" CanUserSort="False" CanUserReorder="False" CanUserResize="True" HeaderStyle="{StaticResource DataGridColumnHeaderStyleTestQueue}" IsReadOnly="True"
                                        Width="250" Header="Filename">
                                        </DataGridTextColumn>
                                        <DataGridTextColumn Binding="{Binding description}" CanUserSort="False" CanUserReorder="False" CanUserResize="True" Header="Description" HeaderStyle="{StaticResource DataGridColumnHeaderStyle6}" IsReadOnly="True" Width="*">
                                            <DataGridTextColumn.ElementStyle>
                                                <Style>
                                                    <Setter Property="ToolTipService.ToolTip" Value="{Binding description}" />
                                                    <Setter Property="TextBlock.TextWrapping" Value="Wrap" />
                                                </Style>
                                            </DataGridTextColumn.ElementStyle>
                                        </DataGridTextColumn>
                                        <DataGridTextColumn Binding="{Binding instance}" CanUserSort="False" CanUserReorder="False" CanUserResize="True" Header="Instance" HeaderStyle="{StaticResource DataGridColumnHeaderStyle1}" IsReadOnly="True" Width="50">
                                        </DataGridTextColumn>
                                        <DataGridTextColumn Binding="{Binding Path=totalsteps, Converter={StaticResource STConverter}}"  CanUserSort="False" CanUserReorder="False" CanUserResize="True" Header="Steps" HeaderStyle="{StaticResource DataGridColumnHeaderStyle1}" IsReadOnly="True" Width="70">
                                            <DataGridTextColumn.ElementStyle>
                                                <Style TargetType="TextBlock">
                                                    <Setter Property="HorizontalAlignment" Value="Center" />
                                                </Style>
                                            </DataGridTextColumn.ElementStyle>
                                        </DataGridTextColumn>
                                    </DataGrid.Columns>
                                </DataGrid>
                            </Grid>
                            <GridSplitter Grid.Column="1" Grid.Row="2" ShowsPreview="False" Width="Auto" BorderBrush="Gray"  VerticalAlignment="Stretch" 
                                          BorderThickness="0,0,0,1" HorizontalAlignment="Stretch" Opacity="1" />
                            <Grid Grid.Row="3">
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="101"/>
                                    <RowDefinition />
                                    <!--<RowDefinition Height="5"/>
                                    <RowDefinition />-->
                                </Grid.RowDefinitions>
                                <StackPanel Grid.Row="0" Orientation="Vertical">
                                    <Grid>
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition/>
                                            <ColumnDefinition Width="5"/>
                                            <ColumnDefinition/>
                                        </Grid.ColumnDefinitions>
                                        <TextBlock Grid.Column="0" Foreground="Navy" FontWeight="Bold">Test Name</TextBlock>
                                        <TextBlock Grid.Column="2" Foreground="Navy" FontWeight="Bold">Author</TextBlock>
                                    </Grid>
                                    <Grid>
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition/>
                                            <ColumnDefinition Width="5"/>
                                            <ColumnDefinition/>
                                        </Grid.ColumnDefinitions>
                                        <TextBox x:Name="txtSelectedTestName" Grid.Column="0" Height="22" IsReadOnly="True" ScrollViewer.VerticalScrollBarVisibility="Disabled">
                                            <TextBox.Style>
                                                <Style>
                                                    <Setter Property="Panel.Background" Value="{DynamicResource ResourceKey={x:Static SystemColors.ControlBrushKey}}" />
                                                    <Setter Property="TextElement.Foreground" Value="{DynamicResource ResourceKey={x:Static SystemColors.GrayTextBrushKey}}" />
                                                </Style>
                                            </TextBox.Style>
                                        </TextBox>
                                        <TextBox x:Name="txtSelectedTestAuthor" Grid.Column="2" Height="22" IsReadOnly="True" ScrollViewer.VerticalScrollBarVisibility="Disabled">
                                            <TextBox.Style>
                                                <Style>
                                                    <Setter Property="Panel.Background" Value="{DynamicResource ResourceKey={x:Static SystemColors.ControlBrushKey}}" />
                                                    <Setter Property="TextElement.Foreground" Value="{DynamicResource ResourceKey={x:Static SystemColors.GrayTextBrushKey}}" />
                                                </Style>
                                            </TextBox.Style>
                                        </TextBox>
                                    </Grid>
                                    <TextBlock Foreground="Navy" FontWeight="Bold">Test Description</TextBlock>
                                    <TextBox x:Name="txtSelectedTestDescription" Height="50" IsReadOnly="True" ScrollViewer.VerticalScrollBarVisibility="Auto">
                                        <TextBox.Style>
                                            <Style>
                                                <Setter Property="Panel.Background" Value="{DynamicResource ResourceKey={x:Static SystemColors.ControlBrushKey}}" />
                                                <Setter Property="TextElement.Foreground" Value="{DynamicResource ResourceKey={x:Static SystemColors.GrayTextBrushKey}}" />
                                            </Style>
                                        </TextBox.Style>
                                    </TextBox>
                                </StackPanel>
                                <Grid Grid.Row="1" Margin="0,0,0,50">
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="50"/>
                                        <ColumnDefinition />
                                        <ColumnDefinition Width="120"/>
                                    </Grid.ColumnDefinitions>
                                    <TextBlock Grid.Column="0" Foreground="Navy" FontWeight="Bold">Steps</TextBlock>
                                    <CheckBox x:Name="chkShowData" Grid.Column="2" IsChecked="True" Checked="chkShowData_Checked" Unchecked="chkShowData_Unchecked">Show data values?</CheckBox>
                                </Grid>
                                <DataGrid Grid.Row="1" x:Name="dgTestSteps" ItemsSource="{Binding}" VerticalScrollBarVisibility="Visible"
            	                    Style="{StaticResource DataGridStyle1}" RowStyle="{StaticResource DataGridRowStyle1}" CellStyle="{StaticResource DataGridCellStyle5}"
            	                    HorizontalScrollBarVisibility="Hidden"
            	                    SelectionMode="Extended"  VerticalAlignment="Stretch"  Height="Auto" RowHeaderWidth="0"
            	                    IsReadOnly="True"
            	                    Background="#FF90D2FF" VirtualizingStackPanel.IsVirtualizing="False" Margin="0,21,0,10" Grid.RowSpan="3" RenderTransformOrigin="0.497,0.649">
                                    <DataGrid.Columns>
                                        <DataGridTextColumn Binding="{Binding mStepNumber}" CanUserSort="False" CanUserReorder="False" CanUserResize="True"  Header="Step" HeaderStyle="{StaticResource DataGridColumnHeaderStyle0}"  Width="40" />
                                        <DataGridTextColumn Binding="{Binding mExecute}" CanUserSort="False" CanUserReorder="False" CanUserResize="True"  Header="Execute" HeaderStyle="{StaticResource DataGridColumnHeaderStyle1}" Width="60" />
                                        <DataGridTextColumn Binding="{Binding mScreen}" CanUserSort="False" CanUserReorder="False" CanUserResize="True"  Header="Screen" HeaderStyle="{StaticResource DataGridColumnHeaderStyle3}" Width="196" />
                                        <DataGridTextColumn Binding="{Binding mControl}" CanUserSort="False" CanUserReorder="False" CanUserResize="True"  Header="Control" HeaderStyle="{StaticResource DataGridColumnHeaderStyle2}" Width="197" />
                                        <DataGridTextColumn Binding="{Binding mKeyword}" CanUserSort="False" CanUserReorder="False" CanUserResize="True"  Header="Keyword" HeaderStyle="{StaticResource DataGridColumnHeaderStyle3}" Width="197" />
                                        <DataGridTemplateColumn CanUserSort="False" CanUserReorder="False" CanUserResize="True"
                                                                Header="Parameters" HeaderStyle="{StaticResource DataGridColumnHeaderStyle4}" Width="*">
                                            <DataGridTemplateColumn.CellTemplate>
                                                <DataTemplate>
                                                    <DockPanel>
                                                        <TextBlock x:Name="txtParams" Text="{Binding mParameterString}" Foreground="MidnightBlue" HorizontalAlignment="Stretch" TextTrimming="CharacterEllipsis"></TextBlock>
                                                    </DockPanel>
                                                </DataTemplate>
                                            </DataGridTemplateColumn.CellTemplate>
                                        </DataGridTemplateColumn>
                                    </DataGrid.Columns>
                                </DataGrid>
                            </Grid>
                        </Grid>
                    </Grid>
                </TabItem>
                <TabItem x:Name="tabTests" Header="Tests">
                    <Grid>
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="300"/>
                            <ColumnDefinition Width="5"/>
                            <ColumnDefinition/>
                        </Grid.ColumnDefinitions>
                        <Grid Grid.Column="0">
                            <Grid.RowDefinitions>
                                <RowDefinition Height="33"/>
                                <RowDefinition />
                            </Grid.RowDefinitions>
                            <DockPanel Grid.RowSpan="2" Margin="0,0,0,0">
                                <Grid DockPanel.Dock="Top" Background="#FF90D2FF" Margin="0,0,0,0">
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition />
                                        <ColumnDefinition Width="23"/>
                                    </Grid.ColumnDefinitions>
                                    <TextBox Grid.Column="0" Name="txtSearchTests" HorizontalAlignment="Stretch" FontSize="10"  KeyUp="txtSearchTests_KeyUp"/>
                                    <Button Grid.Column="1" x:Name="btnSearchTest" Style="{StaticResource ToolbarButtonStyle}" Width="20"  Height="20" Margin="0,2,2,2" IsEnabled="False" HorizontalAlignment="Right" ToolTip="Search" >
                                        <Image Source="pack://siteoforigin:,,,/Resources/find.png" Height="11" Width="11"/>
                                    </Button>
                                </Grid>
                                <TreeView x:Name="tvwAllTests" ItemsSource="{Binding}"
                                      SelectedItemChanged="tvwAllTests_SelectedItemChanged" VirtualizingStackPanel.IsVirtualizing="False" VirtualizingStackPanel.VirtualizationMode="Recycling">
                                    <TreeView.ItemContainerStyle>
                                        <Style TargetType="{x:Type TreeViewItem}">
                                            <EventSetter Event="Selected" Handler="GetSelectedItem" />
                                            <Setter Property="IsSelected" Value="{Binding Path=IsSelected, Mode=TwoWay, NotifyOnSourceUpdated=True, UpdateSourceTrigger=PropertyChanged}" />
                                            <EventSetter Event="TreeViewItem.MouseRightButtonDown" Handler="tvwAllTests_MouseRightButtonDown"/>
                                            <EventSetter Event="TreeViewItem.PreviewMouseRightButtonDown" Handler="tvwAllTests_PreviewMouseRightButtonDown"/>
                                            <EventSetter Event="TreeViewItem.PreviewMouseLeftButtonDown" Handler="tvwAllTests_PreviewMouseLeftButtonDown"/>
                                            <Style.Triggers>
                                                <DataTrigger Binding="{Binding Path, Converter={StaticResource IsExpTestConverter}, Mode=TwoWay}" Value="True">
                                                    <Setter Property="IsExpanded" Value="True"/>
                                                </DataTrigger>
                                            </Style.Triggers>
                                        </Style>
                                    </TreeView.ItemContainerStyle>
                                    <TreeView.Resources>
                                        <HierarchicalDataTemplate DataType="{x:Type common:KwFolder}" ItemsSource="{Binding DirItems}">
                                            <StackPanel Orientation="Horizontal" Background="Transparent" ContextMenuOpening="tvwAllTests_ContextMenuOpening">
                                                <Image Source="{Binding Icon}" VerticalAlignment="Stretch" Width="16" Height="16"/>
                                                <TextBlock Text="{Binding Name}" ToolTip="{Binding Path}" Margin="3,0,0,0"/>
                                                <StackPanel.ContextMenu>
                                                    <ContextMenu DataContext="{Binding PlacementTarget.DataContext, RelativeSource={RelativeSource Self}}">
                                                        <MenuItem Header="Add Tags..." Click="ctxAddTags_Click"/>
                                                        <MenuItem Header="Find Duplicates..." Click="ctxFindDuplicate_Click"/>
                                                        <MenuItem Header="Batch Replace..." Click="ctxBatchReplace_Click"/>
                                                    </ContextMenu>
                                                </StackPanel.ContextMenu>
                                            </StackPanel>
                                        </HierarchicalDataTemplate>
                                        <DataTemplate DataType="{x:Type common:KwFile}">
                                            <StackPanel Orientation="Horizontal" Background="Transparent" ContextMenuOpening="tvwAllTests_ContextMenuOpening">
                                                <Image Source="{Binding Icon}" VerticalAlignment="Stretch" Width="15" Height="13"/>
                                                <TextBlock Text="{Binding Name}" ToolTip="{Binding Path}" Margin="3,0,0,0"/>
                                                <StackPanel.ContextMenu>
                                                    <ContextMenu DataContext="{Binding PlacementTarget.DataContext, RelativeSource={RelativeSource Self}}">
                                                        <MenuItem Header="Add Tags..." Click="ctxAddTags_Click"/>
                                                        <MenuItem Header="Find Duplicates..." Click="ctxFindDuplicate_Click"/>
                                                        <Separator/>
                                                        <MenuItem Header="Edit..." Click="ctxEditTest_Click"/>
                                                    </ContextMenu>
                                                </StackPanel.ContextMenu>
                                            </StackPanel>
                                        </DataTemplate>
                                        <SolidColorBrush x:Key="{x:Static SystemColors.HighlightBrushKey}"
                                                 Color="DodgerBlue" />
                                        <SolidColorBrush x:Key="{x:Static SystemColors.HighlightTextBrushKey}"
                                                 Color="White" />
                                        <SolidColorBrush x:Key="{x:Static SystemColors.InactiveSelectionHighlightBrushKey}"
                                                 Color="DodgerBlue" />
                                        <SolidColorBrush x:Key="{x:Static SystemColors.InactiveSelectionHighlightTextBrushKey}"
                                                 Color="White" />
                                    </TreeView.Resources>
                                </TreeView>
                            </DockPanel>
                        </Grid>
                        <GridSplitter x:Name="gridSplitterTest" Grid.Column="1" ShowsPreview="False" Width="Auto" BorderBrush="Gray"  VerticalAlignment="Stretch" 
                                          BorderThickness="0,0,0,1" HorizontalAlignment="Stretch" Opacity="1" />
                        <Grid Grid.Column="3">
                            <Grid.RowDefinitions>
                                <RowDefinition Height="101"/>
                                <RowDefinition />
                                <RowDefinition Height="5"/>
                                <RowDefinition />
                                <RowDefinition Height="5"/>
                                <RowDefinition />
                            </Grid.RowDefinitions>
                            <StackPanel Grid.Row="0" Orientation="Vertical">
                                <Grid>
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition />
                                        <ColumnDefinition Width="5"/>
                                        <ColumnDefinition />
                                    </Grid.ColumnDefinitions>
                                    <TextBlock Grid.Column="0" Foreground="Navy" FontWeight="Bold">Test Name</TextBlock>
                                    <TextBlock Grid.Column="2" Foreground="Navy" FontWeight="Bold">Author</TextBlock>
                                </Grid>
                                <Grid>
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition/>
                                        <ColumnDefinition Width="5"/>
                                        <ColumnDefinition/>
                                    </Grid.ColumnDefinitions>
                                    <TextBox Grid.Column="0" x:Name="txtTestName" Height="22" IsReadOnly="False" ScrollViewer.VerticalScrollBarVisibility="Disabled">
                                        <TextBox.Style>
                                            <Style>
                                                <Setter Property="Panel.Background" Value="{DynamicResource ResourceKey={x:Static SystemColors.ControlBrushKey}}" />
                                                <Setter Property="TextElement.Foreground" Value="{DynamicResource ResourceKey={x:Static SystemColors.GrayTextBrushKey}}" />
                                            </Style>
                                        </TextBox.Style>
                                    </TextBox>
                                    <TextBox Grid.Column="2" x:Name="txtTestAuthor" Height="22" IsReadOnly="False" ScrollViewer.VerticalScrollBarVisibility="Disabled">
                                        <TextBox.Style>
                                            <Style>
                                                <Setter Property="Panel.Background" Value="{DynamicResource ResourceKey={x:Static SystemColors.ControlBrushKey}}" />
                                                <Setter Property="TextElement.Foreground" Value="{DynamicResource ResourceKey={x:Static SystemColors.GrayTextBrushKey}}" />
                                            </Style>
                                        </TextBox.Style>
                                    </TextBox>
                                </Grid>
                                <TextBlock Foreground="Navy" FontWeight="Bold">Test Description</TextBlock>
                                <TextBox x:Name="txtTestDescription" Height="50" IsReadOnly="False" ScrollViewer.VerticalScrollBarVisibility="Auto">
                                    <TextBox.Style>
                                        <Style>
                                            <Setter Property="Panel.Background" Value="{DynamicResource ResourceKey={x:Static SystemColors.ControlBrushKey}}" />
                                            <Setter Property="TextElement.Foreground" Value="{DynamicResource ResourceKey={x:Static SystemColors.GrayTextBrushKey}}" />
                                        </Style>
                                    </TextBox.Style>
                                </TextBox>
                            </StackPanel>
                            <Grid Grid.Row="1">
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="20"/>
                                    <RowDefinition />
                                </Grid.RowDefinitions>
                                <TextBlock Grid.Row="0" Foreground="Navy" FontWeight="Bold">Parent Suites</TextBlock>
                                <DataGrid Grid.Row="1" HorizontalAlignment="Left" x:Name="dgContainingSuites" ItemsSource="{Binding}" RowHeaderWidth="0"
            	                    Style="{StaticResource DataGridStyle1}" HorizontalScrollBarVisibility="Auto" VerticalScrollBarVisibility="Visible"
            	                    SelectionMode="Single" IsReadOnly="False" SelectionChanged="dgContainingSuites_SelectionChanged"
            	                    CanUserAddRows="False" CanUserDeleteRows="False"
            	                    RowStyle="{StaticResource DataGridRowStyle0}" CellStyle="{StaticResource DataGridCellStyle8}"
                                    DockPanel.Dock="Top" VirtualizingStackPanel.IsVirtualizing="False" VerticalAlignment="Stretch" CanUserResizeColumns="True">
                                    <DataGrid.Columns>
                                        <DataGridTextColumn Binding="{Binding ListIndex}" CanUserSort="False" CanUserReorder="False" CanUserResize="True"  Header="#" HeaderStyle="{StaticResource DataGridColumnHeaderStyle0}" IsReadOnly="True" Width="25"/>
                                        <DataGridTextColumn Binding="{Binding name}" CanUserSort="False" CanUserReorder="False" CanUserResize="True"  Header="Suite Name" HeaderStyle="{StaticResource DataGridColumnHeaderStyle0}" IsReadOnly="True" Width="400"/>
                                        <DataGridTextColumn Binding="{Binding SuiteInfo.Description}" CanUserSort="False" CanUserReorder="False" CanUserResize="True"  Header="Description" HeaderStyle="{StaticResource DataGridColumnHeaderStyle0}" IsReadOnly="True" Width="*"/>
                                    </DataGrid.Columns>
                                </DataGrid>
                            </Grid>
                            <GridSplitter Grid.Column="1" Grid.Row="2" ShowsPreview="False" Width="Auto" BorderBrush="Gray"  VerticalAlignment="Stretch" 
                                          BorderThickness="0,0,0,1" HorizontalAlignment="Stretch" Opacity="1" />
                            <Grid Grid.Row="3">
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="20"/>
                                    <RowDefinition />
                                </Grid.RowDefinitions>
                                <TextBlock Grid.Row="0" Foreground="Navy" FontWeight="Bold">Tests in Parent Suite</TextBlock>
                                <DataGrid Grid.Row="1" HorizontalAlignment="Left" x:Name="dgTestsInContainingSuite" ItemsSource="{Binding}" RowHeaderWidth="0"
            	                    Style="{StaticResource DataGridStyle1}" HorizontalScrollBarVisibility="Auto" VerticalScrollBarVisibility="Visible"
            	                    SelectionMode="Single" IsReadOnly="False" SelectionChanged="dgTestsInContainingSuite_SelectionChanged"
            	                    CanUserAddRows="False" CanUserDeleteRows="False"
            	                    RowStyle="{StaticResource DataGridRowStyle0}" CellStyle="{StaticResource DataGridCellStyle8}"
                                    DockPanel.Dock="Top" VirtualizingStackPanel.IsVirtualizing="True" VerticalAlignment="Stretch" CanUserResizeColumns="True">
                                    <DataGrid.Columns>
                                        <DataGridTextColumn Binding="{Binding testrow}" CanUserSort="False" CanUserReorder="False" CanUserResize="True"  Header="#" HeaderStyle="{StaticResource DataGridColumnHeaderStyle0}" IsReadOnly="True" Width="25"/>
                                        <DataGridTextColumn Binding="{Binding execute}" CanUserSort="False" CanUserReorder="False" CanUserResize="True"  Header="Execute" HeaderStyle="{StaticResource DataGridColumnHeaderStyle0}" IsReadOnly="True" Width="75"/>
                                        <DataGridTextColumn Binding="{Binding file}" CanUserSort="False" CanUserReorder="False" CanUserResize="True" HeaderStyle="{StaticResource DataGridColumnHeaderStyleTestQueue}" IsReadOnly="True"
                                        Width="250" Header="Filename">
                                        </DataGridTextColumn>
                                        <DataGridTextColumn Binding="{Binding description}" CanUserSort="False" CanUserReorder="False" CanUserResize="True" Header="Description" HeaderStyle="{StaticResource DataGridColumnHeaderStyle6}" IsReadOnly="True" Width="*">
                                            <DataGridTextColumn.ElementStyle>
                                                <Style>
                                                    <Setter Property="ToolTipService.ToolTip" Value="{Binding description}" />
                                                    <Setter Property="TextBlock.TextWrapping" Value="Wrap" />
                                                </Style>
                                            </DataGridTextColumn.ElementStyle>
                                        </DataGridTextColumn>
                                        <DataGridTextColumn Binding="{Binding instance}" CanUserSort="False" CanUserReorder="False" CanUserResize="True" Header="Instance" HeaderStyle="{StaticResource DataGridColumnHeaderStyle1}" IsReadOnly="True" Width="50">
                                        </DataGridTextColumn>


                                        <DataGridTextColumn Binding="{Binding Path=executedsteps, Converter={StaticResource STConverter}}"  CanUserSort="False" CanUserReorder="False" CanUserResize="True" Header="Steps" HeaderStyle="{StaticResource DataGridColumnHeaderStyle1}" IsReadOnly="True" Width="70">
                                            <DataGridTextColumn.ElementStyle>
                                                <Style TargetType="TextBlock">
                                                    <Setter Property="HorizontalAlignment" Value="Center" />
                                                </Style>
                                            </DataGridTextColumn.ElementStyle>
                                        </DataGridTextColumn>
                                    </DataGrid.Columns>
                                </DataGrid>
                            </Grid>
                            <GridSplitter Grid.Column="1" Grid.Row="4" ShowsPreview="False" Width="Auto" BorderBrush="Gray"  VerticalAlignment="Stretch" 
                                          BorderThickness="0,0,0,1" HorizontalAlignment="Stretch" Opacity="1" />
                            <Grid Grid.Row="5">
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="20"/>
                                    <RowDefinition />
                                </Grid.RowDefinitions>
                                <Grid Grid.Row="0">
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="50"/>
                                        <ColumnDefinition />
                                        <ColumnDefinition Width="120"/>
                                    </Grid.ColumnDefinitions>
                                    <TextBlock Grid.Column="0" Foreground="Navy" FontWeight="Bold">Steps</TextBlock>
                                    <CheckBox x:Name="chkShowDataTest" Grid.Column="2" IsChecked="True" Checked="chkShowDataTest_Checked" Unchecked="chkShowDataTest_Unchecked">Show data values?</CheckBox>
                                </Grid>
                                <DataGrid Grid.Row="1" x:Name="dgTestStepsTest" ItemsSource="{Binding}" Grid.Column="1" VerticalScrollBarVisibility="Visible"
            	                    Style="{StaticResource DataGridStyle1}" RowStyle="{StaticResource DataGridRowStyle1}" CellStyle="{StaticResource DataGridCellStyle5}"
            	                    HorizontalScrollBarVisibility="Hidden"
            	                    SelectionMode="Extended"  VerticalAlignment="Stretch"  Height="Auto" RowHeaderWidth="0"
            	                    IsReadOnly="True"
            	                    Background="#FF90D2FF" VirtualizingStackPanel.IsVirtualizing="False">
                                    <DataGrid.Columns>
                                        <DataGridTextColumn Binding="{Binding mStepNumber}" CanUserSort="False" CanUserReorder="False" CanUserResize="True"  Header="Step" HeaderStyle="{StaticResource DataGridColumnHeaderStyle0}"  Width="40" />
                                        <DataGridTextColumn Binding="{Binding mExecute}" CanUserSort="False" CanUserReorder="False" CanUserResize="True"  Header="Execute" HeaderStyle="{StaticResource DataGridColumnHeaderStyle1}" Width="60" />
                                        <DataGridTextColumn Binding="{Binding mScreen}" CanUserSort="False" CanUserReorder="False" CanUserResize="True"  Header="Screen" HeaderStyle="{StaticResource DataGridColumnHeaderStyle3}" Width="196" />
                                        <DataGridTextColumn Binding="{Binding mControl}" CanUserSort="False" CanUserReorder="False" CanUserResize="True"  Header="Control" HeaderStyle="{StaticResource DataGridColumnHeaderStyle2}" Width="197" />
                                        <DataGridTextColumn Binding="{Binding mKeyword}" CanUserSort="False" CanUserReorder="False" CanUserResize="True"  Header="Keyword" HeaderStyle="{StaticResource DataGridColumnHeaderStyle3}" Width="197" />
                                        <DataGridTemplateColumn CanUserSort="False" CanUserReorder="False" CanUserResize="True"
                                                                Header="Parameters" HeaderStyle="{StaticResource DataGridColumnHeaderStyle4}" Width="*">
                                            <DataGridTemplateColumn.CellTemplate>
                                                <DataTemplate>
                                                    <DockPanel>
                                                        <TextBlock x:Name="txtParams" Text="{Binding mParameterString}" Foreground="MidnightBlue" HorizontalAlignment="Stretch" TextTrimming="CharacterEllipsis"></TextBlock>
                                                    </DockPanel>
                                                </DataTemplate>
                                            </DataGridTemplateColumn.CellTemplate>
                                        </DataGridTemplateColumn>
                                    </DataGrid.Columns>
                                </DataGrid>
                            </Grid>
                        </Grid>
                    </Grid>
                </TabItem>
                <TabItem x:Name="tabFinder" Header="Finder">
                    <Grid>
                        <Grid.RowDefinitions>
                            <RowDefinition/>
                        </Grid.RowDefinitions>
                        <Grid Grid.Row="0">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="300"/>
                                <ColumnDefinition Width="5"/>
                                <ColumnDefinition />
                            </Grid.ColumnDefinitions>
                            <Grid Grid.Column="0">
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="60"/>
                                    <RowDefinition />
                                </Grid.RowDefinitions>
                                <Grid Grid.Row="0">
                                    <GroupBox Header="Recorder" Margin="0,0,0,0" IsEnabled="False">
                                        <StackPanel Margin="0,0,0,0" Orientation="Horizontal" HorizontalAlignment="Center">
                                            <Button Style="{StaticResource TestEditorToolBarButtonStyle}" x:Name="btnStartRecording" ToolTip="Record">
                                                <StackPanel Orientation="Vertical">
                                                    <Image Name ="recImage" Source="pack://siteoforigin:,,,/Resources/recordstart.ico" Height="16" Width="40"/>
                                                    <TextBlock Name="recordLabel" HorizontalAlignment="Center" FontSize="9" TextWrapping="Wrap" FontWeight="SemiBold">Start</TextBlock>
                                                </StackPanel>
                                            </Button>
                                            <Button Style="{StaticResource TestEditorToolBarButtonStyle}" x:Name="btnPauseRecording" ToolTip="Pause">
                                                <StackPanel Orientation="Vertical">
                                                    <Image Source="pack://siteoforigin:,,,/Resources/recordpause.png" Height="16" Width="40"/>
                                                    <TextBlock HorizontalAlignment="Center" FontSize="9" TextWrapping="Wrap" FontWeight="SemiBold">Pause</TextBlock>
                                                </StackPanel>
                                            </Button>
                                            <Button Style="{StaticResource TestEditorToolBarButtonStyle}" x:Name="btnStopRecording" ToolTip="Stop">
                                                <StackPanel Orientation="Vertical">
                                                    <Image Source="pack://siteoforigin:,,,/Resources/stoprecord.png" Height="13" Width="40"/>
                                                    <TextBlock HorizontalAlignment="Center" FontSize="9" TextWrapping="Wrap" FontWeight="SemiBold">Stop</TextBlock>
                                                </StackPanel>
                                            </Button>
                                        </StackPanel>
                                    </GroupBox>

                                </Grid>
                                <Grid Grid.Row="1">
                                    <Grid.RowDefinitions>
                                        <RowDefinition/>
                                    </Grid.RowDefinitions>
                                    <TabControl Background="#FF90D2FF" Margin="0,0,0,0" Grid.Row="0">
                                        <TabItem Visibility="Collapsed">
                                            
                                            <Grid>
                                                <Grid.RowDefinitions>
                                                    <RowDefinition Height="auto"/>
                                                    <RowDefinition MinHeight="300"/>
                                                </Grid.RowDefinitions>
                                                <StackPanel Margin="4" Grid.Row="0">
                                                    <TextBlock  VerticalAlignment="Center" Foreground="Navy" FontWeight="Bold" Margin="0,0,0,5">Finder</TextBlock>

                                                    <TextBlock>Screen:</TextBlock>
                                                    <ComboBox x:Name="cboScreens" SelectionChanged="cboScreens_SelectionChanged" IsEditable="True"></ComboBox>

                                                    <TextBlock>Control:</TextBlock>
                                                    <ComboBox x:Name="cboControls" SelectionChanged="cboControls_SelectionChanged" IsEditable="True" TextSearch.TextPath="ControlName" IsTextSearchEnabled="True" SelectedValuePath="ControlName">
                                                        <ComboBox.ItemTemplate>
                                                            <DataTemplate>
                                                                <StackPanel Orientation="Horizontal">
                                                                    <TextBlock x:Name="tbControlType" Width="80" Foreground="Gray" Text="{Binding ControlType}"/>
                                                                    <TextBlock x:Name="tbControlName" Text="{Binding ControlName}"/>
                                                                </StackPanel>
                                                            </DataTemplate>
                                                        </ComboBox.ItemTemplate>
                                                    </ComboBox>

                                                    <TextBlock>Keyword:</TextBlock>
                                                    <ComboBox x:Name="cboKeywords" SelectionChanged="cboKeywords_SelectionChanged" IsEditable="True"></ComboBox>

                                                    <TextBlock>Parameters:</TextBlock>
                                                    <TextBox x:Name="txtParameters" Visibility="Collapsed"></TextBox>
                                                    <DataGrid x:Name="dgParameters" ItemsSource="{Binding}" Style="{StaticResource DataGridStyle3}" SelectionUnit="Cell" SelectionMode="Single" 
                              MinHeight="25" MaxHeight="125" Height="Auto" BorderThickness="1"
                              VerticalScrollBarVisibility="Auto">
                                                        <DataGrid.Columns>
                                                            <DataGridTextColumn IsReadOnly="True" Binding="{Binding mParameterName}" CanUserSort="False" CanUserReorder="False" CanUserResize="False"  Header="Parameters" HeaderStyle="{StaticResource DataGridColumnHeaderStyle0}"  Width="100">
                                                                <DataGridTextColumn.CellStyle>
                                                                    <Style TargetType="DataGridCell" >
                                                                        <Setter Property="MinHeight" Value="25"/>
                                                                        <Setter Property="FontSize" Value="11" />
                                                                        <Setter Property="BorderThickness" Value="0.25"/>
                                                                        <Setter Property="Width" Value="Auto"/>
                                                                        <Setter Property="Background" Value="{x:Static SystemColors.ControlLightBrush}"/>
                                                                        <Setter Property="BorderBrush" Value="Transparent"/>
                                                                        <Setter Property="VerticalContentAlignment" Value="Center"/>
                                                                        <Setter Property="IsTabStop" Value="False" />
                                                                        <Style.Triggers>
                                                                            <Trigger Property="IsSelected" Value="True">
                                                                                <Setter Property="Foreground" Value="Black" />
                                                                            </Trigger>
                                                                        </Style.Triggers>
                                                                    </Style>
                                                                </DataGridTextColumn.CellStyle>
                                                                <DataGridTextColumn.ElementStyle>
                                                                    <Style TargetType="TextBlock">
                                                                        <Setter Property="VerticalAlignment" Value="Center" />
                                                                        <Setter Property="Margin" Value="5,0,0,0" />
                                                                    </Style>
                                                                </DataGridTextColumn.ElementStyle>
                                                            </DataGridTextColumn>
                                                            <DataGridTemplateColumn CanUserSort="False" CanUserReorder="False" CanUserResize="False"  Header="Values" HeaderStyle="{StaticResource DataGridColumnHeaderStyle1}" Width="*">
                                                                <DataGridTemplateColumn.CellStyle>
                                                                    <Style TargetType="DataGridCell">
                                                                        <Style.Triggers>
                                                                            <Trigger Property="IsSelected" Value="True">
                                                                                <Setter Property="Background" Value="White" />
                                                                                <Setter Property="BorderBrush" Value="Transparent" />
                                                                            </Trigger>
                                                                        </Style.Triggers>
                                                                        <Setter Property="IsTabStop" Value="False"/>
                                                                    </Style>
                                                                </DataGridTemplateColumn.CellStyle>
                                                                <DataGridTemplateColumn.CellTemplate>
                                                                    <DataTemplate>
                                                                        <Grid>
                                                                            <Grid.ColumnDefinitions>
                                                                                <ColumnDefinition Width="120"/>
                                                                                <ColumnDefinition Width="1"/>
                                                                                <ColumnDefinition Width="*" />
                                                                                <ColumnDefinition Width="Auto"/>
                                                                            </Grid.ColumnDefinitions>
                                                                            <TextBox Text="{Binding mValue, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" Grid.Column="0" Grid.ColumnSpan="2" HorizontalAlignment="Stretch" VerticalAlignment="Stretch">
                                                                                <TextBox.Style>
                                                                                    <Style TargetType="TextBox">
                                                                                        <EventSetter Event="GotFocus" Handler="EditCell"/>
                                                                                        <Setter Property="TextWrapping" Value="Wrap" />
                                                                                        <Setter Property="AcceptsReturn" Value="true" />
                                                                                        <Setter Property="MaxHeight" Value="125" />
                                                                                        <Setter Property="VerticalScrollBarVisibility" Value="Auto"/>
                                                                                        <Setter Property="BorderBrush" Value="Transparent" />
                                                                                    </Style>
                                                                                </TextBox.Style>
                                                                            </TextBox>
                                                                            <Separator Grid.Column="1" Style="{StaticResource {x:Static ToolBar.SeparatorStyleKey}}" Background="#FFAFB1B2" Width="1"/>
                                                                            <CheckBox Grid.Column="2" IsChecked="{Binding mContains, UpdateSourceTrigger=PropertyChanged}" HorizontalAlignment="Stretch" VerticalAlignment="Center">contains?</CheckBox>

                                                                        </Grid>
                                                                    </DataTemplate>
                                                                </DataGridTemplateColumn.CellTemplate>
                                                            </DataGridTemplateColumn>
                                                        </DataGrid.Columns>
                                                    </DataGrid>
                                                    <Label></Label>
                                                    <Button x:Name="btnUpdate" Grid.Row="6" Style="{StaticResource ButtonStyle3}" Content="Update" Click="btnUpdate_Click"/>
                                                </StackPanel>
                                                <StackPanel VerticalAlignment="Bottom" Margin="4,4,4,30" Grid.Row="1">
                                                    <TextBlock Grid.Row="0" VerticalAlignment="Center" Foreground="Navy" FontWeight="Bold" Margin="0,20,0,5">Filters</TextBlock>
                                                    <Grid>
                                                        <Grid.ColumnDefinitions>
                                                            <ColumnDefinition Width="auto"/>
                                                            <ColumnDefinition/>
                                                            <ColumnDefinition/>
                                                        </Grid.ColumnDefinitions>
                                                        <TextBlock Grid.Column="0">Description:</TextBlock>
                                                        <Image 
                                                            x:Name="descriptionInfo" 
                                                            Source="pack://siteoforigin:,,,/Resources/information.png" 
                                                            Width="12" 
                                                            Height="12" 
                                                            Grid.Column="1" 
                                                            HorizontalAlignment="Left" 
                                                            Margin="5,0,0,0" 
                                                            Cursor="Hand"
                                                            MouseDown="filterInfo_Show"/>
                                                        <CheckBox Click="Filter_Change" x:Name="cbDescExactmatch" Grid.Column="2" HorizontalAlignment="Right">Exact Match</CheckBox>
                                                    </Grid>
                                                    <TextBox
                                                        x:Name="tbxDescription"
                                                        MouseUp="Filter_Change"
                                                        KeyUp="Filter_Change"
                                                        FontSize="11" 
                                                        MinHeight="25" 
                                                        Height="50" 
                                                        BorderThickness=".4" 
                                                        BorderBrush="Gray"  
                                                        TextWrapping="Wrap" 
                                                        AcceptsReturn="True" 
                                                        HorizontalScrollBarVisibility="Disabled" 
                                                        VerticalScrollBarVisibility="Auto"/>
                                                    <TextBlock FontSize="10" FontStyle="Italic" TextWrapping="Wrap" Foreground="DarkSlateGray">Ex: Sample Test Description</TextBlock>
                                                    <Grid Margin="0,10,0,0">
                                                        <Grid.ColumnDefinitions>
                                                            <ColumnDefinition Width="auto"/>
                                                            <ColumnDefinition/>
                                                            <ColumnDefinition Width="auto"/>
                                                            <ColumnDefinition Width="auto"/>
                                                            <ColumnDefinition Width="auto"/>
                                                            <ColumnDefinition Width="auto"/>
                                                        </Grid.ColumnDefinitions>
                                                        <TextBlock Grid.Column="0">Tags:</TextBlock>
                                                        <Image 
                                                            x:Name="tagsInfo" 
                                                            Source="pack://siteoforigin:,,,/Resources/information.png" 
                                                            Width="12" 
                                                            Height="12" 
                                                            Grid.Column="1" 
                                                            HorizontalAlignment="Left" 
                                                            Margin="5,0,0,0" 
                                                            Cursor="Hand"
                                                            MouseDown="filterInfo_Show"/>
                                                        <RadioButton Click="Filter_Change" x:Name="rTagsAnd" IsChecked="True" Grid.Column="2" HorizontalAlignment="Right" Margin="0,0,5,0">AND</RadioButton>
                                                        <RadioButton Click="Filter_Change" x:Name="rTagsOr" Grid.Column="3" HorizontalAlignment="Right" Margin="0,0,5,0">OR</RadioButton>
                                                        <TextBlock Grid.Column="4" Margin="0,0,5,2" Foreground="Gray">|</TextBlock>
                                                        <CheckBox Click="Filter_Change" x:Name="cbTagsExactmatch" Grid.Column="5" HorizontalAlignment="Right">Exact Match</CheckBox>
                                                    </Grid>
                                                    <TextBox
                                                        MouseUp="Filter_Change"
                                                        KeyUp="Filter_Change"
                                                        x:Name="tbxTags"
                                                        FontSize="11" 
                                                        MinHeight="25" 
                                                        Height="50" 
                                                        BorderThickness=".4" 
                                                        BorderBrush="Gray"  
                                                        TextWrapping="Wrap" 
                                                        AcceptsReturn="True" 
                                                        HorizontalScrollBarVisibility="Disabled" 
                                                        VerticalScrollBarVisibility="Auto"/>
                                                    <TextBlock FontSize="10" FontStyle="Italic" Foreground="DarkSlateGray">Ex: Tag1, Tag2, Tag3, Tag4</TextBlock>
                                                    <Grid Margin="0,10,0,0">
                                                        <Grid.ColumnDefinitions>
                                                            <ColumnDefinition Width="auto"/>
                                                            <ColumnDefinition/>
                                                            <ColumnDefinition Width="auto"/>
                                                            <ColumnDefinition Width="auto"/>
                                                            <ColumnDefinition Width="auto"/>
                                                            <ColumnDefinition Width="auto"/>
                                                        </Grid.ColumnDefinitions>
                                                        <TextBlock Grid.Column="0">Links:</TextBlock>
                                                        <Image 
                                                            x:Name="linksInfo" 
                                                            Source="pack://siteoforigin:,,,/Resources/information.png" 
                                                            Width="12" 
                                                            Height="12" 
                                                            Grid.Column="1" 
                                                            HorizontalAlignment="Left" 
                                                            Margin="5,0,0,0" 
                                                            Cursor="Hand"
                                                            MouseDown="filterInfo_Show"/>
                                                        <RadioButton Click="Filter_Change" x:Name="rLinksAnd" IsChecked="True" Grid.Column="1" HorizontalAlignment="Right" Margin="0,0,5,0">AND</RadioButton>
                                                        <RadioButton Click="Filter_Change" x:Name="rLinksOr" Grid.Column="2" HorizontalAlignment="Right" Margin="0,0,5,0">OR</RadioButton>
                                                        <TextBlock Grid.Column="3" Margin="0,0,5,2" Foreground="Gray">|</TextBlock>
                                                        <CheckBox Click="Filter_Change" x:Name="cbLinksExactmatch" Grid.Column="4" HorizontalAlignment="Right">Exact Match</CheckBox>
                                                    </Grid>
                                                    <TextBox
                                                        MouseUp="Filter_Change"
                                                        KeyUp="Filter_Change"
                                                        x:Name="tbxLinks"
                                                        FontSize="11" 
                                                        MinHeight="25" 
                                                        Height="50" 
                                                        BorderThickness=".4" 
                                                        BorderBrush="Gray"  
                                                        TextWrapping="Wrap" 
                                                        AcceptsReturn="True" 
                                                        HorizontalScrollBarVisibility="Disabled" 
                                                        VerticalScrollBarVisibility="Auto"/>
                                                    <TextBlock FontSize="10" FontStyle="Italic" Foreground="DarkSlateGray">Ex: Link1, Link2, Link3 or http://link1.com, http://link2.com</TextBlock>
                                                </StackPanel>
                                            </Grid>
                                        </TabItem>
                                    </TabControl>
                                </Grid>
                            </Grid>
                            <Grid Grid.Column="2">
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="25"/>
                                    <RowDefinition MinHeight="263" MaxHeight="263"/>
                                    <RowDefinition MinHeight="30" MaxHeight="30"/>
                                    <RowDefinition Height="5"/>
                                    <RowDefinition/>
                                </Grid.RowDefinitions>
                                <Grid Grid.Row="0">
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="150"/>
                                        <!--0 Find Test-->
                                        <ColumnDefinition />
                                        <!--1 Space-->
                                        <ColumnDefinition Width="110" />
                                        <!--2 Import-->
                                        <ColumnDefinition Width="10" />
                                        <!--3 Separator-->
                                        <ColumnDefinition Width="45" />
                                        <!--4 Up-->
                                        <ColumnDefinition Width="3" />
                                        <!--5 SPACE-->
                                        <ColumnDefinition Width="Auto" />
                                        <!--6 Down-->
                                        <ColumnDefinition Width="10" />
                                        <!--7 Separator-->
                                        <ColumnDefinition Width="110" />
                                        <!--8 Delete-->
                                        <ColumnDefinition Width="3" />
                                        <!--9 Space-->
                                        <ColumnDefinition Width="110" />
                                        <!--10 Clear-->
                                        <ColumnDefinition Width="10"/>
                                        <!--11 Space-->
                                        <ColumnDefinition Width="135"/>
                                        <!--12 Checkbox-->
                                    </Grid.ColumnDefinitions>
                                    <TextBlock Grid.Column="0" VerticalAlignment="Center" Height="16" Margin="0,4,0,5" Foreground="Navy" FontWeight="Bold">Find Test</TextBlock>
                                    <Button x:Name="btnImportTest" Style="{StaticResource ToolbarButtonStyle}" Width="100" Height="20" Grid.Column="2" Click="btnImportTest_Click">
                                        <StackPanel Orientation="Horizontal">
                                            <Image Source="pack://siteoforigin:,,,/Resources/Import.ico" Width="14" Height="14"/>
                                            <TextBlock Width="10"></TextBlock>
                                            <TextBlock>Import...</TextBlock>
                                        </StackPanel>
                                    </Button>

                                    <Button x:Name="btnMoveUp" Style="{StaticResource ToolbarButtonStyle}" Width="40" Height="20" Grid.Column="4" Click="btnMoveUp_Click">
                                        <StackPanel Orientation="Horizontal">
                                            <Image Source="pack://siteoforigin:,,,/Resources/buttonup.png" Width="14" Height="14"/>
                                        </StackPanel>
                                    </Button>

                                    <Button x:Name="btnMoveDown" Style="{StaticResource ToolbarButtonStyle}" Width="40" Height="20" Grid.Column="6" Click="btnMoveDown_Click">
                                        <StackPanel Orientation="Horizontal">
                                            <Image Source="pack://siteoforigin:,,,/Resources/buttondown.png" Width="14" Height="14"/>
                                        </StackPanel>
                                    </Button>

                                    <Button x:Name="btnDeleteStep" Style="{StaticResource ToolbarButtonStyle}" Width="100" Height="20" Grid.Column="8" Click="btnDeleteStep_Click">
                                        <StackPanel Orientation="Horizontal">
                                            <Image Source="pack://siteoforigin:,,,/Resources/delete.ico" Width="14" Height="14"/>
                                            <TextBlock Width="10"></TextBlock>
                                            <TextBlock>Delete</TextBlock>
                                        </StackPanel>
                                    </Button>

                                    <Button x:Name="btnClearSteps" Style="{StaticResource ToolbarButtonStyle}" Width="100" Height="20" Grid.Column="10" Click="btnClearSteps_Click">
                                        <StackPanel Orientation="Horizontal">
                                            <Image Source="pack://siteoforigin:,,,/Resources/clearbroom.png" Width="14" Height="14"/>
                                            <TextBlock Width="10"></TextBlock>
                                            <TextBlock>Clear All</TextBlock>
                                        </StackPanel>
                                    </Button>

                                    <!--<Button x:Name="btnImportTest" Grid.Column="2" Style="{StaticResource ButtonStyle1}" Click="btnImportTest_Click" Height="Auto" Margin="3,2,2,3">Import</Button>-->
                                    <Separator Grid.Column="3" Style="{StaticResource {x:Static ToolBar.SeparatorStyleKey}}" Margin="2,2,2,2" Background="#FFAFB1B2" Width="1"/>
                                    <!--<Button x:Name="btnMoveUp" Grid.Column="4" Style="{StaticResource ButtonStyle1}" Margin="3,2,2,0" VerticalAlignment="Top" Click="btnMoveUp_Click" >Up</Button>-->
                                    <!--<Button x:Name="btnMoveDown" Grid.Column="6" Style="{StaticResource ButtonStyle1}" Height="Auto" Margin="2,2,3,3" Click="btnMoveDown_Click" >Down</Button>-->
                                    <Separator Grid.Column="7" Style="{StaticResource {x:Static ToolBar.SeparatorStyleKey}}" Margin="2,2,2,3" Background="#FFAFB1B2" Width="1"/>
                                    <!--<Button x:Name="btnDeleteStep" Grid.Column="8" Style="{StaticResource ButtonStyle1}" Grid.ColumnSpan="2" Click="btnDeleteStep_Click" Height="Auto" Margin="3,2,3,3">Delete</Button>-->
                                    <!--<Button x:Name="btnClearSteps" Grid.Column="10" Style="{StaticResource ButtonStyle1}" Click="btnClearSteps_Click" Height="Auto" Margin="3,2,2,3">Clear</Button>-->
                                    <CheckBox x:Name="chkIncludeParameters" Grid.Column="12" VerticalAlignment="Center" Checked="chkIncludeParameters_Checked" Unchecked="chkIncludeParameters_Unchecked" Height="16" Margin="0,4,0,5">Include Parameters?</CheckBox>
                                </Grid>
                                <DataGrid x:Name="dgFindTest" Grid.Row="1" HorizontalAlignment="Left" ItemsSource="{Binding}" RowHeaderWidth="0"
            	                    Style="{StaticResource DataGridStyle1}" HorizontalScrollBarVisibility="Auto" VerticalScrollBarVisibility="Visible"
            	                    SelectionMode="Single" IsReadOnly="False"
            	                    CanUserAddRows="True" CanUserDeleteRows="False"
            	                    RowStyle="{StaticResource DataGridRowStyle1}" CellStyle="{StaticResource DataGridCellStyle5}"
                                    DockPanel.Dock="Top" VirtualizingStackPanel.IsVirtualizing="False" VerticalAlignment="Stretch" CanUserResizeColumns="True" SelectionChanged="dgFindTest_SelectionChanged">
                                    <DataGrid.Columns>
                                        <DataGridTextColumn Binding="{Binding mStepNumber}" IsReadOnly="True" CanUserSort="False" CanUserReorder="False" CanUserResize="True"  Header="Step" HeaderStyle="{StaticResource DataGridColumnHeaderStyle0}"  Width="40" />
                                        <!--<DataGridTextColumn Binding="{Binding mExecute}" IsReadOnly="True" CanUserSort="False" CanUserReorder="False" CanUserResize="True"  Header="Execute" HeaderStyle="{StaticResource DataGridColumnHeaderStyle1}" Width="60" />-->
                                        <DataGridTextColumn Binding="{Binding mScreen}" IsReadOnly="True" CanUserSort="False" CanUserReorder="False" CanUserResize="True"  Header="Screen" HeaderStyle="{StaticResource DataGridColumnHeaderStyle3}" Width="196" />
                                        <DataGridTextColumn Binding="{Binding mControl}" IsReadOnly="True" CanUserSort="False" CanUserReorder="False" CanUserResize="True"  Header="Control" HeaderStyle="{StaticResource DataGridColumnHeaderStyle2}" Width="230" />
                                        <DataGridTextColumn Binding="{Binding mKeyword}" IsReadOnly="True" CanUserSort="False" CanUserReorder="False" CanUserResize="True"  Header="Keyword" HeaderStyle="{StaticResource DataGridColumnHeaderStyle3}" Width="197" />
                                        <DataGridTextColumn Binding="{Binding Path=mParameterString, Converter={StaticResource FPConverter}}" IsReadOnly="True" CanUserSort="False" CanUserReorder="False" CanUserResize="True"  Header="Parameters" HeaderStyle="{StaticResource DataGridColumnHeaderStyle3}" Width="*" />
                                    </DataGrid.Columns>
                                </DataGrid>
                                <!--<Button x:Name="btnFindTest" Grid.Row="2" Width="300" Style="{StaticResource ButtonStyle4}" Click="btnFindTest_Click">Find</Button>-->

                                <Button x:Name="btnFindTest" Style="{StaticResource ToolbarButtonStyle}" Width="300" Height="20" Grid.Row="2" Click="btnFindTest_Click">
                                    <StackPanel Orientation="Horizontal">
                                        <Image Source="pack://siteoforigin:,,,/Resources/search.png" Width="14" Height="14"/>
                                        <TextBlock Width="10"></TextBlock>
                                        <TextBlock>Find</TextBlock>
                                    </StackPanel>
                                </Button>
                                <GridSplitter Grid.Row="3" ShowsPreview="False" Width="Auto" BorderBrush="Gray"  VerticalAlignment="Stretch" 
                                          BorderThickness="0,0,0,1" HorizontalAlignment="Stretch" Opacity="1" />
                                <Grid Grid.Row="4">
                                    <Grid.RowDefinitions>
                                        <RowDefinition Height="25"/>
                                        <RowDefinition />
                                    </Grid.RowDefinitions>
                                    <Grid Grid.Row="0">
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="200"/>
                                            <ColumnDefinition />
                                            <ColumnDefinition />
                                        </Grid.ColumnDefinitions>
                                        <TextBlock x:Name="tbFindResults" VerticalAlignment="Center" Foreground="Navy" FontWeight="Bold">Find Results</TextBlock>
                                    </Grid>
                                    <DataGrid x:Name="dgFindResults" Style="{StaticResource DataGridStyle1}" HorizontalAlignment="Left" ItemsSource="{Binding}" RowHeaderWidth="0"
            	                    HorizontalScrollBarVisibility="Auto" VerticalScrollBarVisibility="Visible"
            	                    SelectionMode="Single" IsReadOnly="True" CanUserDeleteRows="False" CanUserAddRows="False" CanUserSortColumns="True"
            	                    RowStyle="{StaticResource DataGridRowStyle0}" CellStyle="{StaticResource DataGridCellStyle8}"
                                    DockPanel.Dock="Top" VirtualizingStackPanel.IsVirtualizing="True" VirtualizingPanel.VirtualizationMode="Recycling" VerticalAlignment="Stretch" CanUserResizeColumns="True" Margin="0,25,0,0.333" Grid.RowSpan="2">
                                        <DataGrid.Columns>
                                            <!--<DataGridTextColumn Binding="{Binding mStepNumber}" CanUserSort="False" CanUserReorder="False" CanUserResize="True"  Header="#" HeaderStyle="{StaticResource DataGridColumnHeaderStyle0}"  Width="40" />-->
                                            <DataGridTemplateColumn SortMemberPath="TestName" CanUserSort="True" CanUserReorder="False" CanUserResize="True"  Header="Test Name" HeaderStyle="{StaticResource DataGridColumnHeaderStyle0}"  Width="300">
                                                <DataGridTemplateColumn.CellTemplate>
                                                    <DataTemplate>
                                                        <TextBlock x:Name="TestName" Text="{Binding TestName}" PreviewMouseLeftButtonDown="File_Click" HorizontalAlignment="Left">
                                                            <TextBlock.ContextMenu>
                                                                <ContextMenu Style="{StaticResource contextMenuStyle1}">
                                                                    <MenuItem x:Name="mnuEditTest2" Header="Edit" Click="mnuEditTest_Click"/>
                                                                </ContextMenu>
                                                            </TextBlock.ContextMenu>
                                                            <TextBlock.Style>
                                                                <Style>
                                                                    <Setter Property="TextBlock.Foreground" Value="{DynamicResource {x:Static SystemColors.HotTrackBrushKey}}" />
                                                                    <Setter Property="TextBlock.Cursor" Value="Hand" />
                                                                    <Setter Property="TextBlock.TextDecorations" Value="Underline"></Setter>
                                                                    <Style.Triggers>
                                                                        <Trigger Property="TextBlock.IsMouseOver" Value="true">
                                                                            <Setter Property="TextBlock.Foreground" Value="Red" />
                                                                        </Trigger>
                                                                    </Style.Triggers>
                                                                </Style>
                                                            </TextBlock.Style>
                                                        </TextBlock>
                                                    </DataTemplate>
                                                </DataGridTemplateColumn.CellTemplate>
                                            </DataGridTemplateColumn>
                                            <DataGridTextColumn Binding="{Binding Description}" CanUserSort="True" CanUserReorder="False" CanUserResize="True"  Header="Description" HeaderStyle="{StaticResource DataGridColumnHeaderStyle0}"  Width="*" />
                                            <DataGridTemplateColumn SortMemberPath="mTestPath" CanUserSort="True" CanUserReorder="False" CanUserResize="True"  Header="Path" HeaderStyle="{StaticResource DataGridColumnHeaderStyle0}"  Width="*">
                                                <DataGridTemplateColumn.CellTemplate>
                                                    <DataTemplate>
                                                        <TextBlock x:Name="Path" Text="{Binding Path}" PreviewMouseLeftButtonDown="Folder_Click" HorizontalAlignment="Left">
                                                            <TextBlock.ContextMenu>
                                                                <ContextMenu Style="{StaticResource contextMenuStyle1}">
                                                                    <MenuItem x:Name="mnuEditTest2" Header="Edit" Click="mnuEditTest_Click"/>
                                                                </ContextMenu>
                                                            </TextBlock.ContextMenu>
                                                            <TextBlock.Style>
                                                                <Style>
                                                                    <Setter Property="TextBlock.Foreground" Value="{DynamicResource {x:Static SystemColors.HotTrackBrushKey}}" />
                                                                    <Setter Property="TextBlock.Cursor" Value="Hand" />
                                                                    <Setter Property="TextBlock.TextDecorations" Value="Underline"></Setter>
                                                                    <Setter Property="TextBlock.TextTrimming" Value="CharacterEllipsis"/>
                                                                    <Style.Triggers>
                                                                        <Trigger Property="TextBlock.IsMouseOver" Value="true">
                                                                            <Setter Property="TextBlock.Foreground" Value="Red" />
                                                                        </Trigger>
                                                                    </Style.Triggers>
                                                                </Style>
                                                            </TextBlock.Style>
                                                        </TextBlock>
                                                    </DataTemplate>
                                                </DataGridTemplateColumn.CellTemplate>
                                            </DataGridTemplateColumn>
                                            <DataGridTextColumn Binding="{Binding StepCount}" CanUserSort="True" CanUserReorder="False" CanUserResize="True"  Header="Steps" HeaderStyle="{StaticResource DataGridColumnHeaderStyle0}"  Width="40" />
                                            <DataGridTextColumn Binding="{Binding MatchCount}" CanUserSort="True" CanUserReorder="False" CanUserResize="True"  Header="Line Matches" HeaderStyle="{StaticResource DataGridColumnHeaderStyle0}"  Width="80" />
                                            <DataGridTextColumn Binding="{Binding MismatchCount}" CanUserSort="True" CanUserReorder="False" CanUserResize="True"  Header="Unmatched" HeaderStyle="{StaticResource DataGridColumnHeaderStyle0}"  Width="80" />
                                            <DataGridTextColumn Binding="{Binding IsExactMatch}" CanUserSort="True" CanUserReorder="False" CanUserResize="True"  Header="Exact Match?" HeaderStyle="{StaticResource DataGridColumnHeaderStyle0}"  Width="100" />
                                        </DataGrid.Columns>
                                    </DataGrid>
                                </Grid>
                            </Grid>
                        </Grid>
                    </Grid>

                </TabItem>
                <TabItem x:Name="tabAdmin" Header="Admin">
                    <TabControl x:Name="tabAdminPage" Grid.Column="1" Margin="0,0,0,5" Background="Transparent">
                        <TabItem x:Name="tabConflicts" Visibility="Visible" Header="Tags" >
                            <Grid>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="300"></ColumnDefinition>
                                    <ColumnDefinition></ColumnDefinition>
                                </Grid.ColumnDefinitions>
                                <Grid Grid.Column="0">
                                    <GroupBox Header="Tags" Grid.Row="1" Margin="5,10,10,10">
                                        <Grid>
                                            <Grid.RowDefinitions>
                                                <RowDefinition/>
                                                <RowDefinition Height="30"/>
                                            </Grid.RowDefinitions>
                                            <ListBox x:Name="lbxTags" Grid.Row="0" Margin="0,10,0,0" BorderThickness="0" Background="White" ItemsSource="{Binding}" SelectionChanged="lbxTags_SelectionChanged">
                                            </ListBox>
                                            <StackPanel Orientation="Horizontal" Grid.Row="1" HorizontalAlignment="Center" Margin="0,0,0,0">
                                                <Button x:Name="btnAddTag" Style="{StaticResource ToolbarButtonStyle}" VerticalAlignment="Bottom" Click="btnAddTag_Click" ToolTip="Add Tag">
                                                    <Image Source="pack://siteoforigin:,,,/Resources/add.png"/>
                                                </Button>
                                                <Button x:Name="btnEditTag" Style="{StaticResource ToolbarButtonStyle}" VerticalAlignment="Bottom" Click="btnEditTag_Click" ToolTip="Edit Tag">
                                                    <Image Source="pack://siteoforigin:,,,/Resources/edit.png"/>
                                                </Button>
                                                <Button x:Name="btnDelete" Style="{StaticResource ToolbarButtonStyle}" VerticalAlignment="Bottom" ToolTip="Delete" IsEnabled="False">
                                                    <Image Source="pack://siteoforigin:,,,/Resources/delete.ico"/>

                                                </Button>
                                            </StackPanel>
                                        </Grid>


                                    </GroupBox>
                                </Grid>
                                <Grid Grid.Column="1" Margin="0,19,10,0">
                                    <DockPanel DockPanel.Dock="Top">
                                        <Grid>
                                            <Grid.RowDefinitions>
                                                <RowDefinition Height="Auto"></RowDefinition>
                                                <RowDefinition Height="Auto"></RowDefinition>
                                                <RowDefinition Height="Auto"></RowDefinition>
                                                <RowDefinition Height="*"></RowDefinition>
                                                <RowDefinition Height="Auto"></RowDefinition>
                                            </Grid.RowDefinitions>
                                            <StackPanel Orientation="Vertical" Margin="0,0,0,5" Grid.Row="0">
                                                <Label>ID</Label>
                                                <TextBox x:Name="txtID" Text="{Binding mID, Mode=OneWay}" IsEnabled="False"></TextBox>
                                            </StackPanel>
                                            <StackPanel Orientation="Vertical" Margin="0,0,0,5" Grid.Row="1">
                                                <Label>Name</Label>
                                                <TextBox x:Name="txtName" Text="{Binding mID, Mode=OneWay}" IsEnabled="False"></TextBox>
                                            </StackPanel>
                                            <StackPanel Orientation="Vertical" Margin="0,0,0,5" Grid.Row="2">
                                                <Label>Description</Label>
                                                <TextBox x:Name="txtDescription" Text="{Binding mUrl, Mode=OneWay}" TextWrapping="Wrap" MaxLines="3" ScrollViewer.VerticalScrollBarVisibility="Auto" Height="67" IsEnabled="False"></TextBox>
                                            </StackPanel>
                                            <DockPanel DockPanel.Dock="Top" Margin="0,0,0,5" Grid.Row="3">
                                                <GroupBox Header="Tag Conflicts" Margin="0,0,0,5">
                                                    <Grid>
                                                        <Grid.RowDefinitions>
                                                            <RowDefinition Height="*"></RowDefinition>
                                                            <RowDefinition Height="Auto"></RowDefinition>
                                                        </Grid.RowDefinitions>
                                                        <ListBox x:Name="lbxTagConflicts" Grid.Row="0" Margin="0,0,0,0" BorderThickness="0" Background="White" VerticalContentAlignment="Stretch" ItemsSource="{Binding}"/>
                                                        <StackPanel Orientation="Horizontal" Grid.Row="1" HorizontalAlignment="Center" Margin="0,5,0,0">
                                                            <Button x:Name="btnAddEditConflict" Style="{StaticResource ButtonStyle3}" Content="Add/Edit..." Click="btnAddEditConflict_Click"/>
                                                        </StackPanel>
                                                    </Grid>
                                                </GroupBox>
                                            </DockPanel>
                                        </Grid>
                                    </DockPanel>
                                </Grid>
                            </Grid>
                        </TabItem>
                        <TabItem x:Name="tabPreferences" Visibility="Visible" Header="Preferences" >
                            <Grid>
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="60"></RowDefinition>
                                    <RowDefinition Height="60"></RowDefinition>
                                    <RowDefinition Height="50"></RowDefinition>
                                </Grid.RowDefinitions>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="530"></ColumnDefinition>
                                    <ColumnDefinition Width="*"></ColumnDefinition>
                                </Grid.ColumnDefinitions>
                                <StackPanel Orientation="Vertical" Margin="10,0,0,5" Grid.Row="0" Grid.Column="0">
                                    <Label>Product</Label>
                                    <ComboBox x:Name="cboProduct" IsEnabled="True" VerticalAlignment="Center" Margin="0,0,0,0" DisplayMemberPath="DisplayName"  SelectionChanged="cboProduct_SelectionChanged" />
                                </StackPanel>
                                <StackPanel Orientation="Vertical" Margin="10,0,0,5" Grid.Row="1" Grid.Column="0">
                                    <Label>Suite Directory</Label>
                                    <TextBox x:Name="txtSuiteDirectory" Text="{Binding mID, Mode=OneWay}" IsEnabled="True" Margin="0,0,30,0" />
                                </StackPanel>
                                <StackPanel Orientation="Horizontal" Margin="500,15,0,5" Grid.Row="1" Grid.Column="0">
                                    <Button x:Name="btnBrowse" Content="..." Style="{StaticResource ToolbarButtonStyle}" Width="25" Height="20" Click="btnBrowse_Click" ></Button>
                                </StackPanel>
                                <StackPanel Orientation="Horizontal" Margin="445,15,0,5" Grid.Row="2" Grid.Column="0">
                                    <Button x:Name="btnApply" Style="{StaticResource ButtonStyle3}" Content="Apply" Click="btnApply_Click" />
                                </StackPanel>
                            </Grid>
                        </TabItem>
                    </TabControl>
                </TabItem>
            </TabControl>
        </Grid>
        <StatusBar Grid.Row="3">
            <TextBlock x:Name="txtStatus" Text="Ready"/>
        </StatusBar>
    </Grid>
</Window>
