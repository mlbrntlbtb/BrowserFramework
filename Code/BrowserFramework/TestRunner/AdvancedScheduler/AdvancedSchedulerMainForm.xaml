<Window x:Class="TestRunner.AdvancedScheduler.AdvancedSchedulerMainForm"
        xmlns:common="clr-namespace:TestRunner.Common"
        xmlns:local="clr-namespace:TestRunner.AdvancedScheduler"
        xmlns:model="clr-namespace:TestRunner.AdvancedScheduler.Model"
        xmlns:controls="clr-namespace:TestRunner.Controls"
        xmlns:sys="clr-namespace:System;assembly=mscorlib"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:wpfx="http://schemas.xceed.com/wpf/xaml/toolkit"
        Title="Scheduler" Height="720" Width="1280" MinHeight="720" MinWidth="1280"
        Closing="Window_Closing" Loaded="Window_Loaded">
    <Window.Resources>
        <Style x:Key="ColHeaderStyle" x:Name="ColHeaderStyle" TargetType="DataGridColumnHeader">
            <Setter Property="Background" Value="Navy" />
            <Setter Property="Foreground" Value="White" />
            <Setter Property="FontSize" Value="11" />
        </Style>
        <Style x:Key="ColHeaderStyleCentered" x:Name="ColHeaderStyleCentered" TargetType="DataGridColumnHeader">
            <Setter Property="Background" Value="Navy" />
            <Setter Property="Foreground" Value="White" />
            <Setter Property="FontSize" Value="11" />
            <Setter Property="HorizontalContentAlignment" Value="Center"/>
        </Style>
        <Style x:Key="RowStyle" TargetType="DataGridRow" >
            <Setter Property="BorderThickness" Value="0.25"/>
            <Style.Triggers>
                <Trigger Property="IsSelected" Value="True">
                    <Setter Property="BorderBrush" Value="BlueViolet" />
                    <Setter Property="BorderThickness" Value="2" />
                </Trigger>
            </Style.Triggers>
        </Style>
        <Style x:Key="CellStyle" TargetType="DataGridCell" >
            <Setter Property="BorderThickness" Value="0.25"/>
            <Setter Property="Background" Value="White"/>
            <Setter Property="Foreground" Value="Navy"/>
        </Style>
        <Style x:Key="CellStyleResults" TargetType="DataGridCell">
            <Setter Property="BorderThickness" Value="0.25"/>
            <Style.Triggers>
                <Trigger Property="IsSelected" Value="True">
                    <Setter Property="Background" Value="White"/>
                    <Setter Property="Foreground" Value="Navy" />
                    <Setter Property="FontWeight" Value="ExtraBlack"/>
                </Trigger>
            </Style.Triggers>
        </Style>
        <model:EnumerationConverter x:Key="EConverter" />
        <model:ScheduleConverter x:Key="SConverter" />
        <model:StartTimeConverter x:Key="STConverter" />
        <model:NullImageConverter x:Key="NullImageConverter" />
        <model:PassRateFillConverter x:Key="PRConverter" />
        <model:TestSuitePathConverter x:Key="TSPathConverter" />
        <model:ItalicTextConverter x:Key="ItalicConverter" />
        <model:TextColorConverter x:Key="ColorConverter" />
        <model:BlacklistVisibilityConverter x:Key="BlacklistConverter" />
        <model:BlacklistTooltipConverter x:Key="TooltipBlacklistConverter" />
        <model:DifferentProductConverter x:Key="WarningDifferentProductConverter"/>
        <model:DifferentProductTooltipConverter x:Key="TooltipDifferentProductConverter"/>
        <local:DropdownBlacklistConverter x:Key="DDBlacklistConverter" />
        <common:DlkStringHasValueToBoolean x:Key="stringhasvaluetobool" />
    </Window.Resources>
    <Grid>
        <Grid.Background>
            <ImageBrush ImageSource="pack://siteoforigin:,,,/Resources/DeltekBackground.png" Stretch="UniformToFill"/>
        </Grid.Background>
        <Grid.ColumnDefinitions>
            <ColumnDefinition Width="10"/>
            <ColumnDefinition />
            <ColumnDefinition Width="10"/>
        </Grid.ColumnDefinitions>
        <Grid.RowDefinitions>
            <RowDefinition Height="20"/>
            <RowDefinition Height="40" />
            <RowDefinition />
            <RowDefinition Height="20"/>
            <RowDefinition Height="10"/>
        </Grid.RowDefinitions>

        <!--Menu bar-->
        <DockPanel Height="24" Name="dockPanel1" VerticalAlignment="Top" Grid.ColumnSpan="2" Margin="0,0,1162,0" Grid.RowSpan="2">
            <Menu Height="23" Name="mnuMain" Width="1271">
                <Menu.Background>
                    <SolidColorBrush />
                </Menu.Background>
                <MenuItem Header="File">
                    <MenuItem Header="Export to Excel..." Click="FileMenu_Export"/>
                    <MenuItem Header="Get Latest" Click="FileMenu_GetLatest" Name="GetLatestMenuItem"/>
                    <MenuItem Header="Hide" Click="FileMenu_Hide"/>
                    <MenuItem Header="Launch SchedulingAgent" Click="FileMenu_LaunchSchedulingAgent"/>
                    <Separator />
                    <MenuItem Header="Exit" Click="FileMenu_Exit"/>
                </MenuItem>
            </Menu>
        </DockPanel>

        <!--Tab Headers-->
        <StackPanel Grid.Row="1" Grid.Column="1" Orientation="Horizontal" Margin="0" >
            <RadioButton x:Name="rdoController" Style="{StaticResource {x:Type ToggleButton}}" Height="21" Background="Transparent" Width="100" BorderBrush="Transparent" Checked="rdoAll_Checked" Margin="0,0,10,0" Tag="Controller" IsChecked="True">
                <StackPanel Orientation="Horizontal">
                    <Image Source="pack://siteoforigin:,,,/Resources/controller.ico" Width="12" Height="12"/>
                    <TextBlock Width="5"></TextBlock>
                    <TextBlock Foreground="DodgerBlue" FontSize="11" FontWeight="ExtraBold" >Controller</TextBlock>
                </StackPanel>
            </RadioButton>
            <RadioButton x:Name="rdoAgents" Style="{StaticResource {x:Type ToggleButton}}" Height="23" Background="Transparent" Width="100" BorderBrush="Transparent" Checked="rdoAll_Checked" Tag="Agents">
                <StackPanel Orientation="Horizontal">
                    <Image Source="pack://siteoforigin:,,,/Resources/agent.ico" Width="12" Height="12"/>
                    <TextBlock Width="5"></TextBlock>
                    <TextBlock Foreground="DodgerBlue" FontSize="11" FontWeight="ExtraBold" >Agents</TextBlock>
                </StackPanel>
            </RadioButton>
            <RadioButton x:Name="rdoCalendar" Visibility="Collapsed" Style="{StaticResource {x:Type ToggleButton}}" Height="23"  Background="Transparent" Content="Calendar" Width="100" BorderBrush="Transparent" Checked="rdoAll_Checked" Tag="Calendar"/>
        </StackPanel>

        <!--Tab Content-->
        <TabControl x:Name="tabMain" Grid.Row="2" Grid.Column="1" Background="Transparent" Margin="0,0,0.333,19.667" Grid.RowSpan="2">
            <!--Controller Tab-->
            <TabItem Header="Controller" Visibility="Collapsed">
                <Grid>
                    <Grid.RowDefinitions>
                        <RowDefinition />
                        <RowDefinition Height="6"/>
                        <RowDefinition Height="150"/>
                    </Grid.RowDefinitions>

                    <!--UPPER: main -->
                    <Grid Grid.Row="0">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="420"/>
                            <ColumnDefinition Width="6"/>
                            <ColumnDefinition />
                        </Grid.ColumnDefinitions>
                        <!--LEFT-->
                        <TabControl Grid.Column="0" Margin="-2,-4,-2,-2">
                            <TabItem Visibility="Collapsed">
                                <Grid>
                                    <Grid.RowDefinitions>
                                        <RowDefinition Height="25"/>
                                        <RowDefinition />
                                        <RowDefinition Height="25"/>
                                        <RowDefinition />
                                    </Grid.RowDefinitions>
                                    <!--Favorites Header-->
                                    <DockPanel Grid.Row="0" HorizontalAlignment="Stretch">
                                        <StackPanel Orientation="Horizontal" DockPanel.Dock="Right">
                                            <Button x:Name="btnSearchFavorite" Style="{StaticResource ToolbarButtonStyle}" Grid.Row="0" ToolTip="Search favorites" Click="btnSearchFavorites_Click" Width="20" Height="20">
                                                <Image Source="pack://siteoforigin:,,,/Resources/find.png" Height="12" Width="15"/>
                                            </Button>
                                            <Button x:Name="btn_AddFolder" Style="{StaticResource ToolbarButtonStyle}" Click="btnFavoritesAddFolder_Click" Width="20" Height="20" ToolTip="Add folder">
                                                <Image Source="pack://siteoforigin:,,,/Resources/add_folder.png" Height="14" Width="14"/>
                                            </Button>
                                            <Button x:Name="btn_EditItem" Style="{StaticResource ToolbarButtonStyle}" Click="btnFavoritesEditItem_Click" Width="20" Height="20" ToolTip="Edit">
                                                <Image Source="pack://siteoforigin:,,,/Resources/editgray.png" Height="14" Width="14"/>
                                            </Button>
                                            <Button x:Name="btn_RenameFavoritesFolder" Style="{StaticResource ToolbarButtonStyle}" Click="btn_RenameFavoritesFolder_Click" Width="20" Height="20" ToolTip="Rename folder" IsEnabled="False">
                                                <Image Source="pack://siteoforigin:,,,/Resources/rename1.png" Height="14" Width="16"/>
                                            </Button>
                                            <Button x:Name="btn_DeleteItem" Style="{StaticResource ToolbarButtonStyle}" Click="btnFavoritesDeleteItem_Click" Width="20" Height="20" ToolTip="Delete">
                                                <Image Source="pack://siteoforigin:,,,/Resources/delete.png" Height="12" Width="15"/>
                                            </Button>
                                        </StackPanel>
                                        <TextBlock VerticalAlignment="Center" Margin="5,0,0,0" Foreground="Navy" FontWeight="Bold">
                                            Favorites
                                        </TextBlock>
                                    </DockPanel>
                                    <!--Favorites Tree-->
                                    <Border Grid.Row="1" BorderBrush="Silver" BorderThickness="2">
                                        <Grid Background="Silver">
                                            <Grid.ColumnDefinitions>
                                                <ColumnDefinition />
                                                <ColumnDefinition  Width="20"/>
                                            </Grid.ColumnDefinitions>
                                            <DockPanel Background="Gray" Visibility="Visible">
                                                <TextBox x:Name="txtSearchFavorites" DockPanel.Dock="Top" Margin="1,0,1,0" Background="LemonChiffon" KeyUp="txtSearchFavorite_KeyUp" Visibility="Collapsed"/>
                                                <TreeView x:Name="tvFavorites" Grid.Column="0" AllowDrop="True" Drop="tvFavorites_Drop" 
                                                          ItemsSource="{Binding}" DragEnter="tvFavorites_DragEnter" TreeViewItem.Selected="tvFavorites_GetSelectedItem" 
                                                          VirtualizingStackPanel.IsVirtualizing="False" VirtualizingStackPanel.VirtualizationMode="Standard" MouseDown="tvFavorites_MouseDown">
                                                    <TreeView.ItemContainerStyle>
                                                        <Style TargetType="{x:Type TreeViewItem}">
                                                            <Setter Property="IsExpanded" Value="{Binding IsExpanded, Mode=TwoWay}" />
                                                            <EventSetter Event="Drop" Handler="tvFavoritesFolder_Drop"></EventSetter>
                                                            <EventSetter Event="TreeViewItem.MouseMove" Handler="tvFavoritesItem_MouseMove"/>
                                                        </Style>
                                                    </TreeView.ItemContainerStyle>
                                                    <TreeView.Resources>
                                                        <HierarchicalDataTemplate DataType="{x:Type common:BFFolder}" ItemsSource="{Binding DirItems}">
                                                            <StackPanel Orientation="Horizontal">
                                                                <Image Source="{Binding Icon}" VerticalAlignment="Stretch" Width="16" Height="16"/>
                                                                <TextBlock Text="{Binding Name}" ToolTip="{Binding Path}" Margin="3,0,0,0"/>
                                                            </StackPanel>
                                                        </HierarchicalDataTemplate>
                                                        <HierarchicalDataTemplate DataType="{x:Type common:BFFile}" ItemsSource="{Binding DirItems}">
                                                            <StackPanel Orientation="Horizontal">
                                                                <Image Source="{Binding Icon}" VerticalAlignment="Stretch" Width="15" Height="13"/>
                                                                <TextBlock Text="{Binding Name}" ToolTip="{Binding Path}" Margin="3,0,0,0"/>
                                                            </StackPanel>
                                                        </HierarchicalDataTemplate>
                                                        <SolidColorBrush x:Key="{x:Static SystemColors.HighlightBrushKey}"
                                                            Color="DodgerBlue" />
                                                        <SolidColorBrush x:Key="{x:Static SystemColors.HighlightTextBrushKey}"
                                                            Color="White" />
                                                        <SolidColorBrush x:Key="{x:Static SystemColors.InactiveSelectionHighlightBrushKey}"
                                                            Color="DodgerBlue" />
                                                        <SolidColorBrush x:Key="{x:Static SystemColors.InactiveSelectionHighlightTextBrushKey}"
                                                            Color="White" />
                                                    </TreeView.Resources>
                                                </TreeView>
                                            </DockPanel>
                                            <Button x:Name="btnQueueFromFavorites" Grid.Column="1" Height="17" Width="17" FontSize="10" Click="btnQueueFromFavorites_Click" ToolTip="Add to Schedules">
                                                &gt;
                                            </Button>
                                        </Grid>
                                    </Border>
                                    <!--Suites Header-->
                                    <DockPanel Grid.Row="2" HorizontalAlignment="Stretch">
                                        <StackPanel Orientation="Horizontal" DockPanel.Dock="Right">
                                            <Button x:Name="btnEditSuite" Style="{StaticResource ToolbarButtonStyle}" HorizontalAlignment="Right" ToolTip="Edit suite" Click="btnEditSuite_Click" Width="20" Height="20">
                                                <Image Source="pack://siteoforigin:,,,/Resources/editgray.png" Height="12" Width="15"/>
                                            </Button>
                                            <Button x:Name="btnRefreshSuite" Style="{StaticResource ToolbarButtonStyle}" HorizontalAlignment="Right" ToolTip="Refresh suites" Click="btnRefreshSuite_Click" Width="20" Height="20">
                                                <Image Source="pack://siteoforigin:,,,/Resources/refresh.png" Height="12" Width="15"/>
                                            </Button>
                                            <Button x:Name="btnSearchSuite" Style="{StaticResource ToolbarButtonStyle}" HorizontalAlignment="Right" ToolTip="Search suites" Click="btnSearchSuite_Click" Width="20" Height="20">
                                                <Image Source="pack://siteoforigin:,,,/Resources/find.png" Height="12" Width="15"/>
                                            </Button>
                                            <GridSplitter BorderBrush="Gray" BorderThickness="0,0,0.6,0" Opacity="0.4" Margin="0" Height="15" Foreground="Black" DockPanel.Dock="Right" HorizontalAlignment="Left"/>
                                            <Menu x:Name="mnuSearchTypes" Background="Transparent" Height="20" Width="25" Margin="-4,0,0,0" DockPanel.Dock="Right">
                                                <MenuItem x:Name="btnSetSearchType" Click="btnSetSearchType_Click" VerticalAlignment="Center" Margin="-1" ToolTip="Search Options">
                                                    <MenuItem.Icon>
                                                        <Image Source="pack://siteoforigin:,,,/Resources/bullet_arrow_down.png"  Height="35" Width="20"/>
                                                    </MenuItem.Icon>
                                                    <MenuItem.ContextMenu>
                                                        <ContextMenu x:Name="cmnuSearchTypes"/>
                                                    </MenuItem.ContextMenu>
                                                </MenuItem>
                                            </Menu>
                                        </StackPanel>
                                        <TextBlock Grid.Row="3" VerticalAlignment="Center" Margin="5,0,0,0" Foreground="Navy" FontWeight="Bold" ToolTip="Add to lineup">
                                            Suites
                                            <TextBlock Foreground="Silver" FontSize="9" FontWeight="Light" FontStyle="Italic" Text="(You can drag and drop suite files into Test Schedules or Favorites)"/>
                                        </TextBlock>
                                    </DockPanel>
                                    <!--Suites Tree-->
                                    <Border Grid.Row="3" BorderBrush="Silver" BorderThickness="2">
                                        <Grid Background="Silver">
                                            <Grid.ColumnDefinitions>
                                                <ColumnDefinition />
                                                <ColumnDefinition  Width="20"/>
                                            </Grid.ColumnDefinitions>
                                            <DockPanel Background="Gray" Visibility="Visible">
                                                <TextBox x:Name="txtSearchSuite" DockPanel.Dock="Top" Margin="1,0,1,0" Background="LemonChiffon" KeyUp="txtSearchSuite_KeyUp" Visibility="Collapsed" />
                                                <TreeView x:Name="tvAllSuites" Grid.Column="0" Grid.Row="0" Height="Auto" VerticalAlignment="Stretch" ItemsSource="{Binding}" 
                                                          VirtualizingStackPanel.IsVirtualizing="False" VirtualizingStackPanel.VirtualizationMode="Standard"
                                                          TreeViewItem.Selected="tvAllSuites_GetSelectedItem" >
                                                    <TreeView.ItemContainerStyle>
                                                        <Style TargetType="{x:Type TreeViewItem}">
                                                            <Setter Property="IsExpanded" Value="False"/>
                                                            <EventSetter Event="TreeViewItem.MouseMove" Handler="tvAllSuitesItem_MouseMove"/>
                                                        </Style>
                                                    </TreeView.ItemContainerStyle>
                                                    <TreeView.Resources>
                                                        <HierarchicalDataTemplate DataType="{x:Type common:BFFolder}" ItemsSource="{Binding DirItems}">
                                                            <StackPanel Orientation="Horizontal">
                                                                <Image Source="{Binding Icon}" VerticalAlignment="Stretch" Width="16" Height="16"/>
                                                                <TextBlock Text="{Binding Name}" ToolTip="{Binding Path}" Margin="3,0,0,0"/>
                                                            </StackPanel>
                                                        </HierarchicalDataTemplate>
                                                        <HierarchicalDataTemplate DataType="{x:Type common:BFFile}" ItemsSource="{Binding DirItems}">
                                                            <StackPanel Orientation="Horizontal">
                                                                <Image Source="{Binding Icon}" VerticalAlignment="Stretch" Width="15" Height="13"/>
                                                                <TextBlock Text="{Binding Name}" ToolTip="{Binding Path}" Margin="3,0,0,0"/>
                                                            </StackPanel>
                                                        </HierarchicalDataTemplate>
                                                        <SolidColorBrush x:Key="{x:Static SystemColors.HighlightBrushKey}"
                                                            Color="DodgerBlue" />
                                                        <SolidColorBrush x:Key="{x:Static SystemColors.HighlightTextBrushKey}"
                                                            Color="White" />
                                                        <SolidColorBrush x:Key="{x:Static SystemColors.InactiveSelectionHighlightBrushKey}"
                                                            Color="DodgerBlue" />
                                                        <SolidColorBrush x:Key="{x:Static SystemColors.InactiveSelectionHighlightTextBrushKey}"
                                                            Color="White" />
                                                    </TreeView.Resources>
                                                </TreeView>
                                            </DockPanel>
                                            <Button x:Name="btnQueueFromAll" Grid.Column="1" Height="17" Width="17" Click="btnQueueFromAll_Click" FontSize="10" ToolTip="Add to Schedules">
                                                &gt;
                                            </Button>
                                        </Grid>
                                    </Border>
                                </Grid>
                            </TabItem>
                        </TabControl>
                        <!--MID SPLIT-->
                        <GridSplitter Grid.Column="1" Height="Auto" HorizontalAlignment="Stretch" Background="Transparent"/>
                        <!--RIGHT-->
                        <TabControl Grid.Column="2" Margin="-2,-4,-2,-2">
                            <TabItem Visibility="Collapsed">
                                <Grid Grid.Column="2">
                                    <Grid.RowDefinitions>
                                        <RowDefinition Height="23" />
                                        <RowDefinition Height="30" />
                                        <RowDefinition />
                                    </Grid.RowDefinitions>
                                    <DockPanel Grid.Row="0">
                                        <StackPanel Orientation="Horizontal" DockPanel.Dock="Right">
                                            <Button x:Name="btnNewLineUp" Click="btnNewLineUp_Click" Style="{StaticResource ToolbarButtonStyle}" Width="100" Height="18" >
                                                <StackPanel Orientation="Horizontal">
                                                    <Image Source="pack://siteoforigin:,,,/Resources/check.ico" Width="12" Height="12"/>
                                                    <TextBlock Width="10"></TextBlock>
                                                    <TextBlock Foreground="Navy">New</TextBlock>
                                                </StackPanel>
                                            </Button>
                                            <Button x:Name="btnLineupLoad" Click="btnLineupLoad_Click" Style="{StaticResource ToolbarButtonStyle}" Width="100" Height="18" >
                                                <StackPanel Orientation="Horizontal">
                                                    <Image Source="pack://siteoforigin:,,,/Resources/Import.ico" Width="12" Height="12"/>
                                                    <TextBlock Width="10"></TextBlock>
                                                    <TextBlock Foreground="Navy">Load</TextBlock>
                                                </StackPanel>
                                            </Button>
                                            <Button x:Name="btnLineupSaveAs" Click="btnLineupSaveAs_Click" Style="{StaticResource ToolbarButtonStyle}" Width="100" Height="18">
                                                <StackPanel Orientation="Horizontal">
                                                    <Image Source="pack://siteoforigin:,,,/Resources/save.png" Width="12" Height="12"/>
                                                    <TextBlock Width="10"></TextBlock>
                                                    <TextBlock Foreground="Navy">Save As</TextBlock>
                                                </StackPanel>
                                            </Button>
                                        </StackPanel>
                                        <TextBlock VerticalAlignment="Center" Foreground="Navy" FontWeight="Bold">
                                            Test Schedules 
                                            <TextBlock x:Name="txtSchedulerFileName" Foreground="CornflowerBlue" FontWeight="Normal"></TextBlock>
                                        </TextBlock>
                                    </DockPanel>
                                    <ToolBar Grid.Row="1" VerticalAlignment="Stretch" Margin="-3,0,0,0" Loaded="ToolBar_Loaded" BorderBrush="Silver" BorderThickness="1" ToolBarTray.IsLocked="True">
                                        <Button x:Name="btnLineupUp" Margin="5,1,0,0" Style="{StaticResource ToolbarButtonStyle}" BorderBrush="Transparent" Click="btnLineupUp_Click" 
                                                    Height="22" Width="22" ToolTip="Move up">
                                            <Image Source="pack://siteoforigin:,,,/Resources/bullet_arrow_up.png" Height="12" Width="14"/>
                                        </Button>
                                        <Button x:Name="btnLineupDown" Margin="3,1,0,0" Style="{StaticResource ToolbarButtonStyle}" BorderBrush="Transparent" Click="btnLineupDown_Click" 
                                                    Height="22" Width="22" ToolTip="Move down">
                                            <Image Source="pack://siteoforigin:,,,/Resources/bullet_arrow_down.png" Height="12" Width="12"/>
                                        </Button>
                                        <Separator Margin="5,0">
                                            <Separator.LayoutTransform>
                                                <RotateTransform Angle="90" />
                                            </Separator.LayoutTransform>
                                        </Separator>
                                        <Button x:Name="btnLineupEdit" Margin="0,1,0,0" Style="{StaticResource ToolbarButtonStyle}" Click="btnLineupEdit_Click" 
                                                    BorderBrush="Transparent" Height="22" Width="22" ToolTip="Edit">
                                            <Image Source="pack://siteoforigin:,,,/Resources/edit.png" Height="12" Width="12"/>
                                        </Button>
                                        <Button x:Name="btnLineupDelete" Margin="0,1,0,0" Style="{StaticResource ToolbarButtonStyle}" Click="btnLineupDelete_Click" 
                                                    BorderBrush="Transparent" Height="22" Width="22" ToolTip="Delete">
                                            <Image Source="pack://siteoforigin:,,,/Resources/button_cancel.ico" Height="12" Width="12"/>
                                        </Button>
                                    </ToolBar>
                                    <StackPanel Grid.Row="1" Orientation="Horizontal" Width="80" HorizontalAlignment="Right">
                                        <TextBlock HorizontalAlignment="Right" VerticalAlignment="Center" FontSize="10" Foreground="CornflowerBlue">Edit Mode</TextBlock>
                                        <ToggleButton x:Name="toggleBtnEditMode" Margin="-12, 0, 0, 0" Style="{StaticResource SlidingToggleButtonStyle}" IsChecked="True"
                                                  HorizontalAlignment="Right" Background="WhiteSmoke"  Checked="toggleBtnEditMode_Checked" Unchecked="toggleBtnEditMode_Unchecked"/>
                                    </StackPanel>
                                    <!--START OF EDIT MODE -->
                                    <DataGrid x:Name="dgTestLineup" Grid.Row="2" Style="{StaticResource DataGridStyle1}"
                                      ColumnHeaderStyle="{StaticResource ColHeaderStyle}" ItemsSource="{Binding}"
                                      CanUserAddRows="False" Visibility="Visible"  HorizontalScrollBarVisibility="Hidden" ContextMenuOpening="dgTestLineupContextMenu_Opening"
                                      AllowDrop="True" Drop="dgTestLineup_Drop" CellEditEnding="dgTestLineup_CellEditEnding" PreparingCellForEdit="dgTestLineup_PreparingCellForEdit" 
                                      SelectedCellsChanged="dgTestLineup_SelectedCellsChanged" CanUserDeleteRows="False">
                                        <DataGrid.ContextMenu>
                                            <ContextMenu x:Name="dgTestLineupContextMenu">
                                                <ContextMenu.Style>
                                                    <Style TargetType="ContextMenu">
                                                        <Setter Property="FontFamily" Value="Calibri"></Setter>
                                                    </Style>
                                                </ContextMenu.Style>
                                                <MenuItem Name="GroupLineUpMenu" Click="GroupLineUpMenu_Click"/>
                                                <MenuItem Name="SetConditionMenu" Header="Set run condition..." Click="SetConditionMenu_Click"/>
                                                <MenuItem Name="RowColorMenu" Header="Row Color...">
                                                    <wpfx:ColorPicker Name="ColorPickerMenu" DisplayColorAndName="True" Width="150" Margin="-30,-2,-60,-1" ShowAdvancedButton="False" ShowStandardColors="False" SelectedColor="{Binding RowColor, NotifyOnSourceUpdated=True, UpdateSourceTrigger=PropertyChanged}" ShowAvailableColors="True" AvailableColorsSortingMode="HueSaturationBrightness" AvailableColors="{Binding ColorList}" Closed="ColorPickerMenu_Closed"/>
                                                </MenuItem>
                                                <MenuItem Name="RunNowMenu" Header="Run Now" Click="RunNowMenu_Click"/>
                                                <MenuItem Name="EditMenu" Header="Edit..." Click="EditMenu_Click"/>
                                            </ContextMenu>
                                        </DataGrid.ContextMenu>
                                        <DataGrid.Resources>
                                            <DataTemplate x:Key="EditingDateTemplate">
                                                <DatePicker SelectedDate="{Binding Schedule, Mode=TwoWay, NotifyOnSourceUpdated=True, UpdateSourceTrigger=PropertyChanged}"/>
                                            </DataTemplate>
                                            <DataTemplate x:Key="EditingListTemplate">
                                                <ComboBox ItemsSource="{Binding DaysOfWeek, RelativeSource={RelativeSource AncestorType={x:Type Window}}}"
                                                  Text="{Binding Schedule, Mode=TwoWay, NotifyOnSourceUpdated=True, UpdateSourceTrigger=PropertyChanged}"/>
                                            </DataTemplate>
                                            <DataTemplate x:Key="UneditableTemplate">
                                                <TextBlock IsEnabled="False" Text=""/>
                                            </DataTemplate>
                                        </DataGrid.Resources>
                                        <DataGrid.RowStyle>
                                            <Style TargetType="DataGridRow" >
                                                <Setter Property="Height" Value="27.75"/>
                                                <Setter Property="BorderThickness" Value="0.25"/>
                                                <Setter Property="Background">
                                                    <Setter.Value>
                                                        <SolidColorBrush Color="{Binding Path=RowColor, Mode=TwoWay,NotifyOnSourceUpdated=True, UpdateSourceTrigger=PropertyChanged, FallbackValue=White}"/>
                                                    </Setter.Value>
                                                </Setter>
                                                <Style.Triggers>
                                                    <Trigger Property="IsSelected" Value="True">
                                                        <Setter Property="BorderBrush" Value="BlueViolet" />
                                                        <Setter Property="BorderThickness" Value="2" />
                                                    </Trigger>
                                                </Style.Triggers>
                                            </Style>
                                        </DataGrid.RowStyle>
                                        <DataGrid.CellStyle>
                                            <Style TargetType="{x:Type DataGridCell}">
                                                <Setter Property="Background">
                                                    <Setter.Value>
                                                        <SolidColorBrush Color="{Binding Path=RowColor, Mode=TwoWay,NotifyOnSourceUpdated=True, UpdateSourceTrigger=PropertyChanged, FallbackValue=White}"/>
                                                    </Setter.Value>
                                                </Setter>
                                                <Setter Property="Foreground" Value="Navy" />
                                            </Style>
                                        </DataGrid.CellStyle>
                                        <DataGrid.Columns>
                                            <DataGridTemplateColumn  Header=" Test Suite" MinWidth="150" Width="*" IsReadOnly="True">
                                                <DataGridTemplateColumn.CellTemplate>
                                                    <DataTemplate>
                                                        <StackPanel Orientation="Horizontal">
                                                            <Image Source="{Binding Path=GroupImage, NotifyOnSourceUpdated=True, Converter={StaticResource NullImageConverter}}" VerticalAlignment="Center" ClipToBounds="True" Margin="0,-5,0,-5" Width="27.75" Height="27.75" />
                                                            <Image Source="pack://siteoforigin:,,,/Resources/warn.ico" VerticalAlignment="Center" Height="12" Width="12" Margin="0,-5, 3,-5" ToolTip="{Binding Path=ProductName, Converter={StaticResource TooltipDifferentProductConverter}, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" Visibility="{Binding Path=IsDifferentProduct, Converter={StaticResource WarningDifferentProductConverter}, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"/>
                                                            <TextBlock Text="{Binding TestSuiteToRun.Name, Mode=OneWay, NotifyOnSourceUpdated=True}" VerticalAlignment="Center" FontWeight="SemiBold">
                                                                <TextBlock.Style>
                                                                    <Style TargetType="TextBlock">
                                                                        <Setter Property="TextAlignment" Value="Center" />
                                                                        <Style.Triggers>
                                                                            <DataTrigger Binding="{Binding Enabled}" Value="True">
                                                                                <Setter Property="Foreground" Value="Navy"/>
                                                                                <Setter Property="FontStyle" Value="Normal"/>
                                                                            </DataTrigger>
                                                                            <DataTrigger Binding="{Binding Enabled}" Value="False">
                                                                                <Setter Property="Foreground" Value="Silver"/>
                                                                                <Setter Property="FontStyle" Value="Italic"/>
                                                                            </DataTrigger>
                                                                        </Style.Triggers>
                                                                    </Style>
                                                                </TextBlock.Style>
                                                            </TextBlock>
                                                        </StackPanel>
                                                    </DataTemplate>
                                                </DataGridTemplateColumn.CellTemplate>
                                            </DataGridTemplateColumn>
                                            <DataGridTemplateColumn Header="Enabled" Width="55">
                                                <DataGridTemplateColumn.CellTemplate>
                                                    <DataTemplate>
                                                        <StackPanel Orientation="Horizontal" Margin="5,0,0,0">
                                                            <CheckBox IsEnabled="{Binding IsEnabledAndNotGroupMember}" 
                                                                  IsChecked="{Binding Enabled, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged, NotifyOnSourceUpdated=True}" 
                                                                  Click="LineupEnabled_Click">
                                                                <CheckBox.Style>
                                                                    <Style TargetType="CheckBox">
                                                                        <Setter Property="VerticalAlignment" Value="Center" />
                                                                    </Style>
                                                                </CheckBox.Style>
                                                            </CheckBox>
                                                            <StackPanel Orientation="Horizontal">
                                                                <Label x:Name="lblDependent" FontFamily="Arial Black">
                                                                    <Label.Style>
                                                                        <Style TargetType="Label">
                                                                            <Setter Property="Visibility" Value="Collapsed"/>
                                                                            <Style.Triggers>
                                                                                <DataTrigger Binding="{Binding Dependent}" Value="True">
                                                                                    <Setter Property="Visibility" Value="Visible"/>
                                                                                    <Setter Property="Content" Value="{Binding ExecuteDependencyString}"/>
                                                                                </DataTrigger>
                                                                            </Style.Triggers>
                                                                        </Style>
                                                                    </Label.Style>
                                                                </Label>
                                                                <Rectangle Stroke="RoyalBlue" Height="10" Width="10" StrokeThickness="0.5" Margin="-3,0,0,0" VerticalAlignment="Center">
                                                                    <Rectangle.Style>
                                                                        <Style TargetType="Rectangle">
                                                                            <Setter Property="Visibility" Value="Collapsed"/>
                                                                            <Style.Triggers>
                                                                                <DataTrigger Binding="{Binding Dependent}" Value="True">
                                                                                    <Setter Property="Visibility" Value="Visible"/>
                                                                                </DataTrigger>
                                                                                <DataTrigger Binding="{Binding ExecuteDependencyResult}" Value="passed">
                                                                                    <Setter Property="Fill" Value="LightGreen"/>
                                                                                </DataTrigger>
                                                                                <DataTrigger Binding="{Binding ExecuteDependencyResult}" Value="failed">
                                                                                    <Setter Property="Fill" Value="MistyRose"/>
                                                                                </DataTrigger>
                                                                                <DataTrigger Binding="{Binding ExecuteDependencyResult}" Value="skipped">
                                                                                    <Setter Property="Fill" Value="White"/>
                                                                                </DataTrigger>
                                                                            </Style.Triggers>
                                                                        </Style>
                                                                    </Rectangle.Style>
                                                                </Rectangle>
                                                            </StackPanel>
                                                        </StackPanel>
                                                    </DataTemplate>
                                                </DataGridTemplateColumn.CellTemplate>
                                            </DataGridTemplateColumn>
                                            <DataGridTextColumn Header="Status" Width="80"
                                                Binding="{Binding StatusText, UpdateSourceTrigger=PropertyChanged, NotifyOnSourceUpdated=True}"
                                                IsReadOnly="True">
                                                <DataGridTextColumn.ElementStyle>
                                                    <Style TargetType="TextBlock">
                                                        <Setter Property="VerticalAlignment" Value="Center" />
                                                        <Setter Property="TextAlignment" Value="Center" />
                                                        <Style.Triggers>
                                                            <DataTrigger Binding="{Binding StatusText}" Value="Ready">
                                                                <Setter Property="Foreground" Value="LimeGreen"/>
                                                            </DataTrigger>
                                                            <DataTrigger Binding="{Binding Status}" Value="Running">
                                                                <Setter Property="Foreground" Value="DodgerBlue"/>
                                                            </DataTrigger>
                                                            <DataTrigger Binding="{Binding StatusText}" Value="Warning">
                                                                <Setter Property="Foreground" Value="Orange"/>
                                                            </DataTrigger>
                                                            <DataTrigger Binding="{Binding StatusText}" Value="Passed">
                                                                <Setter Property="Foreground" Value="LimeGreen"/>
                                                            </DataTrigger>
                                                            <DataTrigger Binding="{Binding StatusText}" Value="Failed">
                                                                <Setter Property="Foreground" Value="Red"/>
                                                            </DataTrigger>
                                                            <DataTrigger Binding="{Binding StatusText}" Value="Error">
                                                                <Setter Property="Foreground" Value="#FF870C0C"/>
                                                            </DataTrigger>
                                                            <DataTrigger Binding="{Binding StatusText}" Value="Disconnected">
                                                                <Setter Property="Foreground" Value="Gray"/>
                                                            </DataTrigger>
                                                            <DataTrigger Binding="{Binding StatusText}" Value="Cancelled">
                                                                <Setter Property="Foreground" Value="Black"/>
                                                            </DataTrigger>
                                                        </Style.Triggers>
                                                    </Style>
                                                </DataGridTextColumn.ElementStyle>
                                            </DataGridTextColumn>
                                            <DataGridTemplateColumn Header="Agent" Width="100">
                                                <DataGridTemplateColumn.CellTemplate>
                                                    <DataTemplate>
                                                        <TextBlock Padding="3" Text="{Binding AssignedAgentName}"/>
                                                    </DataTemplate>
                                                </DataGridTemplateColumn.CellTemplate>
                                                <DataGridTemplateColumn.CellEditingTemplate>
                                                    <DataTemplate>
                                                        <ComboBox ItemsSource="{Binding AgentsListView, RelativeSource={RelativeSource AncestorType={x:Type Window}}, UpdateSourceTrigger=PropertyChanged}"
                                                        SelectedItem="{Binding RunningAgent, NotifyOnSourceUpdated=True, UpdateSourceTrigger=PropertyChanged}" 
                                                        SelectedValue="{Binding RunningAgentName, Mode=OneWay}"
                                                        SelectedValuePath="Name" DropDownClosed="dgTestLineupAgent_DropDownClosed" IsEnabled="{Binding IsEnabledAndNotGroupMember}">
                                                            <ComboBox.GroupStyle>
                                                                <GroupStyle>
                                                                    <GroupStyle.HeaderTemplate>
                                                                        <DataTemplate>
                                                                            <TextBlock Text="{Binding Name}" FontWeight="ExtraBold" IsEnabled="False"/>
                                                                        </DataTemplate>
                                                                    </GroupStyle.HeaderTemplate>
                                                                </GroupStyle>
                                                            </ComboBox.GroupStyle>
                                                            <ComboBox.ItemTemplate>
                                                                <DataTemplate>
                                                                    <TextBlock Text="{Binding Name}"/>
                                                                </DataTemplate>
                                                            </ComboBox.ItemTemplate>
                                                        </ComboBox>
                                                    </DataTemplate>
                                                </DataGridTemplateColumn.CellEditingTemplate>
                                            </DataGridTemplateColumn>
                                            <DataGridTemplateColumn Header="Environment" Width="90">
                                                <DataGridTemplateColumn.CellTemplate>
                                                    <DataTemplate>
                                                        <StackPanel Orientation="Horizontal">
                                                            <Image Source="pack://siteoforigin:,,,/Resources/warn.ico" Margin="0, 0, 0, 2" VerticalAlignment="Center" Height="12" Width="12" ToolTip="{Binding Path=NonDefaultBlacklistedEnvironment, Converter={StaticResource TooltipBlacklistConverter}, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" Visibility="{Binding Path=IsBlacklisted, Converter={StaticResource BlacklistConverter}, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"></Image>
                                                            <TextBlock Padding="3" Text="{Binding Environment}"/>
                                                        </StackPanel>
                                                    </DataTemplate>
                                                </DataGridTemplateColumn.CellTemplate>
                                                <DataGridTemplateColumn.CellEditingTemplate>
                                                    <DataTemplate>
                                                        <ComboBox IsEnabled ="{Binding IsEnvironmentEnabled}" ItemsSource="{Binding EnvironmentList, RelativeSource={RelativeSource AncestorType={x:Type Window}}, UpdateSourceTrigger=PropertyChanged}"
                                                        SelectedItem="{Binding Environment, NotifyOnSourceUpdated=True, UpdateSourceTrigger=PropertyChanged}" 
                                                        DropDownClosed="dgTestLineupEnvironment_DropDownClosed" >
                                                            <ComboBox.ItemTemplate>
                                                                <ItemContainerTemplate>
                                                                    <StackPanel Orientation="Horizontal">
                                                                        <Image Source="pack://siteoforigin:,,,/Resources/warn.ico" Height="12" Width="12" VerticalAlignment="Center" ToolTip="Environment is blacklisted" Visibility="{Binding Converter={StaticResource DDBlacklistConverter}, UpdateSourceTrigger=PropertyChanged}"></Image>
                                                                        <TextBlock Text="{Binding}" Padding="3, 0, 0, 0"/>
                                                                    </StackPanel>
                                                                </ItemContainerTemplate>
                                                            </ComboBox.ItemTemplate>
                                                        </ComboBox>
                                                    </DataTemplate>
                                                </DataGridTemplateColumn.CellEditingTemplate>
                                            </DataGridTemplateColumn>
                                            <DataGridTemplateColumn Header="Browser" Width="90">
                                                <DataGridTemplateColumn.CellTemplate>
                                                    <DataTemplate>
                                                        <TextBlock Padding="3" Text="{Binding Browser.Name}"/>
                                                    </DataTemplate>
                                                </DataGridTemplateColumn.CellTemplate>
                                                <DataGridTemplateColumn.CellEditingTemplate>
                                                    <DataTemplate>
                                                        <ComboBox                                              
                                                              ItemsSource="{Binding AllBrowsers, RelativeSource={RelativeSource AncestorType={x:Type Window}}, UpdateSourceTrigger=PropertyChanged}"
                                                              SelectedItem="{Binding Browser, NotifyOnSourceUpdated=True, UpdateSourceTrigger=PropertyChanged}" 
                                                              DropDownClosed="dgTestLineupBrowser_DropDownClosed" IsEnabled="{Binding IsEnabledAndNotGroupMember}"
                                                              SelectedValue="{Binding Browser.Name,  Mode=OneWay}"
                                                              SelectedValuePath="Name">
                                                            <ComboBox.GroupStyle>
                                                                <GroupStyle>
                                                                    <GroupStyle.HeaderTemplate>
                                                                        <DataTemplate >
                                                                            <TextBlock Text="{Binding Name}" FontWeight="ExtraBold" IsEnabled="False"/>
                                                                        </DataTemplate>
                                                                    </GroupStyle.HeaderTemplate>
                                                                </GroupStyle>
                                                            </ComboBox.GroupStyle>
                                                            <ComboBox.ItemTemplate>
                                                                <DataTemplate>
                                                                    <TextBlock Text="{Binding Name}"/>
                                                                </DataTemplate>
                                                            </ComboBox.ItemTemplate>
                                                        </ComboBox>
                                                    </DataTemplate>
                                                </DataGridTemplateColumn.CellEditingTemplate>

                                            </DataGridTemplateColumn>
                                            <DataGridTemplateColumn Header="Start Time" Width="100">
                                                <DataGridTemplateColumn.CellTemplate>
                                                    <DataTemplate>
                                                        <TextBlock VerticalAlignment="Center" TextAlignment="Center" Text="{Binding StartTime, Mode=TwoWay, NotifyOnSourceUpdated=True, 
                                            UpdateSourceTrigger=PropertyChanged, Converter={StaticResource STConverter}}"></TextBlock>
                                                    </DataTemplate>
                                                </DataGridTemplateColumn.CellTemplate>
                                                <DataGridTemplateColumn.CellEditingTemplate>
                                                    <DataTemplate>
                                                        <controls:TimePickerCtrl x:Name="tpckrStartTime" IsEnabled="{Binding IsEnabledAndNotGroupMember}">
                                                        </controls:TimePickerCtrl>
                                                    </DataTemplate>
                                                </DataGridTemplateColumn.CellEditingTemplate>
                                            </DataGridTemplateColumn>
                                            <DataGridTemplateColumn Header="Recurrence" Width="80">
                                                <DataGridTemplateColumn.CellTemplate>
                                                    <DataTemplate>
                                                        <ComboBox IsEditable="True" IsEnabled="{Binding IsEnabledAndNotGroupMember}" DropDownClosed="dgTestLineupRecurrence_DropDownClosed"
                                                Text="{Binding Recurrence, Converter={StaticResource EConverter}, Mode=TwoWay, NotifyOnSourceUpdated=True, UpdateSourceTrigger=PropertyChanged}"
                                                ItemsSource="{Binding RecurrenceTypes, RelativeSource={RelativeSource AncestorType={x:Type Window}}}" 
                                                GotFocus="ComboBox_RecurrenceGotFocus" LostFocus="ComboBox_RecurrenceLostFocus"/>
                                                    </DataTemplate>
                                                </DataGridTemplateColumn.CellTemplate>
                                            </DataGridTemplateColumn>
                                            <DataGridTemplateColumn Header="When?" Width="80">
                                                <DataGridTemplateColumn.CellTemplate>
                                                    <DataTemplate>
                                                        <TextBlock VerticalAlignment="Center" TextAlignment="Center">
                                                            <TextBlock.Style>
                                                                <Style TargetType="TextBlock">
                                                                    <Setter Property="Text">
                                                                        <Setter.Value>
                                                                            <MultiBinding Converter="{StaticResource SConverter}">
                                                                                <Binding Path="Schedule"  Mode="TwoWay" NotifyOnSourceUpdated="True" UpdateSourceTrigger="PropertyChanged" StringFormat="d"/>
                                                                                <Binding Path="Recurrence" Mode="TwoWay" NotifyOnSourceUpdated="True" UpdateSourceTrigger="PropertyChanged" StringFormat="d"/>
                                                                            </MultiBinding>
                                                                        </Setter.Value>
                                                                    </Setter>
                                                                </Style>
                                                            </TextBlock.Style>
                                                        </TextBlock>
                                                    </DataTemplate>
                                                </DataGridTemplateColumn.CellTemplate>
                                                <DataGridTemplateColumn.CellEditingTemplate>
                                                    <DataTemplate>
                                                        <ContentPresenter x:Name="Presenter" Content="{Binding}" IsEnabled="{Binding IsEnabledAndNotGroupMember}" ContentTemplate="{StaticResource EditingDateTemplate}"/>
                                                        <DataTemplate.Triggers>
                                                            <DataTrigger Binding="{Binding Recurrence, Converter={StaticResource EConverter}}" Value="Weekly">
                                                                <Setter TargetName="Presenter" Property="ContentTemplate" Value="{StaticResource EditingListTemplate}"/>
                                                            </DataTrigger>
                                                            <DataTrigger Binding="{Binding Recurrence, Converter={StaticResource EConverter}}" Value="Daily">
                                                                <Setter TargetName="Presenter" Property="ContentTemplate" Value="{StaticResource UneditableTemplate}"/>
                                                            </DataTrigger>
                                                            <DataTrigger Binding="{Binding Recurrence, Converter={StaticResource EConverter}}" Value="Weekdays">
                                                                <Setter TargetName="Presenter" Property="ContentTemplate" Value="{StaticResource UneditableTemplate}"/>
                                                            </DataTrigger>
                                                        </DataTemplate.Triggers>
                                                    </DataTemplate>
                                                </DataGridTemplateColumn.CellEditingTemplate>
                                            </DataGridTemplateColumn>
                                            <DataGridTemplateColumn Width="60">
                                                <DataGridTemplateColumn.CellTemplate>
                                                    <DataTemplate>
                                                        <TextBlock VerticalAlignment="Center" TextAlignment="Center" IsEnabled="{Binding IsEnabled}">
                                                    <Hyperlink Click="linkOptions_Click">Options</Hyperlink>
                                                        </TextBlock>
                                                    </DataTemplate>
                                                </DataGridTemplateColumn.CellTemplate>
                                            </DataGridTemplateColumn>
                                        </DataGrid.Columns>
                                    </DataGrid>
                                    <!--END OF EDIT MODE-->
                                    <!--START OF RESULTS MODE -->
                                    <DataGrid x:Name="dgLastRunResult" Grid.Row="2" Style="{StaticResource DataGridStyle1}"
                                  ColumnHeaderStyle="{StaticResource ColHeaderStyle}" VirtualizingPanel.IsVirtualizing="True"
                                  CanUserAddRows="False" IsReadOnly="True" Visibility="Collapsed" 
                                  CellStyle="{StaticResource CellStyleResults}" SelectedCellsChanged="dgTestLineup_SelectedCellsChanged"
                                  AllowDrop="True" Drop="dgTestLineup_Drop" HorizontalScrollBarVisibility="Hidden" ItemsSource="{Binding}">
                                        <DataGrid.RowStyle>
                                            <Style TargetType="DataGridRow" >
                                                <Setter Property="BorderThickness" Value="0.25"/>
                                                <Setter Property="Background" Value="White"/>
                                                <Setter Property="Foreground" Value="Navy"/>
                                                <Setter Property="Height" Value="27.75"/>
                                                <Setter Property="ToolTip" Value="{Binding TestSuiteToRun.Name}" />
                                                <Style.Triggers>
                                                    <Trigger Property="IsSelected" Value="True">
                                                        <Setter Property="BorderBrush" Value="BlueViolet" />
                                                        <Setter Property="BorderThickness" Value="2" />
                                                    </Trigger>
                                                </Style.Triggers>
                                            </Style>
                                        </DataGrid.RowStyle>
                                        <DataGrid.Columns>
                                            <DataGridTemplateColumn  Header=" Test Suite" MinWidth="150" Width="*" IsReadOnly="True">
                                                <DataGridTemplateColumn.CellStyle>
                                                    <Style TargetType="DataGridCell">
                                                        <Setter Property="Background" Value="WhiteSmoke"/>
                                                        <Setter Property="BorderThickness" Value="0.25"/>
                                                        <Style.Triggers>
                                                            <Trigger Property="IsSelected" Value="True">
                                                                <Setter Property="Foreground" Value="Navy" />
                                                                <Setter Property="FontWeight" Value="ExtraBlack"/>
                                                            </Trigger>
                                                        </Style.Triggers>
                                                    </Style>
                                                </DataGridTemplateColumn.CellStyle>
                                                <DataGridTemplateColumn.CellTemplate>
                                                    <DataTemplate>
                                                        <StackPanel Orientation="Horizontal">
                                                            <Image Source="{Binding Path=GroupImage, NotifyOnSourceUpdated=True, Converter={StaticResource NullImageConverter}}" ClipToBounds="True" Margin="0,-5,0,-5" Width="27.75" Height="27.75" VerticalAlignment="Center"/>
                                                            <TextBlock Text="{Binding TestSuiteToRun.Name, Mode=OneWay, NotifyOnSourceUpdated=True}" VerticalAlignment="Center" FontWeight="SemiBold"/>
                                                        </StackPanel>
                                                    </DataTemplate>
                                                </DataGridTemplateColumn.CellTemplate>
                                            </DataGridTemplateColumn>
                                            <DataGridTextColumn Header="Execution Date" Width="80" Binding="{Binding LastRunResult.ExecutionDate, NotifyOnSourceUpdated=True, Mode=OneWay, UpdateSourceTrigger=PropertyChanged}" CanUserResize="True">
                                                <DataGridTextColumn.ElementStyle>
                                                    <Style TargetType="TextBlock">
                                                        <Setter Property="VerticalAlignment" Value="Center"/>
                                                        <Setter Property="TextAlignment" Value="Center"/>
                                                    </Style>
                                                </DataGridTextColumn.ElementStyle>
                                            </DataGridTextColumn>
                                            <DataGridTextColumn Header="Start Time" Width="80" Binding="{Binding LastRunResult.StartTime, NotifyOnSourceUpdated=True, Mode=OneWay}" CanUserResize="True">
                                                <DataGridTextColumn.ElementStyle>
                                                    <Style TargetType="TextBlock">
                                                        <Setter Property="VerticalAlignment" Value="Center"/>
                                                        <Setter Property="TextAlignment" Value="Center"/>
                                                    </Style>
                                                </DataGridTextColumn.ElementStyle>
                                            </DataGridTextColumn>
                                            <DataGridTextColumn Header="End Time" Width="80" Binding="{Binding LastRunResult.EndTime, NotifyOnSourceUpdated=True, Mode=OneWay, UpdateSourceTrigger=PropertyChanged}" CanUserResize="True">
                                                <DataGridTextColumn.ElementStyle>
                                                    <Style TargetType="TextBlock">
                                                        <Setter Property="VerticalAlignment" Value="Center"/>
                                                        <Setter Property="TextAlignment" Value="Center"/>
                                                    </Style>
                                                </DataGridTextColumn.ElementStyle>
                                            </DataGridTextColumn>
                                            <DataGridTextColumn Header="Duration" Width="100" Binding="{Binding LastRunResult.Duration, NotifyOnSourceUpdated=True, Mode=OneWay, UpdateSourceTrigger=PropertyChanged}" CanUserResize="True">
                                                <DataGridTextColumn.ElementStyle>
                                                    <Style TargetType="TextBlock">
                                                        <Setter Property="VerticalAlignment" Value="Center"/>
                                                        <Setter Property="TextAlignment" Value="Center"/>
                                                    </Style>
                                                </DataGridTextColumn.ElementStyle>
                                            </DataGridTextColumn>
                                            <DataGridTextColumn Header="Agent" Width="75" Binding="{Binding LastRunResult.RunningAgent, NotifyOnSourceUpdated=True, Mode=OneWay}" CanUserResize="True">
                                                <DataGridTextColumn.ElementStyle>
                                                    <Style TargetType="TextBlock">
                                                        <Setter Property="VerticalAlignment" Value="Center"/>
                                                        <Setter Property="TextAlignment" Value="Center"/>
                                                    </Style>
                                                </DataGridTextColumn.ElementStyle>
                                            </DataGridTextColumn>
                                            <DataGridTextColumn Header="Total" Width="45" Binding="{Binding LastRunResult.TotalTests, NotifyOnSourceUpdated=True, Mode=OneWay, UpdateSourceTrigger=PropertyChanged}" CanUserResize="True">
                                                <DataGridTextColumn.ElementStyle>
                                                    <Style TargetType="TextBlock">
                                                        <Setter Property="VerticalAlignment" Value="Center"/>
                                                        <Setter Property="TextAlignment" Value="Right"/>
                                                        <Setter Property="Margin" Value="0,0,3,0" />
                                                    </Style>
                                                </DataGridTextColumn.ElementStyle>
                                            </DataGridTextColumn>
                                            <DataGridTextColumn Header="Passed" Width="45" Binding="{Binding LastRunResult.PassedTests, NotifyOnSourceUpdated=True, Mode=OneWay, UpdateSourceTrigger=PropertyChanged}" CanUserResize="True">
                                                <DataGridTextColumn.ElementStyle>
                                                    <Style TargetType="TextBlock">
                                                        <Setter Property="VerticalAlignment" Value="Center"/>
                                                        <Setter Property="TextAlignment" Value="Right"/>
                                                        <Setter Property="Margin" Value="0,0,3,0" />
                                                    </Style>
                                                </DataGridTextColumn.ElementStyle>
                                            </DataGridTextColumn>
                                            <DataGridTextColumn Header="Failed" Width="45" Binding="{Binding LastRunResult.FailedTests, NotifyOnSourceUpdated=True, Mode=OneWay, UpdateSourceTrigger=PropertyChanged}" CanUserResize="True">
                                                <DataGridTextColumn.ElementStyle>
                                                    <Style TargetType="TextBlock">
                                                        <Setter Property="VerticalAlignment" Value="Center"/>
                                                        <Setter Property="TextAlignment" Value="Right"/>
                                                        <Setter Property="Margin" Value="0,0,3,0" />
                                                    </Style>
                                                </DataGridTextColumn.ElementStyle>
                                            </DataGridTextColumn>
                                            <DataGridTextColumn Header="Not Run" Width="45" Binding="{Binding LastRunResult.NotRunTests, NotifyOnSourceUpdated=True, Mode=OneWay, UpdateSourceTrigger=PropertyChanged}" CanUserResize="True">
                                                <DataGridTextColumn.ElementStyle>
                                                    <Style TargetType="TextBlock">
                                                        <Setter Property="VerticalAlignment" Value="Center"/>
                                                        <Setter Property="TextAlignment" Value="Right"/>
                                                        <Setter Property="Margin" Value="0,0,3,0" />
                                                    </Style>
                                                </DataGridTextColumn.ElementStyle>
                                            </DataGridTextColumn>
                                            <DataGridTemplateColumn Header="Pass Rate (%)" Width="75" CanUserResize="True">
                                                <DataGridTemplateColumn.CellTemplate>
                                                    <DataTemplate>
                                                        <Grid VerticalAlignment="Center">
                                                            <Grid.ColumnDefinitions>
                                                                <ColumnDefinition />
                                                                <ColumnDefinition Width="6"/>
                                                                <ColumnDefinition Width="6"/>
                                                                <ColumnDefinition Width="6"/>
                                                                <ColumnDefinition Width="6"/>
                                                                <ColumnDefinition Width="6"/>
                                                                <ColumnDefinition Width="6"/>
                                                                <ColumnDefinition Width="6"/>
                                                                <ColumnDefinition Width="6"/>
                                                                <ColumnDefinition Width="6"/>
                                                                <ColumnDefinition Width="6"/>
                                                                <ColumnDefinition/>
                                                            </Grid.ColumnDefinitions>
                                                            <Rectangle Grid.Column="1" Stroke="Silver" Height="12" Width="6" StrokeThickness="0.3" VerticalAlignment="Center">
                                                                <Rectangle.Style>
                                                                    <Style TargetType="Rectangle">
                                                                        <Setter Property="Fill">
                                                                            <Setter.Value>
                                                                                <MultiBinding Converter="{StaticResource PRConverter}">
                                                                                    <Binding Path="LastRunResult.PassRate" NotifyOnSourceUpdated="True" UpdateSourceTrigger="PropertyChanged"/>
                                                                                    <Binding>
                                                                                        <Binding.Source>
                                                                                            <sys:String>1</sys:String>
                                                                                        </Binding.Source>
                                                                                    </Binding>
                                                                                </MultiBinding>
                                                                            </Setter.Value>
                                                                        </Setter>
                                                                    </Style>
                                                                </Rectangle.Style>
                                                            </Rectangle>
                                                            <Rectangle Grid.Column="2" Stroke="Silver" Height="12" Width="6" StrokeThickness="0.3" VerticalAlignment="Center">
                                                                <Rectangle.Style>
                                                                    <Style TargetType="Rectangle">
                                                                        <Setter Property="Fill">
                                                                            <Setter.Value>
                                                                                <MultiBinding Converter="{StaticResource PRConverter}">
                                                                                    <Binding Path="LastRunResult.PassRate" NotifyOnSourceUpdated="True" UpdateSourceTrigger="PropertyChanged"/>
                                                                                    <Binding>
                                                                                        <Binding.Source>
                                                                                            <sys:String>2</sys:String>
                                                                                        </Binding.Source>
                                                                                    </Binding>
                                                                                </MultiBinding>
                                                                            </Setter.Value>
                                                                        </Setter>
                                                                    </Style>
                                                                </Rectangle.Style>
                                                            </Rectangle>
                                                            <Rectangle Grid.Column="3" Stroke="Silver" Height="12" Width="6" StrokeThickness="0.3" VerticalAlignment="Center">
                                                                <Rectangle.Style>
                                                                    <Style TargetType="Rectangle">
                                                                        <Setter Property="Fill">
                                                                            <Setter.Value>
                                                                                <MultiBinding Converter="{StaticResource PRConverter}">
                                                                                    <Binding Path="LastRunResult.PassRate" NotifyOnSourceUpdated="True" UpdateSourceTrigger="PropertyChanged"/>
                                                                                    <Binding>
                                                                                        <Binding.Source>
                                                                                            <sys:String>3</sys:String>
                                                                                        </Binding.Source>
                                                                                    </Binding>
                                                                                </MultiBinding>
                                                                            </Setter.Value>
                                                                        </Setter>
                                                                    </Style>
                                                                </Rectangle.Style>
                                                            </Rectangle>
                                                            <Rectangle Grid.Column="4" Stroke="Silver" Height="12" Width="6" StrokeThickness="0.3" VerticalAlignment="Center">
                                                                <Rectangle.Style>
                                                                    <Style TargetType="Rectangle">
                                                                        <Setter Property="Fill">
                                                                            <Setter.Value>
                                                                                <MultiBinding Converter="{StaticResource PRConverter}">
                                                                                    <Binding Path="LastRunResult.PassRate" NotifyOnSourceUpdated="True" UpdateSourceTrigger="PropertyChanged"/>
                                                                                    <Binding>
                                                                                        <Binding.Source>
                                                                                            <sys:String>4</sys:String>
                                                                                        </Binding.Source>
                                                                                    </Binding>
                                                                                </MultiBinding>
                                                                            </Setter.Value>
                                                                        </Setter>
                                                                    </Style>
                                                                </Rectangle.Style>
                                                            </Rectangle>
                                                            <Rectangle Grid.Column="5" Stroke="Silver" Height="12" Width="6" StrokeThickness="0.3" VerticalAlignment="Center">
                                                                <Rectangle.Style>
                                                                    <Style TargetType="Rectangle">
                                                                        <Setter Property="Fill">
                                                                            <Setter.Value>
                                                                                <MultiBinding Converter="{StaticResource PRConverter}">
                                                                                    <Binding Path="LastRunResult.PassRate" NotifyOnSourceUpdated="True" UpdateSourceTrigger="PropertyChanged"/>
                                                                                    <Binding>
                                                                                        <Binding.Source>
                                                                                            <sys:String>5</sys:String>
                                                                                        </Binding.Source>
                                                                                    </Binding>
                                                                                </MultiBinding>
                                                                            </Setter.Value>
                                                                        </Setter>
                                                                    </Style>
                                                                </Rectangle.Style>
                                                            </Rectangle>
                                                            <Rectangle Grid.Column="6" Stroke="Silver" Height="12" Width="6" StrokeThickness="0.3" VerticalAlignment="Center">
                                                                <Rectangle.Style>
                                                                    <Style TargetType="Rectangle">
                                                                        <Setter Property="Fill">
                                                                            <Setter.Value>
                                                                                <MultiBinding Converter="{StaticResource PRConverter}">
                                                                                    <Binding Path="LastRunResult.PassRate" NotifyOnSourceUpdated="True" UpdateSourceTrigger="PropertyChanged"/>
                                                                                    <Binding>
                                                                                        <Binding.Source>
                                                                                            <sys:String>6</sys:String>
                                                                                        </Binding.Source>
                                                                                    </Binding>
                                                                                </MultiBinding>
                                                                            </Setter.Value>
                                                                        </Setter>
                                                                    </Style>
                                                                </Rectangle.Style>
                                                            </Rectangle>
                                                            <Rectangle Grid.Column="7" Stroke="Silver" Height="12" Width="6" StrokeThickness="0.3" VerticalAlignment="Center">
                                                                <Rectangle.Style>
                                                                    <Style TargetType="Rectangle">
                                                                        <Setter Property="Fill">
                                                                            <Setter.Value>
                                                                                <MultiBinding Converter="{StaticResource PRConverter}">
                                                                                    <Binding Path="LastRunResult.PassRate" NotifyOnSourceUpdated="True" UpdateSourceTrigger="PropertyChanged"/>
                                                                                    <Binding>
                                                                                        <Binding.Source>
                                                                                            <sys:String>7</sys:String>
                                                                                        </Binding.Source>
                                                                                    </Binding>
                                                                                </MultiBinding>
                                                                            </Setter.Value>
                                                                        </Setter>
                                                                    </Style>
                                                                </Rectangle.Style>
                                                            </Rectangle>
                                                            <Rectangle Grid.Column="8" Stroke="Silver" Height="12" Width="6" StrokeThickness="0.3" VerticalAlignment="Center">
                                                                <Rectangle.Style>
                                                                    <Style TargetType="Rectangle">
                                                                        <Setter Property="Fill">
                                                                            <Setter.Value>
                                                                                <MultiBinding Converter="{StaticResource PRConverter}">
                                                                                    <Binding Path="LastRunResult.PassRate" NotifyOnSourceUpdated="True" UpdateSourceTrigger="PropertyChanged"/>
                                                                                    <Binding>
                                                                                        <Binding.Source>
                                                                                            <sys:String>8</sys:String>
                                                                                        </Binding.Source>
                                                                                    </Binding>
                                                                                </MultiBinding>
                                                                            </Setter.Value>
                                                                        </Setter>
                                                                    </Style>
                                                                </Rectangle.Style>
                                                            </Rectangle>
                                                            <Rectangle Grid.Column="9" Stroke="Silver" Height="12" Width="6" StrokeThickness="0.3" VerticalAlignment="Center">
                                                                <Rectangle.Style>
                                                                    <Style TargetType="Rectangle">
                                                                        <Setter Property="Fill">
                                                                            <Setter.Value>
                                                                                <MultiBinding Converter="{StaticResource PRConverter}">
                                                                                    <Binding Path="LastRunResult.PassRate" NotifyOnSourceUpdated="True" UpdateSourceTrigger="PropertyChanged"/>
                                                                                    <Binding>
                                                                                        <Binding.Source>
                                                                                            <sys:String>9</sys:String>
                                                                                        </Binding.Source>
                                                                                    </Binding>
                                                                                </MultiBinding>
                                                                            </Setter.Value>
                                                                        </Setter>
                                                                    </Style>
                                                                </Rectangle.Style>
                                                            </Rectangle>
                                                            <Rectangle Grid.Column="10" Stroke="Silver" Height="12" Width="6" StrokeThickness="0.3" VerticalAlignment="Center">
                                                                <Rectangle.Style>
                                                                    <Style TargetType="Rectangle">
                                                                        <Setter Property="Fill">
                                                                            <Setter.Value>
                                                                                <MultiBinding Converter="{StaticResource PRConverter}">
                                                                                    <Binding Path="LastRunResult.PassRate" NotifyOnSourceUpdated="True" UpdateSourceTrigger="PropertyChanged"/>
                                                                                    <Binding>
                                                                                        <Binding.Source>
                                                                                            <sys:String>10</sys:String>
                                                                                        </Binding.Source>
                                                                                    </Binding>
                                                                                </MultiBinding>
                                                                            </Setter.Value>
                                                                        </Setter>
                                                                    </Style>
                                                                </Rectangle.Style>
                                                            </Rectangle>
                                                            <TextBlock Grid.Column="1" Grid.ColumnSpan="10" FontWeight="ExtraBlack" FontSize="11" Text="{Binding LastRunResult.PassRate}" TextAlignment="Center" HorizontalAlignment="Center">
                                                                <TextBlock.Style>
                                                                    <Style TargetType="TextBlock">
                                                                        <Setter Property="Foreground" Value="Navy"/>
                                                                        <Style.Triggers>
                                                                            <DataTrigger Binding="{Binding LastRunResult.PassRate}" Value="0%">
                                                                                <Setter Property="Foreground" Value="White"/>
                                                                            </DataTrigger>
                                                                        </Style.Triggers>
                                                                    </Style>
                                                                </TextBlock.Style>
                                                            </TextBlock>
                                                        </Grid>

                                                    </DataTemplate>
                                                </DataGridTemplateColumn.CellTemplate>
                                            </DataGridTemplateColumn>
                                        </DataGrid.Columns>
                                    </DataGrid>
                                    <!--END OF RESULTS MODE-->
                                </Grid>
                            </TabItem>
                        </TabControl>
                    </Grid>

                    <GridSplitter Grid.Row="1" Height="Auto" HorizontalAlignment="Stretch" Background="Transparent"/>

                    <!--BOTTOM: history grid -->
                    <TabControl Grid.Row="2" Margin="-2,-2,-2,-2">
                        <TabItem Visibility="Collapsed">
                            <Grid >
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="25"/>
                                    <RowDefinition />
                                </Grid.RowDefinitions>
                                <Grid Grid.Row="0">
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition />
                                        <ColumnDefinition />
                                    </Grid.ColumnDefinitions>
                                    <Grid Grid.Column="0">
                                        <TextBlock Height="20" MaxHeight="20" MinHeight="20" Foreground="Navy" FontWeight="Bold" Margin="5,0,0,0">
                                            History
                                            <TextBlock Foreground="Silver" FontSize="9" FontWeight="Light" FontStyle="Italic" Text="(Double-click to view test results details)"/>
                                        </TextBlock>
                                    </Grid>
                                    <Grid Grid.Column="1" HorizontalAlignment="Right" VerticalAlignment="Center" Height="20">
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition />
                                            <ColumnDefinition />
                                            <ColumnDefinition />
                                            <ColumnDefinition />
                                        </Grid.ColumnDefinitions>
                                        <CheckBox Grid.Column="0" Margin="0,0,7,0" x:Name="chkControllerHistoryFilter" IsEnabled="True" Click="chkControllerHistoryFilter_Click" ToolTip="Filter Result History">Filter</CheckBox>
                                        <DatePicker Grid.Column="1" Margin="0,-3,4,0" x:Name="dtControllerHistoryFrom" IsEnabled="False" ToolTip="Filter Start Date" DateValidationError="dtControllerHistoryFrom_DateValidationError" LostFocus="dtControllerHistoryFrom_LostFocus" TextBoxBase.TextChanged="dtControllerHistoryFrom_TextChanged" />
                                        <Label Grid.Column="2" Margin="0,-4,4,0">To</Label>
                                        <DatePicker Grid.Column="3" Margin="0,-3,4,0" x:Name="dtControllerHistoryTo" IsEnabled="False" ToolTip="Filter End Date" DateValidationError="dtControllerHistoryTo_DateValidationError"  LostFocus="dtControllerHistoryTo_LostFocus" TextBoxBase.TextChanged="dtControllerHistoryTo_TextChanged" />
                                    </Grid>
                                </Grid>
                                <DataGrid x:Name="dgTestHistory" Grid.Row="1" Style="{StaticResource DataGridStyle1}" CellStyle="{StaticResource CellStyleResults}" RowStyle="{StaticResource RowStyle}"  HorizontalScrollBarVisibility="Hidden"
                                          ColumnHeaderStyle="{StaticResource ColHeaderStyleCentered}" VirtualizingPanel.IsVirtualizing="True" CanUserAddRows="False" IsReadOnly="True"
                                          MouseDoubleClick="dgTestHistory_MouseDoubleClick" SelectionUnit="FullRow">
                                    <DataGrid.ContextMenu>
                                        <ContextMenu x:Name="ctxHistory">
                                            <ContextMenu.Style>
                                                <Style TargetType="ContextMenu">
                                                    <Setter Property="FontFamily" Value="Calibri"></Setter>
                                                </Style>
                                            </ContextMenu.Style>
                                            <MenuItem Name="mnuViewDetails" Click="mnuViewDetails_Click" Header="View Details..."/>
                                            <MenuItem Name="mnuDeleteHistoryItem" Click="mnuDeleteHistoryItem_Click" Header="Delete"/>
                                        </ContextMenu>
                                    </DataGrid.ContextMenu>
                                    <DataGrid.Columns>
                                        <DataGridTextColumn Header="Execution Date" Width="100*" Binding="{Binding ExecutionDate}" CanUserResize="True" FontWeight="ExtraBlack" 
                                                            HeaderStyle="{StaticResource ColHeaderStyle}">
                                            <DataGridTextColumn.CellStyle>
                                                <Style TargetType="DataGridCell">
                                                    <Setter Property="Background" Value="WhiteSmoke"/>
                                                    <Setter Property="BorderThickness" Value="0.25"/>
                                                    <Style.Triggers>
                                                        <Trigger Property="IsSelected" Value="True">
                                                            <Setter Property="Foreground" Value="Navy" />
                                                            <Setter Property="FontWeight" Value="ExtraBlack"/>
                                                        </Trigger>
                                                    </Style.Triggers>
                                                </Style>
                                            </DataGridTextColumn.CellStyle>
                                            <DataGridTextColumn.ElementStyle>
                                                <Style TargetType="TextBlock">
                                                    <Setter Property="TextAlignment" Value="Center"/>
                                                </Style>
                                            </DataGridTextColumn.ElementStyle>
                                        </DataGridTextColumn>
                                        <DataGridTemplateColumn Width="85" CanUserResize="True">
                                            <DataGridTemplateColumn.Header>
                                                <DockPanel>
                                                    <TextBlock Text="Pass Rate (%) "/>
                                                    <Image Source="pack://siteoforigin:,,,/Resources/info.png" Height="12" Width="14">
                                                        <Image.ToolTip>
                                                            <ToolTip Placement="Top">
                                                                <StackPanel>
                                                                    <TextBlock FontWeight="Bold">
                                                                        Pass Rate
                                                                    </TextBlock>
                                                                    <TextBlock FontStyle="Italic">
                                                                        This value represents all passed tests versus executed tests.
                                                                    </TextBlock>
                                                                </StackPanel>
                                                            </ToolTip>
                                                        </Image.ToolTip>
                                                    </Image>
                                                </DockPanel>
                                            </DataGridTemplateColumn.Header>
                                            <DataGridTemplateColumn.CellTemplate>
                                                <DataTemplate>
                                                    <Grid VerticalAlignment="Center">
                                                        <Grid.ColumnDefinitions>
                                                            <ColumnDefinition />
                                                            <ColumnDefinition Width="8"/>
                                                            <ColumnDefinition Width="8"/>
                                                            <ColumnDefinition Width="8"/>
                                                            <ColumnDefinition Width="8"/>
                                                            <ColumnDefinition Width="8"/>
                                                            <ColumnDefinition Width="8"/>
                                                            <ColumnDefinition Width="8"/>
                                                            <ColumnDefinition Width="8"/>
                                                            <ColumnDefinition Width="8"/>
                                                            <ColumnDefinition Width="8"/>
                                                            <ColumnDefinition/>
                                                        </Grid.ColumnDefinitions>
                                                        <Rectangle Grid.Column="1" Stroke="Silver" Height="12" Width="8" StrokeThickness="0.3" VerticalAlignment="Center">
                                                            <Rectangle.Style>
                                                                <Style TargetType="Rectangle">
                                                                    <Setter Property="Fill">
                                                                        <Setter.Value>
                                                                            <MultiBinding Converter="{StaticResource PRConverter}">
                                                                                <Binding Path="PassRate" NotifyOnSourceUpdated="True" UpdateSourceTrigger="PropertyChanged"/>
                                                                                <Binding>
                                                                                    <Binding.Source>
                                                                                        <sys:String>1</sys:String>
                                                                                    </Binding.Source>
                                                                                </Binding>
                                                                            </MultiBinding>
                                                                        </Setter.Value>
                                                                    </Setter>
                                                                </Style>
                                                            </Rectangle.Style>
                                                        </Rectangle>
                                                        <Rectangle Grid.Column="2" Stroke="Silver" Height="12" Width="8" StrokeThickness="0.3" VerticalAlignment="Center">
                                                            <Rectangle.Style>
                                                                <Style TargetType="Rectangle">
                                                                    <Setter Property="Fill">
                                                                        <Setter.Value>
                                                                            <MultiBinding Converter="{StaticResource PRConverter}">
                                                                                <Binding Path="PassRate" NotifyOnSourceUpdated="True" UpdateSourceTrigger="PropertyChanged"/>
                                                                                <Binding>
                                                                                    <Binding.Source>
                                                                                        <sys:String>2</sys:String>
                                                                                    </Binding.Source>
                                                                                </Binding>
                                                                            </MultiBinding>
                                                                        </Setter.Value>
                                                                    </Setter>
                                                                </Style>
                                                            </Rectangle.Style>
                                                        </Rectangle>
                                                        <Rectangle Grid.Column="3" Stroke="Silver" Height="12" Width="8" StrokeThickness="0.3" VerticalAlignment="Center">
                                                            <Rectangle.Style>
                                                                <Style TargetType="Rectangle">
                                                                    <Setter Property="Fill">
                                                                        <Setter.Value>
                                                                            <MultiBinding Converter="{StaticResource PRConverter}">
                                                                                <Binding Path="PassRate" NotifyOnSourceUpdated="True" UpdateSourceTrigger="PropertyChanged"/>
                                                                                <Binding>
                                                                                    <Binding.Source>
                                                                                        <sys:String>3</sys:String>
                                                                                    </Binding.Source>
                                                                                </Binding>
                                                                            </MultiBinding>
                                                                        </Setter.Value>
                                                                    </Setter>
                                                                </Style>
                                                            </Rectangle.Style>
                                                        </Rectangle>
                                                        <Rectangle Grid.Column="4" Stroke="Silver" Height="12" Width="8" StrokeThickness="0.3" VerticalAlignment="Center">
                                                            <Rectangle.Style>
                                                                <Style TargetType="Rectangle">
                                                                    <Setter Property="Fill">
                                                                        <Setter.Value>
                                                                            <MultiBinding Converter="{StaticResource PRConverter}">
                                                                                <Binding Path="PassRate" NotifyOnSourceUpdated="True" UpdateSourceTrigger="PropertyChanged"/>
                                                                                <Binding>
                                                                                    <Binding.Source>
                                                                                        <sys:String>4</sys:String>
                                                                                    </Binding.Source>
                                                                                </Binding>
                                                                            </MultiBinding>
                                                                        </Setter.Value>
                                                                    </Setter>
                                                                </Style>
                                                            </Rectangle.Style>
                                                        </Rectangle>
                                                        <Rectangle Grid.Column="5" Stroke="Silver" Height="12" Width="8" StrokeThickness="0.3" VerticalAlignment="Center">
                                                            <Rectangle.Style>
                                                                <Style TargetType="Rectangle">
                                                                    <Setter Property="Fill">
                                                                        <Setter.Value>
                                                                            <MultiBinding Converter="{StaticResource PRConverter}">
                                                                                <Binding Path="PassRate" NotifyOnSourceUpdated="True" UpdateSourceTrigger="PropertyChanged"/>
                                                                                <Binding>
                                                                                    <Binding.Source>
                                                                                        <sys:String>5</sys:String>
                                                                                    </Binding.Source>
                                                                                </Binding>
                                                                            </MultiBinding>
                                                                        </Setter.Value>
                                                                    </Setter>
                                                                </Style>
                                                            </Rectangle.Style>
                                                        </Rectangle>
                                                        <Rectangle Grid.Column="6" Stroke="Silver" Height="12" Width="8" StrokeThickness="0.3" VerticalAlignment="Center">
                                                            <Rectangle.Style>
                                                                <Style TargetType="Rectangle">
                                                                    <Setter Property="Fill">
                                                                        <Setter.Value>
                                                                            <MultiBinding Converter="{StaticResource PRConverter}">
                                                                                <Binding Path="PassRate" NotifyOnSourceUpdated="True" UpdateSourceTrigger="PropertyChanged"/>
                                                                                <Binding>
                                                                                    <Binding.Source>
                                                                                        <sys:String>6</sys:String>
                                                                                    </Binding.Source>
                                                                                </Binding>
                                                                            </MultiBinding>
                                                                        </Setter.Value>
                                                                    </Setter>
                                                                </Style>
                                                            </Rectangle.Style>
                                                        </Rectangle>
                                                        <Rectangle Grid.Column="7" Stroke="Silver" Height="12" Width="8" StrokeThickness="0.3" VerticalAlignment="Center">
                                                            <Rectangle.Style>
                                                                <Style TargetType="Rectangle">
                                                                    <Setter Property="Fill">
                                                                        <Setter.Value>
                                                                            <MultiBinding Converter="{StaticResource PRConverter}">
                                                                                <Binding Path="PassRate" NotifyOnSourceUpdated="True" UpdateSourceTrigger="PropertyChanged"/>
                                                                                <Binding>
                                                                                    <Binding.Source>
                                                                                        <sys:String>7</sys:String>
                                                                                    </Binding.Source>
                                                                                </Binding>
                                                                            </MultiBinding>
                                                                        </Setter.Value>
                                                                    </Setter>
                                                                </Style>
                                                            </Rectangle.Style>
                                                        </Rectangle>
                                                        <Rectangle Grid.Column="8" Stroke="Silver" Height="12" Width="8" StrokeThickness="0.3" VerticalAlignment="Center">
                                                            <Rectangle.Style>
                                                                <Style TargetType="Rectangle">
                                                                    <Setter Property="Fill">
                                                                        <Setter.Value>
                                                                            <MultiBinding Converter="{StaticResource PRConverter}">
                                                                                <Binding Path="PassRate" NotifyOnSourceUpdated="True" UpdateSourceTrigger="PropertyChanged"/>
                                                                                <Binding>
                                                                                    <Binding.Source>
                                                                                        <sys:String>8</sys:String>
                                                                                    </Binding.Source>
                                                                                </Binding>
                                                                            </MultiBinding>
                                                                        </Setter.Value>
                                                                    </Setter>
                                                                </Style>
                                                            </Rectangle.Style>
                                                        </Rectangle>
                                                        <Rectangle Grid.Column="9" Stroke="Silver" Height="12" Width="8" StrokeThickness="0.3" VerticalAlignment="Center">
                                                            <Rectangle.Style>
                                                                <Style TargetType="Rectangle">
                                                                    <Setter Property="Fill">
                                                                        <Setter.Value>
                                                                            <MultiBinding Converter="{StaticResource PRConverter}">
                                                                                <Binding Path="PassRate" NotifyOnSourceUpdated="True" UpdateSourceTrigger="PropertyChanged"/>
                                                                                <Binding>
                                                                                    <Binding.Source>
                                                                                        <sys:String>9</sys:String>
                                                                                    </Binding.Source>
                                                                                </Binding>
                                                                            </MultiBinding>
                                                                        </Setter.Value>
                                                                    </Setter>
                                                                </Style>
                                                            </Rectangle.Style>
                                                        </Rectangle>
                                                        <Rectangle Grid.Column="10" Stroke="Silver" Height="12" Width="8" StrokeThickness="0.3" VerticalAlignment="Center">
                                                            <Rectangle.Style>
                                                                <Style TargetType="Rectangle">
                                                                    <Setter Property="Fill">
                                                                        <Setter.Value>
                                                                            <MultiBinding Converter="{StaticResource PRConverter}">
                                                                                <Binding Path="PassRate" NotifyOnSourceUpdated="True" UpdateSourceTrigger="PropertyChanged"/>
                                                                                <Binding>
                                                                                    <Binding.Source>
                                                                                        <sys:String>10</sys:String>
                                                                                    </Binding.Source>
                                                                                </Binding>
                                                                            </MultiBinding>
                                                                        </Setter.Value>
                                                                    </Setter>
                                                                </Style>
                                                            </Rectangle.Style>
                                                        </Rectangle>
                                                        <TextBlock Grid.Column="1" Grid.ColumnSpan="10" FontWeight="ExtraBlack" FontSize="11" Text="{Binding PassRate}" TextAlignment="Center" HorizontalAlignment="Center">
                                                            <TextBlock.Style>
                                                                <Style TargetType="TextBlock">
                                                                    <Setter Property="Foreground" Value="Navy"/>
                                                                    <Style.Triggers>
                                                                        <DataTrigger Binding="{Binding PassRate}" Value="0%">
                                                                            <Setter Property="Foreground" Value="White"/>
                                                                        </DataTrigger>
                                                                    </Style.Triggers>
                                                                </Style>
                                                            </TextBlock.Style>
                                                        </TextBlock>
                                                    </Grid>
                                                </DataTemplate>
                                            </DataGridTemplateColumn.CellTemplate>
                                        </DataGridTemplateColumn>
                                        <DataGridTemplateColumn Width="115" CanUserResize="True">
                                            <DataGridTemplateColumn.Header>
                                                <DockPanel>
                                                    <TextBlock Text="Completion Rate (%) "/>
                                                    <Image Source="pack://siteoforigin:,,,/Resources/info.png" Height="12" Width="14">
                                                        <Image.ToolTip>
                                                            <ToolTip Placement="Top">
                                                                <StackPanel>
                                                                    <TextBlock FontWeight="Bold">
				                                                        Completion Rate
                                                                    </TextBlock>
                                                                    <TextBlock FontStyle="Italic">
				                                                        This value represents all executed tests versus total tests in suite.
                                                                    </TextBlock>
                                                                </StackPanel>
                                                            </ToolTip>
                                                        </Image.ToolTip>
                                                    </Image>
                                                </DockPanel>
                                            </DataGridTemplateColumn.Header>
                                            <DataGridTemplateColumn.CellTemplate>
                                                <DataTemplate>
                                                    <Grid VerticalAlignment="Center">
                                                        <Grid.ColumnDefinitions>
                                                            <ColumnDefinition />
                                                            <ColumnDefinition Width="10"/>
                                                            <ColumnDefinition Width="10"/>
                                                            <ColumnDefinition Width="10"/>
                                                            <ColumnDefinition Width="10"/>
                                                            <ColumnDefinition Width="10"/>
                                                            <ColumnDefinition Width="10"/>
                                                            <ColumnDefinition Width="10"/>
                                                            <ColumnDefinition Width="10"/>
                                                            <ColumnDefinition Width="10"/>
                                                            <ColumnDefinition Width="10"/>
                                                            <ColumnDefinition/>
                                                        </Grid.ColumnDefinitions>
                                                        <Rectangle Grid.Column="1" Stroke="Silver" Height="12" Width="10" StrokeThickness="0.3" VerticalAlignment="Center">
                                                            <Rectangle.Style>
                                                                <Style TargetType="Rectangle">
                                                                    <Setter Property="Fill">
                                                                        <Setter.Value>
                                                                            <MultiBinding Converter="{StaticResource PRConverter}">
                                                                                <Binding Path="CompletionRate" NotifyOnSourceUpdated="True" UpdateSourceTrigger="PropertyChanged"/>
                                                                                <Binding>
                                                                                    <Binding.Source>
                                                                                        <sys:String>1</sys:String>
                                                                                    </Binding.Source>
                                                                                </Binding>
                                                                            </MultiBinding>
                                                                        </Setter.Value>
                                                                    </Setter>
                                                                </Style>
                                                            </Rectangle.Style>
                                                        </Rectangle>
                                                        <Rectangle Grid.Column="2" Stroke="Silver" Height="12" Width="10" StrokeThickness="0.3" VerticalAlignment="Center">
                                                            <Rectangle.Style>
                                                                <Style TargetType="Rectangle">
                                                                    <Setter Property="Fill">
                                                                        <Setter.Value>
                                                                            <MultiBinding Converter="{StaticResource PRConverter}">
                                                                                <Binding Path="CompletionRate" NotifyOnSourceUpdated="True" UpdateSourceTrigger="PropertyChanged"/>
                                                                                <Binding>
                                                                                    <Binding.Source>
                                                                                        <sys:String>2</sys:String>
                                                                                    </Binding.Source>
                                                                                </Binding>
                                                                            </MultiBinding>
                                                                        </Setter.Value>
                                                                    </Setter>
                                                                </Style>
                                                            </Rectangle.Style>
                                                        </Rectangle>
                                                        <Rectangle Grid.Column="3" Stroke="Silver" Height="12" Width="10" StrokeThickness="0.3" VerticalAlignment="Center">
                                                            <Rectangle.Style>
                                                                <Style TargetType="Rectangle">
                                                                    <Setter Property="Fill">
                                                                        <Setter.Value>
                                                                            <MultiBinding Converter="{StaticResource PRConverter}">
                                                                                <Binding Path="CompletionRate" NotifyOnSourceUpdated="True" UpdateSourceTrigger="PropertyChanged"/>
                                                                                <Binding>
                                                                                    <Binding.Source>
                                                                                        <sys:String>3</sys:String>
                                                                                    </Binding.Source>
                                                                                </Binding>
                                                                            </MultiBinding>
                                                                        </Setter.Value>
                                                                    </Setter>
                                                                </Style>
                                                            </Rectangle.Style>
                                                        </Rectangle>
                                                        <Rectangle Grid.Column="4" Stroke="Silver" Height="12" Width="10" StrokeThickness="0.3" VerticalAlignment="Center">
                                                            <Rectangle.Style>
                                                                <Style TargetType="Rectangle">
                                                                    <Setter Property="Fill">
                                                                        <Setter.Value>
                                                                            <MultiBinding Converter="{StaticResource PRConverter}">
                                                                                <Binding Path="CompletionRate" NotifyOnSourceUpdated="True" UpdateSourceTrigger="PropertyChanged"/>
                                                                                <Binding>
                                                                                    <Binding.Source>
                                                                                        <sys:String>4</sys:String>
                                                                                    </Binding.Source>
                                                                                </Binding>
                                                                            </MultiBinding>
                                                                        </Setter.Value>
                                                                    </Setter>
                                                                </Style>
                                                            </Rectangle.Style>
                                                        </Rectangle>
                                                        <Rectangle Grid.Column="5" Stroke="Silver" Height="12" Width="10" StrokeThickness="0.3" VerticalAlignment="Center">
                                                            <Rectangle.Style>
                                                                <Style TargetType="Rectangle">
                                                                    <Setter Property="Fill">
                                                                        <Setter.Value>
                                                                            <MultiBinding Converter="{StaticResource PRConverter}">
                                                                                <Binding Path="CompletionRate" NotifyOnSourceUpdated="True" UpdateSourceTrigger="PropertyChanged"/>
                                                                                <Binding>
                                                                                    <Binding.Source>
                                                                                        <sys:String>5</sys:String>
                                                                                    </Binding.Source>
                                                                                </Binding>
                                                                            </MultiBinding>
                                                                        </Setter.Value>
                                                                    </Setter>
                                                                </Style>
                                                            </Rectangle.Style>
                                                        </Rectangle>
                                                        <Rectangle Grid.Column="6" Stroke="Silver" Height="12" Width="10" StrokeThickness="0.3" VerticalAlignment="Center">
                                                            <Rectangle.Style>
                                                                <Style TargetType="Rectangle">
                                                                    <Setter Property="Fill">
                                                                        <Setter.Value>
                                                                            <MultiBinding Converter="{StaticResource PRConverter}">
                                                                                <Binding Path="CompletionRate" NotifyOnSourceUpdated="True" UpdateSourceTrigger="PropertyChanged"/>
                                                                                <Binding>
                                                                                    <Binding.Source>
                                                                                        <sys:String>6</sys:String>
                                                                                    </Binding.Source>
                                                                                </Binding>
                                                                            </MultiBinding>
                                                                        </Setter.Value>
                                                                    </Setter>
                                                                </Style>
                                                            </Rectangle.Style>
                                                        </Rectangle>
                                                        <Rectangle Grid.Column="7" Stroke="Silver" Height="12" Width="10" StrokeThickness="0.3" VerticalAlignment="Center">
                                                            <Rectangle.Style>
                                                                <Style TargetType="Rectangle">
                                                                    <Setter Property="Fill">
                                                                        <Setter.Value>
                                                                            <MultiBinding Converter="{StaticResource PRConverter}">
                                                                                <Binding Path="CompletionRate" NotifyOnSourceUpdated="True" UpdateSourceTrigger="PropertyChanged"/>
                                                                                <Binding>
                                                                                    <Binding.Source>
                                                                                        <sys:String>7</sys:String>
                                                                                    </Binding.Source>
                                                                                </Binding>
                                                                            </MultiBinding>
                                                                        </Setter.Value>
                                                                    </Setter>
                                                                </Style>
                                                            </Rectangle.Style>
                                                        </Rectangle>
                                                        <Rectangle Grid.Column="8" Stroke="Silver" Height="12" Width="10" StrokeThickness="0.3" VerticalAlignment="Center">
                                                            <Rectangle.Style>
                                                                <Style TargetType="Rectangle">
                                                                    <Setter Property="Fill">
                                                                        <Setter.Value>
                                                                            <MultiBinding Converter="{StaticResource PRConverter}">
                                                                                <Binding Path="CompletionRate" NotifyOnSourceUpdated="True" UpdateSourceTrigger="PropertyChanged"/>
                                                                                <Binding>
                                                                                    <Binding.Source>
                                                                                        <sys:String>8</sys:String>
                                                                                    </Binding.Source>
                                                                                </Binding>
                                                                            </MultiBinding>
                                                                        </Setter.Value>
                                                                    </Setter>
                                                                </Style>
                                                            </Rectangle.Style>
                                                        </Rectangle>
                                                        <Rectangle Grid.Column="9" Stroke="Silver" Height="12" Width="10" StrokeThickness="0.3" VerticalAlignment="Center">
                                                            <Rectangle.Style>
                                                                <Style TargetType="Rectangle">
                                                                    <Setter Property="Fill">
                                                                        <Setter.Value>
                                                                            <MultiBinding Converter="{StaticResource PRConverter}">
                                                                                <Binding Path="CompletionRate" NotifyOnSourceUpdated="True" UpdateSourceTrigger="PropertyChanged"/>
                                                                                <Binding>
                                                                                    <Binding.Source>
                                                                                        <sys:String>9</sys:String>
                                                                                    </Binding.Source>
                                                                                </Binding>
                                                                            </MultiBinding>
                                                                        </Setter.Value>
                                                                    </Setter>
                                                                </Style>
                                                            </Rectangle.Style>
                                                        </Rectangle>
                                                        <Rectangle Grid.Column="10" Stroke="Silver" Height="12" Width="10" StrokeThickness="0.3" VerticalAlignment="Center">
                                                            <Rectangle.Style>
                                                                <Style TargetType="Rectangle">
                                                                    <Setter Property="Fill">
                                                                        <Setter.Value>
                                                                            <MultiBinding Converter="{StaticResource PRConverter}">
                                                                                <Binding Path="CompletionRate" NotifyOnSourceUpdated="True" UpdateSourceTrigger="PropertyChanged"/>
                                                                                <Binding>
                                                                                    <Binding.Source>
                                                                                        <sys:String>10</sys:String>
                                                                                    </Binding.Source>
                                                                                </Binding>
                                                                            </MultiBinding>
                                                                        </Setter.Value>
                                                                    </Setter>
                                                                </Style>
                                                            </Rectangle.Style>
                                                        </Rectangle>
                                                        <TextBlock Grid.Column="1" Grid.ColumnSpan="10" FontWeight="ExtraBlack" FontSize="11" Text="{Binding CompletionRate}" TextAlignment="Center" HorizontalAlignment="Center">
                                                            <TextBlock.Style>
                                                                <Style TargetType="TextBlock">
                                                                    <Setter Property="Foreground" Value="Navy"/>
                                                                    <Style.Triggers>
                                                                        <DataTrigger Binding="{Binding CompletionRate}" Value="0%">
                                                                            <Setter Property="Foreground" Value="White"/>
                                                                        </DataTrigger>
                                                                    </Style.Triggers>
                                                                </Style>
                                                            </TextBlock.Style>
                                                        </TextBlock>
                                                    </Grid>
                                                </DataTemplate>
                                            </DataGridTemplateColumn.CellTemplate>
                                        </DataGridTemplateColumn>
                                        <DataGridTextColumn Header="Passed" Width="45*" Binding="{Binding PassedTests}" CanUserResize="True">
                                            <DataGridTextColumn.ElementStyle>
                                                <Style TargetType="TextBlock">
                                                    <Setter Property="TextAlignment" Value="Right"/>
                                                </Style>
                                            </DataGridTextColumn.ElementStyle>
                                        </DataGridTextColumn>
                                        <DataGridTextColumn Header="Failed" Width="45*" Binding="{Binding FailedTests}" CanUserResize="True">
                                            <DataGridTextColumn.ElementStyle>
                                                <Style TargetType="TextBlock">
                                                    <Setter Property="TextAlignment" Value="Right"/>
                                                </Style>
                                            </DataGridTextColumn.ElementStyle>
                                        </DataGridTextColumn>
                                        <DataGridTextColumn Header="Not Run" Width="48*" Binding="{Binding NotRunTests}" CanUserResize="True">
                                            <DataGridTextColumn.ElementStyle>
                                                <Style TargetType="TextBlock">
                                                    <Setter Property="TextAlignment" Value="Right"/>
                                                </Style>
                                            </DataGridTextColumn.ElementStyle>
                                        </DataGridTextColumn>
                                        <DataGridTextColumn Header="Total" Width="45*" Binding="{Binding TotalTests}" CanUserResize="True">
                                            <DataGridTextColumn.ElementStyle>
                                                <Style TargetType="TextBlock">
                                                    <Setter Property="TextAlignment" Value="Right"/>
                                                </Style>
                                            </DataGridTextColumn.ElementStyle>
                                        </DataGridTextColumn>
                                        <DataGridTextColumn Header="Environment" Width="95*" Binding="{Binding Environment}" CanUserResize="True">
                                            <DataGridTextColumn.ElementStyle>
                                                <Style TargetType="TextBlock">
                                                    <Setter Property="TextAlignment" Value="Center"/>
                                                    <Setter Property="FontStyle" Value="{Binding Environment, Mode=OneWay,
                                             Converter={StaticResource ItalicConverter}}"/>
                                                    <Setter Property="Foreground" Value="{Binding Environment, Mode=OneWay,
                                             Converter={StaticResource ColorConverter}}"/>
                                                </Style>
                                            </DataGridTextColumn.ElementStyle>
                                        </DataGridTextColumn>
                                        <DataGridTextColumn Header="Browser" Width="70*" Binding="{Binding Browser}" CanUserResize="True" >
                                            <DataGridTextColumn.ElementStyle>
                                                <Style TargetType="TextBlock">
                                                    <Setter Property="TextAlignment" Value="Center"/>
                                                    <Setter Property="FontStyle" Value="{Binding Browser, Mode=OneWay,
                                             Converter={StaticResource ItalicConverter}}"/>
                                                    <Setter Property="Foreground" Value="{Binding Browser, Mode=OneWay,
                                             Converter={StaticResource ColorConverter}}"/>
                                                </Style>
                                            </DataGridTextColumn.ElementStyle>
                                        </DataGridTextColumn>
                                        <DataGridTextColumn Header="Run No." Width="45*" Binding="{Binding RunNumber}" CanUserResize="True">
                                            <DataGridTextColumn.ElementStyle>
                                                <Style TargetType="TextBlock">
                                                    <Setter Property="TextAlignment" Value="Center"/>
                                                </Style>
                                            </DataGridTextColumn.ElementStyle>
                                        </DataGridTextColumn>
                                        <DataGridTextColumn Header="Start Time" Width="100*" Binding="{Binding StartTime}" CanUserResize="True">
                                            <DataGridTextColumn.ElementStyle>
                                                <Style TargetType="TextBlock">
                                                    <Setter Property="TextAlignment" Value="Center"/>
                                                </Style>
                                            </DataGridTextColumn.ElementStyle>
                                        </DataGridTextColumn>
                                        <DataGridTextColumn Header="End Time" Width="100*" Binding="{Binding EndTime}" CanUserResize="True">
                                            <DataGridTextColumn.ElementStyle>
                                                <Style TargetType="TextBlock">
                                                    <Setter Property="TextAlignment" Value="Center"/>
                                                </Style>
                                            </DataGridTextColumn.ElementStyle>
                                        </DataGridTextColumn>
                                        <DataGridTextColumn Header="Duration" Width="100*" Binding="{Binding Duration}" CanUserResize="True">
                                            <DataGridTextColumn.ElementStyle>
                                                <Style TargetType="TextBlock">
                                                    <Setter Property="TextAlignment" Value="Center"/>
                                                </Style>
                                            </DataGridTextColumn.ElementStyle>
                                            <DataGridTextColumn.CellStyle>
                                                <Style TargetType="DataGridCell">
                                                    <Setter Property="BorderThickness" Value="0.25"/>
                                                    <Style.Triggers>
                                                        <Trigger Property="IsSelected" Value="True">
                                                            <Setter Property="Background" Value="White"/>
                                                            <Setter Property="Foreground" Value="Navy" />
                                                            <Setter Property="FontWeight" Value="ExtraBlack"/>
                                                        </Trigger>
                                                    </Style.Triggers>
                                                </Style>
                                            </DataGridTextColumn.CellStyle>
                                        </DataGridTextColumn>
                                        <DataGridTextColumn Header="Machine Name" Width="100*" Binding="{Binding RunningAgent}" CanUserResize="True">
                                            <DataGridTextColumn.ElementStyle>
                                                <Style TargetType="TextBlock">
                                                    <Setter Property="TextAlignment" Value="Center"/>
                                                </Style>
                                            </DataGridTextColumn.ElementStyle>
                                        </DataGridTextColumn>
                                        <DataGridTextColumn Header="User Name" Width="140*" Binding="{Binding UserName}" CanUserResize="True">
                                            <DataGridTextColumn.ElementStyle>
                                                <Style TargetType="TextBlock">
                                                    <Setter Property="TextAlignment" Value="Center"/>
                                                </Style>
                                            </DataGridTextColumn.ElementStyle>
                                        </DataGridTextColumn>
                                        <DataGridTextColumn Header="Operating System" Width="150*" Binding="{Binding OperatingSystem}" CanUserResize="True">
                                            <DataGridTextColumn.ElementStyle>
                                                <Style TargetType="TextBlock">
                                                    <Setter Property="TextAlignment" Value="Center"/>
                                                </Style>
                                            </DataGridTextColumn.ElementStyle>
                                        </DataGridTextColumn>
                                    </DataGrid.Columns>
                                </DataGrid>

                            </Grid>
                        </TabItem>
                    </TabControl>
                </Grid>
            </TabItem>

            <!--Agents Tab-->
            <TabItem Header="Agents" Visibility="Collapsed">
                <Grid>
                    <Grid.RowDefinitions>
                        <RowDefinition />
                        <RowDefinition Height="6"/>
                        <RowDefinition Height="200"/>
                    </Grid.RowDefinitions>
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="260"/>
                        <ColumnDefinition Width="6"/>
                        <ColumnDefinition />
                    </Grid.ColumnDefinitions>
                    <!--Agent Groups-->
                    <TabControl Grid.Column="0" Grid.RowSpan="3" Margin="-2,-4,-2,-2">
                        <TabItem Visibility="Collapsed">
                            <Grid>
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="25" />
                                    <RowDefinition Height="30" />
                                    <RowDefinition />
                                </Grid.RowDefinitions>
                                <TextBlock Grid.Row="0" Foreground="Navy" FontWeight="Bold" Margin="3,3,0,0">Agent Groups</TextBlock>
                                <ToolBar Grid.Row="1" VerticalAlignment="Stretch" Margin="-3,0,0,0"  Loaded="ToolBar_Loaded" BorderBrush="Silver" BorderThickness="1" ToolBarTray.IsLocked="True">
                                    <Button x:Name="btnAgentGroupAdd" Style="{StaticResource ToolbarButtonStyle}" Click="btnAgentGroupAdd_Click" Height="22" Width="22" BorderBrush="Transparent" ToolTip="Add Agent Group" Margin="5,1,0,0">
                                        <Image Source="pack://siteoforigin:,,,/Resources/addblue.png" Height="12" Width="12"/>
                                    </Button>
                                    <Button x:Name="btnAgentGroupEdit" Style="{StaticResource ToolbarButtonStyle}" Click="btnAgentGroupEdit_Click" Width="22" Height="22" BorderBrush="Transparent" ToolTip="Edit Agent Group" Margin="3,1,0,0" Visibility="Collapsed">
                                        <Image Source="pack://siteoforigin:,,,/Resources/edit.png" Height="12" Width="12"/>
                                    </Button>
                                    <Button x:Name="btnAgentGroupDelete" Style="{StaticResource ToolbarButtonStyle}" Click="btnAgentGroupDelete_Click" Width="22" Height="22" BorderBrush="Transparent" ToolTip="Delete Agent Group" Margin="3,1,0,0" Visibility="Collapsed">
                                        <Image Source="pack://siteoforigin:,,,/Resources/button_cancel.ico" Height="12" Width="12"/>
                                    </Button>
                                </ToolBar>
                                <Border Grid.Row="2" BorderBrush="Silver" BorderThickness="2">
                                    <Grid Background="Silver">
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition />
                                        </Grid.ColumnDefinitions>
                                        <DockPanel Background="Gray" Visibility="Visible">
                                            <DataGrid x:Name="dgAgentGroups" Grid.Column="0" Grid.Row="0" Height="Auto" VerticalAlignment="Stretch" 
                                                        ItemsSource="{Binding}" HeadersVisibility="None" AutoGenerateColumns="False" GridLinesVisibility="None" 
                                                        Background="White" SelectionChanged="dgAgentGroups_SelectionChanged" SelectionMode="Single">
                                                <DataGrid.Columns>
                                                    <DataGridTextColumn Header="Name" Width="*" Binding="{Binding Name}" IsReadOnly="True"/>
                                                </DataGrid.Columns>
                                            </DataGrid>
                                        </DockPanel>
                                    </Grid>
                                </Border>
                            </Grid>
                        </TabItem>
                    </TabControl>
                    <!--Splitter-->
                    <GridSplitter Grid.Column="1" Grid.RowSpan="3" Height="Auto" HorizontalAlignment="Stretch" Background="Transparent"/>
                    <!--Agents-->
                    <TabControl Grid.Column="2" Grid.Row="0" Margin="-2,-4,-2,-2">
                        <TabItem Visibility="Collapsed">
                            <Grid>
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="25" />
                                    <RowDefinition Height="30" />
                                    <RowDefinition />
                                </Grid.RowDefinitions>
                                <TextBlock Name="textblockAgentGroupName" Grid.Row="0" Foreground="Navy" FontWeight="Bold" Margin="3,3,0,0">Agents</TextBlock>
                                <StackPanel x:Name="panelAgentGroupName" Grid.Row="0" Orientation="Horizontal" Visibility="Collapsed">
                                    <TextBox Name="txtboxAgentGroupName" FontWeight="Bold" Margin="0,0,0,0" Width="250" />
                                    <Button x:Name="btnAgentGroupSave" Style="{StaticResource ToolbarButtonStyle}" Click="btnAgentGroupSave_Click" Height="20" Width="40" 
                                            ToolTip="Save changes made on the agent group" Margin="5,1,0,0">
                                        <TextBlock>Save</TextBlock>
                                    </Button>
                                    <Button x:Name="btnAgentGroupCancel" Style="{StaticResource ToolbarButtonStyle}" Click="btnAgentGroupCancel_Click" Height="20" Width="40" 
                                            ToolTip="Undo changes" Margin="5,1,0,0">
                                        <TextBlock>Cancel</TextBlock>
                                    </Button>
                                </StackPanel>

                                <ToolBar Grid.Row="1" VerticalAlignment="Stretch" Margin="-3,0,0,0"  Loaded="ToolBar_Loaded" BorderBrush="Silver" BorderThickness="1" ToolBarTray.IsLocked="True">
                                    <Button x:Name="btnAgentAdd" Style="{StaticResource ToolbarButtonStyle}" Click="btnAgentAdd_Click" Height="22" Width="22" BorderBrush="Transparent" ToolTip="Add Agent" Margin="5,1,0,0">
                                        <Image Source="pack://siteoforigin:,,,/Resources/addblue.png" Height="12" Width="12"/>
                                    </Button>
                                    <Button x:Name="btnAgentDelete" Style="{StaticResource ToolbarButtonStyle}" Click="btnAgentDelete_Click" Width="22" Height="22" BorderBrush="Transparent" ToolTip="Delete Agent" Margin="3,1,0,0">
                                        <Image Source="pack://siteoforigin:,,,/Resources/button_cancel.ico" Height="12" Width="12"/>
                                    </Button>
                                    <Button x:Name="btnAgentEnable" Style="{StaticResource ToolbarButtonStyle}" Click="btnAgentEnable_Click" Width="22" Height="22" BorderBrush="Transparent" ToolTip="Enable/Disable Agent" Margin="3,1,0,0">
                                        <Image Source="pack://siteoforigin:,,,/Resources/button_enable.png" Height="12" Width="12"/>
                                    </Button>
                                    <Button x:Name="btnAgentGetLatest" Style="{StaticResource ToolbarButtonStyle}" Click="btnAgentGetLatest_Click" Width="22" Height="22" BorderBrush="Transparent" ToolTip="Get Latest files on Agent Machine" Margin="3,1,0,0">
                                        <Image Source="pack://siteoforigin:,,,/Resources/button_download.ico" Height="12" Width="12"/>
                                    </Button>
                                </ToolBar>

                                <!--Agents Grid-->
                                <DataGrid x:Name="dgAgentLineup" Grid.Row="2" Style="{StaticResource DataGridStyle1}"
                                    ColumnHeaderStyle="{StaticResource ColHeaderStyle}" ItemsSource="{Binding}" SelectionChanged="dgAgentLineup_SelectionChanged"
                                    CanUserAddRows="False" RowStyle="{StaticResource RowStyle}" CanUserSortColumns="True">
                                    <DataGrid.Resources>
                                        <DataTemplate x:Key="EditingDateTemplate">
                                            <DatePicker SelectedDate="{Binding Schedule, Mode=TwoWay, NotifyOnSourceUpdated=True, UpdateSourceTrigger=PropertyChanged}"/>
                                        </DataTemplate>
                                        <DataTemplate x:Key="EditingListTemplate">
                                            <ComboBox ItemsSource="{Binding DaysOfWeek, RelativeSource={RelativeSource AncestorType={x:Type Window}}}"
                                                Text="{Binding Schedule, Mode=TwoWay, NotifyOnSourceUpdated=True, UpdateSourceTrigger=PropertyChanged}"/>
                                        </DataTemplate>
                                        <DataTemplate x:Key="UneditableTemplate">
                                            <TextBlock IsEnabled="False" Text=""/>
                                        </DataTemplate>
                                    </DataGrid.Resources>
                                    <DataGrid.CellStyle>
                                        <Style TargetType="DataGridCell" BasedOn="{StaticResource CellStyle}">
                                            <Style.Triggers>
                                                <DataTrigger Binding="{Binding Disabled}" Value="true">
                                                    <Setter Property="Foreground" Value="DarkGray"/>
                                                    <Setter Property="FontStyle" Value="Italic" />
                                                </DataTrigger>
                                            </Style.Triggers>
                                        </Style>
                                    </DataGrid.CellStyle>
                                    <DataGrid.Columns>
                                        <DataGridCheckBoxColumn Header="In Group" MinWidth="50" x:Name="InGroupColumn"
                                                                Binding="{Binding IsInGroup, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged, NotifyOnSourceUpdated=True}" 
                                                                Visibility="Collapsed"/>
                                        <DataGridTextColumn Header="Agent ID" MinWidth="150"
                                                    Binding="{Binding Name}"
                                                    IsReadOnly="True" />
                                        <DataGridTextColumn Header="Status" MinWidth="100"
                                                    Binding="{Binding Status, Converter={StaticResource EConverter}, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged, NotifyOnSourceUpdated=True}"
                                                    IsReadOnly="True">
                                            <DataGridTextColumn.ElementStyle>
                                                <Style TargetType="TextBlock">
                                                    <Style.Triggers>
                                                        <DataTrigger Binding="{Binding Status, Converter={StaticResource EConverter}}" Value="Offline">
                                                            <Setter Property="Foreground" Value="DarkGray"/>
                                                        </DataTrigger>
                                                        <DataTrigger Binding="{Binding Status, Converter={StaticResource EConverter}}" Value="Ready">
                                                            <Setter Property="Foreground" Value="LimeGreen"/>
                                                        </DataTrigger>
                                                        <DataTrigger Binding="{Binding Status, Converter={StaticResource EConverter}}" Value="Busy">
                                                            <Setter Property="Foreground" Value="DodgerBlue"/>
                                                        </DataTrigger>
                                                        <DataTrigger Binding="{Binding Status, Converter={StaticResource EConverter}}" Value="Error">
                                                            <Setter Property="Foreground" Value="Red"/>
                                                        </DataTrigger>
                                                        <DataTrigger Binding="{Binding Status, Converter={StaticResource EConverter}}" Value="Warning">
                                                            <Setter Property="Foreground" Value="Orange"/>
                                                        </DataTrigger>
                                                        <DataTrigger Binding="{Binding Status, Converter={StaticResource EConverter}}" Value="Reserved">
                                                            <Setter Property="Foreground" Value="Pink"/>
                                                        </DataTrigger>
                                                        <DataTrigger Binding="{Binding Status, Converter={StaticResource EConverter}}" Value="Updating">
                                                            <Setter Property="Foreground" Value="Orange"/>
                                                        </DataTrigger>
                                                    </Style.Triggers>
                                                </Style>
                                            </DataGridTextColumn.ElementStyle>
                                        </DataGridTextColumn>
                                        <DataGridTextColumn Header="Description" MinWidth="100" Width="*" Binding="{Binding Description}" IsReadOnly="True">
                                            <DataGridTextColumn.ElementStyle>
                                                <Style>
                                                    <Setter Property="ToolTipService.ToolTip" Value="{Binding Description}" />
                                                    <Setter Property="ToolTipService.IsEnabled" Value="{Binding Description, Converter={StaticResource stringhasvaluetobool}}" />
                                                    <Setter Property="TextBlock.TextWrapping" Value="Wrap" />
                                                </Style>
                                            </DataGridTextColumn.ElementStyle>
                                        </DataGridTextColumn>
                                        <DataGridTextColumn Header="Agent Runtime" MinWidth="80"
                                                    Binding="{Binding Runtime, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged, NotifyOnSourceUpdated=True}"
                                                    IsReadOnly="True"/>
                                        <DataGridTextColumn Header="Disk Space (GB)" MinWidth="80"
                                                    Binding="{Binding AgentStats.AvailableDiskSpace, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged, NotifyOnSourceUpdated=True}"
                                                    IsReadOnly="True"/>
                                        <DataGridTextColumn Header="Peak Memory Usage (MB)" MinWidth="170"
                                                    Binding="{Binding AgentStats.PeakMemoryUsage, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged, NotifyOnSourceUpdated=True}"
                                                    IsReadOnly="True"/>
                                        <DataGridTextColumn Header="Total RAM (MB)" MinWidth="80"
                                                    Binding="{Binding AgentStats.SystemMemory, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged, NotifyOnSourceUpdated=True}"
                                                    IsReadOnly="True"/>
                                        <DataGridTextColumn Header="Operating System" MinWidth="150"
                                                    Binding="{Binding AgentStats.OperatingSystem, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged, NotifyOnSourceUpdated=True}"
                                                    IsReadOnly="True"/>

                                    </DataGrid.Columns>
                                </DataGrid>
                            </Grid>
                        </TabItem>
                    </TabControl>
                    <GridSplitter Grid.Column="2" Grid.Row="1" Height="Auto" HorizontalAlignment="Stretch" Background="Transparent"/>
                    <TabControl Grid.Column="2" Grid.Row="2" Margin="-2,-4,-2,-2">
                        <TabItem Visibility="Collapsed">
                            <Grid>
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="25"/>
                                    <RowDefinition />
                                </Grid.RowDefinitions>
                                <Grid Grid.Row="0">
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition />
                                        <ColumnDefinition />
                                    </Grid.ColumnDefinitions>
                                    <Grid Grid.Column="0">
                                        <TextBlock Height="20" MaxHeight="20" MinHeight="20" Foreground="Navy" FontWeight="Bold" Margin="3,0,0,0">
                                            History
                                            <TextBlock Foreground="Silver" FontSize="9" FontWeight="Light" FontStyle="Italic" Text="(Last 30 days)"/>
                                        </TextBlock>
                                    </Grid>
                                    <Grid Grid.Column="1" HorizontalAlignment="Right" VerticalAlignment="Center" Height="20">
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition />
                                            <ColumnDefinition />
                                            <ColumnDefinition />
                                            <ColumnDefinition />
                                        </Grid.ColumnDefinitions>
                                        <CheckBox Grid.Column="0" Margin="0,0,7,0" x:Name="chkAgentHistoryFilter" IsEnabled="True" Click="chkAgentHistoryFilter_Click" ToolTip="Filter Result History">Filter</CheckBox>
                                        <DatePicker Grid.Column="1" Margin="0,-3,4,0" x:Name="dtAgentHistoryFrom" IsEnabled="False"  LostFocus="dtAgentHistoryFrom_LostFocus" TextBoxBase.TextChanged="dtAgentHistoryFrom_TextChanged" DateValidationError="dtAgentHistoryFrom_DateValidationError"  ToolTip="Filter Start Date"></DatePicker>
                                        <Label Grid.Column="2" Margin="0,-4,4,0">To</Label>
                                        <DatePicker Grid.Column="3" Margin="0,-3,4,0" x:Name="dtAgentHistoryTo" IsEnabled="False"  LostFocus="dtAgentHistoryTo_LostFocus" TextBoxBase.TextChanged="dtAgentHistoryTo_TextChanged" DateValidationError="dtAgentHistoryTo_DateValidationError" ToolTip="Filter End Date"></DatePicker>
                                    </Grid>
                                </Grid>
                                <DataGrid x:Name="dgAgentHistory" Grid.Row="1" Style="{StaticResource DataGridStyle1}"   HorizontalScrollBarVisibility="Hidden" CellStyle="{StaticResource CellStyleResults}" RowStyle="{StaticResource RowStyle}"
                                        ColumnHeaderStyle="{StaticResource ColHeaderStyleCentered}" VirtualizingPanel.IsVirtualizing="True" CanUserAddRows="False" IsReadOnly="True"
                                        SelectionUnit="FullRow" MouseDoubleClick="dgAgentHistory_MouseDoubleClick">
                                    <DataGrid.ContextMenu>
                                        <ContextMenu x:Name="ctxAgentHistory">
                                            <ContextMenu.Style>
                                                <Style TargetType="ContextMenu">
                                                    <Setter Property="FontFamily" Value="Calibri"></Setter>
                                                </Style>
                                            </ContextMenu.Style>
                                            <MenuItem Name="mnuViewAgentResultsDetails" Click="mnuViewAgentResultsDetails_Click" Header="View Details..."/>
                                            <MenuItem Name="mnuDeleteAgentHistoryItem" Click="mnuDeleteAgentHistoryItem_Click" Header="Delete"/>
                                        </ContextMenu>
                                    </DataGrid.ContextMenu>
                                    <DataGrid.Columns>
                                        <DataGridTextColumn Header="Test Suite" Width="200*" Binding="{Binding SuiteFullPath, Converter={StaticResource TSPathConverter}}" CanUserResize="True" FontWeight="ExtraBlack" 
                                                        HeaderStyle="{StaticResource ColHeaderStyle}">
                                            <DataGridTextColumn.CellStyle>
                                                <Style TargetType="DataGridCell">
                                                    <Setter Property="Background" Value="WhiteSmoke"/>
                                                    <Setter Property="BorderThickness" Value="0.25"/>
                                                    <Style.Triggers>
                                                        <Trigger Property="IsSelected" Value="True">
                                                            <Setter Property="Foreground" Value="Navy" />
                                                            <Setter Property="FontWeight" Value="ExtraBlack"/>
                                                        </Trigger>
                                                    </Style.Triggers>
                                                </Style>
                                            </DataGridTextColumn.CellStyle>
                                        </DataGridTextColumn>
                                        <DataGridTextColumn Header="Execution Date" Width="100*" Binding="{Binding ExecutionDate}" CanUserResize="True" FontWeight="ExtraBlack" 
                                                        HeaderStyle="{StaticResource ColHeaderStyle}">
                                            <DataGridTextColumn.ElementStyle>
                                                <Style TargetType="TextBlock">
                                                    <Setter Property="TextAlignment" Value="Center"/>
                                                </Style>
                                            </DataGridTextColumn.ElementStyle>
                                        </DataGridTextColumn>
                                        <DataGridTemplateColumn Header="Pass Rate (%)" Width="75" CanUserResize="True">
                                            <DataGridTemplateColumn.CellTemplate>
                                                <DataTemplate>
                                                    <Grid VerticalAlignment="Center">
                                                        <Grid.ColumnDefinitions>
                                                            <ColumnDefinition />
                                                            <ColumnDefinition Width="6"/>
                                                            <ColumnDefinition Width="6"/>
                                                            <ColumnDefinition Width="6"/>
                                                            <ColumnDefinition Width="6"/>
                                                            <ColumnDefinition Width="6"/>
                                                            <ColumnDefinition Width="6"/>
                                                            <ColumnDefinition Width="6"/>
                                                            <ColumnDefinition Width="6"/>
                                                            <ColumnDefinition Width="6"/>
                                                            <ColumnDefinition Width="6"/>
                                                            <ColumnDefinition/>
                                                        </Grid.ColumnDefinitions>
                                                        <Rectangle Grid.Column="1" Stroke="Silver" Height="12" Width="6" StrokeThickness="0.3" VerticalAlignment="Center">
                                                            <Rectangle.Style>
                                                                <Style TargetType="Rectangle">
                                                                    <Setter Property="Fill">
                                                                        <Setter.Value>
                                                                            <MultiBinding Converter="{StaticResource PRConverter}">
                                                                                <Binding Path="PassRate" NotifyOnSourceUpdated="True" UpdateSourceTrigger="PropertyChanged"/>
                                                                                <Binding>
                                                                                    <Binding.Source>
                                                                                        <sys:String>1</sys:String>
                                                                                    </Binding.Source>
                                                                                </Binding>
                                                                            </MultiBinding>
                                                                        </Setter.Value>
                                                                    </Setter>
                                                                </Style>
                                                            </Rectangle.Style>
                                                        </Rectangle>
                                                        <Rectangle Grid.Column="2" Stroke="Silver" Height="12" Width="6" StrokeThickness="0.3" VerticalAlignment="Center">
                                                            <Rectangle.Style>
                                                                <Style TargetType="Rectangle">
                                                                    <Setter Property="Fill">
                                                                        <Setter.Value>
                                                                            <MultiBinding Converter="{StaticResource PRConverter}">
                                                                                <Binding Path="PassRate" NotifyOnSourceUpdated="True" UpdateSourceTrigger="PropertyChanged"/>
                                                                                <Binding>
                                                                                    <Binding.Source>
                                                                                        <sys:String>2</sys:String>
                                                                                    </Binding.Source>
                                                                                </Binding>
                                                                            </MultiBinding>
                                                                        </Setter.Value>
                                                                    </Setter>
                                                                </Style>
                                                            </Rectangle.Style>
                                                        </Rectangle>
                                                        <Rectangle Grid.Column="3" Stroke="Silver" Height="12" Width="6" StrokeThickness="0.3" VerticalAlignment="Center">
                                                            <Rectangle.Style>
                                                                <Style TargetType="Rectangle">
                                                                    <Setter Property="Fill">
                                                                        <Setter.Value>
                                                                            <MultiBinding Converter="{StaticResource PRConverter}">
                                                                                <Binding Path="PassRate" NotifyOnSourceUpdated="True" UpdateSourceTrigger="PropertyChanged"/>
                                                                                <Binding>
                                                                                    <Binding.Source>
                                                                                        <sys:String>3</sys:String>
                                                                                    </Binding.Source>
                                                                                </Binding>
                                                                            </MultiBinding>
                                                                        </Setter.Value>
                                                                    </Setter>
                                                                </Style>
                                                            </Rectangle.Style>
                                                        </Rectangle>
                                                        <Rectangle Grid.Column="4" Stroke="Silver" Height="12" Width="6" StrokeThickness="0.3" VerticalAlignment="Center">
                                                            <Rectangle.Style>
                                                                <Style TargetType="Rectangle">
                                                                    <Setter Property="Fill">
                                                                        <Setter.Value>
                                                                            <MultiBinding Converter="{StaticResource PRConverter}">
                                                                                <Binding Path="PassRate" NotifyOnSourceUpdated="True" UpdateSourceTrigger="PropertyChanged"/>
                                                                                <Binding>
                                                                                    <Binding.Source>
                                                                                        <sys:String>4</sys:String>
                                                                                    </Binding.Source>
                                                                                </Binding>
                                                                            </MultiBinding>
                                                                        </Setter.Value>
                                                                    </Setter>
                                                                </Style>
                                                            </Rectangle.Style>
                                                        </Rectangle>
                                                        <Rectangle Grid.Column="5" Stroke="Silver" Height="12" Width="6" StrokeThickness="0.3" VerticalAlignment="Center">
                                                            <Rectangle.Style>
                                                                <Style TargetType="Rectangle">
                                                                    <Setter Property="Fill">
                                                                        <Setter.Value>
                                                                            <MultiBinding Converter="{StaticResource PRConverter}">
                                                                                <Binding Path="PassRate" NotifyOnSourceUpdated="True" UpdateSourceTrigger="PropertyChanged"/>
                                                                                <Binding>
                                                                                    <Binding.Source>
                                                                                        <sys:String>5</sys:String>
                                                                                    </Binding.Source>
                                                                                </Binding>
                                                                            </MultiBinding>
                                                                        </Setter.Value>
                                                                    </Setter>
                                                                </Style>
                                                            </Rectangle.Style>
                                                        </Rectangle>
                                                        <Rectangle Grid.Column="6" Stroke="Silver" Height="12" Width="6" StrokeThickness="0.3" VerticalAlignment="Center">
                                                            <Rectangle.Style>
                                                                <Style TargetType="Rectangle">
                                                                    <Setter Property="Fill">
                                                                        <Setter.Value>
                                                                            <MultiBinding Converter="{StaticResource PRConverter}">
                                                                                <Binding Path="PassRate" NotifyOnSourceUpdated="True" UpdateSourceTrigger="PropertyChanged"/>
                                                                                <Binding>
                                                                                    <Binding.Source>
                                                                                        <sys:String>6</sys:String>
                                                                                    </Binding.Source>
                                                                                </Binding>
                                                                            </MultiBinding>
                                                                        </Setter.Value>
                                                                    </Setter>
                                                                </Style>
                                                            </Rectangle.Style>
                                                        </Rectangle>
                                                        <Rectangle Grid.Column="7" Stroke="Silver" Height="12" Width="6" StrokeThickness="0.3" VerticalAlignment="Center">
                                                            <Rectangle.Style>
                                                                <Style TargetType="Rectangle">
                                                                    <Setter Property="Fill">
                                                                        <Setter.Value>
                                                                            <MultiBinding Converter="{StaticResource PRConverter}">
                                                                                <Binding Path="PassRate" NotifyOnSourceUpdated="True" UpdateSourceTrigger="PropertyChanged"/>
                                                                                <Binding>
                                                                                    <Binding.Source>
                                                                                        <sys:String>7</sys:String>
                                                                                    </Binding.Source>
                                                                                </Binding>
                                                                            </MultiBinding>
                                                                        </Setter.Value>
                                                                    </Setter>
                                                                </Style>
                                                            </Rectangle.Style>
                                                        </Rectangle>
                                                        <Rectangle Grid.Column="8" Stroke="Silver" Height="12" Width="6" StrokeThickness="0.3" VerticalAlignment="Center">
                                                            <Rectangle.Style>
                                                                <Style TargetType="Rectangle">
                                                                    <Setter Property="Fill">
                                                                        <Setter.Value>
                                                                            <MultiBinding Converter="{StaticResource PRConverter}">
                                                                                <Binding Path="PassRate" NotifyOnSourceUpdated="True" UpdateSourceTrigger="PropertyChanged"/>
                                                                                <Binding>
                                                                                    <Binding.Source>
                                                                                        <sys:String>8</sys:String>
                                                                                    </Binding.Source>
                                                                                </Binding>
                                                                            </MultiBinding>
                                                                        </Setter.Value>
                                                                    </Setter>
                                                                </Style>
                                                            </Rectangle.Style>
                                                        </Rectangle>
                                                        <Rectangle Grid.Column="9" Stroke="Silver" Height="12" Width="6" StrokeThickness="0.3" VerticalAlignment="Center">
                                                            <Rectangle.Style>
                                                                <Style TargetType="Rectangle">
                                                                    <Setter Property="Fill">
                                                                        <Setter.Value>
                                                                            <MultiBinding Converter="{StaticResource PRConverter}">
                                                                                <Binding Path="PassRate" NotifyOnSourceUpdated="True" UpdateSourceTrigger="PropertyChanged"/>
                                                                                <Binding>
                                                                                    <Binding.Source>
                                                                                        <sys:String>9</sys:String>
                                                                                    </Binding.Source>
                                                                                </Binding>
                                                                            </MultiBinding>
                                                                        </Setter.Value>
                                                                    </Setter>
                                                                </Style>
                                                            </Rectangle.Style>
                                                        </Rectangle>
                                                        <Rectangle Grid.Column="10" Stroke="Silver" Height="12" Width="6" StrokeThickness="0.3" VerticalAlignment="Center">
                                                            <Rectangle.Style>
                                                                <Style TargetType="Rectangle">
                                                                    <Setter Property="Fill">
                                                                        <Setter.Value>
                                                                            <MultiBinding Converter="{StaticResource PRConverter}">
                                                                                <Binding Path="PassRate" NotifyOnSourceUpdated="True" UpdateSourceTrigger="PropertyChanged"/>
                                                                                <Binding>
                                                                                    <Binding.Source>
                                                                                        <sys:String>10</sys:String>
                                                                                    </Binding.Source>
                                                                                </Binding>
                                                                            </MultiBinding>
                                                                        </Setter.Value>
                                                                    </Setter>
                                                                </Style>
                                                            </Rectangle.Style>
                                                        </Rectangle>
                                                        <TextBlock Grid.Column="1" Grid.ColumnSpan="10" FontWeight="ExtraBlack" FontSize="11" Text="{Binding PassRate}" TextAlignment="Center" HorizontalAlignment="Center">
                                                            <TextBlock.Style>
                                                                <Style TargetType="TextBlock">
                                                                    <Setter Property="Foreground" Value="Navy"/>
                                                                    <Style.Triggers>
                                                                        <DataTrigger Binding="{Binding PassRate}" Value="0%">
                                                                            <Setter Property="Foreground" Value="White"/>
                                                                        </DataTrigger>
                                                                    </Style.Triggers>
                                                                </Style>
                                                            </TextBlock.Style>
                                                        </TextBlock>
                                                    </Grid>
                                                </DataTemplate>
                                            </DataGridTemplateColumn.CellTemplate>
                                        </DataGridTemplateColumn>
                                        <DataGridTextColumn Header="Passed" Width="45*" Binding="{Binding PassedTests}" CanUserResize="True">
                                            <DataGridTextColumn.ElementStyle>
                                                <Style TargetType="TextBlock">
                                                    <Setter Property="TextAlignment" Value="Right"/>
                                                </Style>
                                            </DataGridTextColumn.ElementStyle>
                                        </DataGridTextColumn>
                                        <DataGridTextColumn Header="Failed" Width="45*" Binding="{Binding FailedTests}" CanUserResize="True">
                                            <DataGridTextColumn.ElementStyle>
                                                <Style TargetType="TextBlock">
                                                    <Setter Property="TextAlignment" Value="Right"/>
                                                </Style>
                                            </DataGridTextColumn.ElementStyle>
                                        </DataGridTextColumn>
                                        <DataGridTextColumn Header="Not Run" Width="45*" Binding="{Binding NotRunTests}" CanUserResize="True">
                                            <DataGridTextColumn.ElementStyle>
                                                <Style TargetType="TextBlock">
                                                    <Setter Property="TextAlignment" Value="Right"/>
                                                </Style>
                                            </DataGridTextColumn.ElementStyle>
                                        </DataGridTextColumn>
                                        <DataGridTextColumn Header="Total" Width="45*" Binding="{Binding TotalTests}" CanUserResize="True">
                                            <DataGridTextColumn.ElementStyle>
                                                <Style TargetType="TextBlock">
                                                    <Setter Property="TextAlignment" Value="Right"/>
                                                </Style>
                                            </DataGridTextColumn.ElementStyle>
                                        </DataGridTextColumn>
                                        <DataGridTextColumn Header="Run No." Width="45*" Binding="{Binding RunNumber}" CanUserResize="True">
                                            <DataGridTextColumn.ElementStyle>
                                                <Style TargetType="TextBlock">
                                                    <Setter Property="TextAlignment" Value="Center"/>
                                                </Style>
                                            </DataGridTextColumn.ElementStyle>
                                        </DataGridTextColumn>
                                        <DataGridTextColumn Header="Start Time" Width="100*" Binding="{Binding StartTime}" CanUserResize="True">
                                            <DataGridTextColumn.ElementStyle>
                                                <Style TargetType="TextBlock">
                                                    <Setter Property="TextAlignment" Value="Center"/>
                                                </Style>
                                            </DataGridTextColumn.ElementStyle>
                                        </DataGridTextColumn>
                                        <DataGridTextColumn Header="End Time" Width="100*" Binding="{Binding EndTime}" CanUserResize="True">
                                            <DataGridTextColumn.ElementStyle>
                                                <Style TargetType="TextBlock">
                                                    <Setter Property="TextAlignment" Value="Center"/>
                                                </Style>
                                            </DataGridTextColumn.ElementStyle>
                                        </DataGridTextColumn>
                                        <DataGridTextColumn Header="Duration" Width="100*" Binding="{Binding Duration}" CanUserResize="True">
                                            <DataGridTextColumn.ElementStyle>
                                                <Style TargetType="TextBlock">
                                                    <Setter Property="TextAlignment" Value="Center"/>
                                                </Style>
                                            </DataGridTextColumn.ElementStyle>
                                            <DataGridTextColumn.CellStyle>
                                                <Style TargetType="DataGridCell">
                                                    <Setter Property="BorderThickness" Value="0.25"/>
                                                    <Style.Triggers>
                                                        <Trigger Property="IsSelected" Value="True">
                                                            <Setter Property="Background" Value="White"/>
                                                            <Setter Property="Foreground" Value="Navy" />
                                                            <Setter Property="FontWeight" Value="ExtraBlack"/>
                                                        </Trigger>
                                                    </Style.Triggers>
                                                </Style>
                                            </DataGridTextColumn.CellStyle>
                                        </DataGridTextColumn>
                                        <DataGridTextColumn Header="User Name" Width="140*" Binding="{Binding UserName}" CanUserResize="True">
                                            <DataGridTextColumn.ElementStyle>
                                                <Style TargetType="TextBlock">
                                                    <Setter Property="TextAlignment" Value="Center"/>
                                                </Style>
                                            </DataGridTextColumn.ElementStyle>
                                        </DataGridTextColumn>
                                    </DataGrid.Columns>
                                </DataGrid>
                            </Grid>
                        </TabItem>
                    </TabControl>
                </Grid>
            </TabItem>
            <!--Calendar Tab-->
            <TabItem Header="Calendar" Visibility="Collapsed"></TabItem>
        </TabControl>
        <StatusBar x:Name="StatusBar" HorizontalAlignment="Stretch" Height="25" Margin="0,480,0,0" VerticalAlignment="Bottom" Width="Auto" Background="White" Grid.ColumnSpan="4" Grid.RowSpan="6" >
            <StatusBarItem Margin="10,1,5,0">
                <Button x:Name="btnCloseMessage" Cursor="Hand" FontSize="11" Visibility="Hidden" Click="btnCloseMessage_Click">
                    <Button.Template>
                        <ControlTemplate TargetType="Button">
                            <TextBlock TextDecorations="None">
                                <ContentPresenter />
                            </TextBlock>
                        </ControlTemplate>
                    </Button.Template>
                    <Button.Style>
                        <Style TargetType="Button">
                            <Setter Property="Foreground" Value="Black" />
                            <Style.Triggers>
                                <Trigger Property="IsMouseOver" Value="true">
                                    <Setter Property="Foreground" Value="Red" />
                                </Trigger>
                            </Style.Triggers>
                        </Style>
                    </Button.Style>
                    <Image Source="pack://siteoforigin:,,,/Resources/button_close.ico" Height="12" Width="12"/>
                </Button>
            </StatusBarItem>
            <StatusBarItem Margin="0,0,5,0">
                <TextBlock x:Name="StatusTitle" FontSize="11" FontWeight="Bold"/>
            </StatusBarItem>
            <StatusBarItem  Margin="0,0,0,0">
                <TextBlock x:Name="StatusMessage" FontSize="11" />
            </StatusBarItem>
            <StatusBarItem Margin="0,0,10,4" HorizontalAlignment="Right">
                <Button x:Name="btnViewLogsLink"  Content="View all logs" Cursor="Hand" FontSize="11" Click="btnViewLogsLink_Click">
                    <Button.Template>
                        <ControlTemplate TargetType="Button">
                            <TextBlock TextDecorations="Underline">
                                <ContentPresenter />
                            </TextBlock>
                        </ControlTemplate>
                    </Button.Template>
                    <Button.Style>
                        <Style TargetType="Button">
                            <Setter Property="Foreground" Value="Black" />
                            <Style.Triggers>
                                <Trigger Property="IsMouseOver" Value="true">
                                    <Setter Property="Foreground" Value="Blue" />
                                </Trigger>
                            </Style.Triggers>
                        </Style>
                    </Button.Style>
                </Button>
            </StatusBarItem>
        </StatusBar>
    </Grid>
</Window>
